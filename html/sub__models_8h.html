<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CAMP: sub_models.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/mhchem.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CAMP<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Chemistry Across Multiple Phases</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sub_models.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header file for sub model functions.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
Include dependency graph for sub_models.h:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h__incl.png" border="0" usemap="#asub__models_8h" alt=""/></div>
<map name="asub__models_8h" id="asub__models_8h">
<area shape="rect" title="Header file for sub model functions." alt="" coords="343,5,444,31"/>
<area shape="rect" href="_jacobian_8h.html" title="Header for the Jacobian structure and related functions." alt="" coords="5,160,89,186"/>
<area shape="poly" title=" " alt="" coords="368,34,89,156,87,151,365,29"/>
<area shape="rect" href="camp__common_8h.html" title="Header file for common constants and structures." alt="" coords="680,79,801,105"/>
<area shape="poly" title=" " alt="" coords="445,27,667,73,666,78,444,33"/>
<area shape="rect" title=" " alt="" coords="561,241,621,267"/>
<area shape="poly" title=" " alt="" coords="78,184,101,191,226,215,351,232,546,248,546,253,350,237,225,220,100,196,76,189"/>
<area shape="rect" title=" " alt="" coords="917,241,980,267"/>
<area shape="poly" title=" " alt="" coords="77,184,101,191,173,202,270,213,502,230,902,249,902,254,501,235,269,218,173,208,100,196,76,189"/>
<area shape="poly" title=" " alt="" coords="680,96,570,100,426,109,263,127,101,155,92,158,90,152,100,150,263,122,425,104,570,95,679,91"/>
<area shape="rect" title=" " alt="" coords="1304,160,1361,186"/>
<area shape="poly" title=" " alt="" coords="801,90,897,93,1020,102,1157,120,1293,150,1297,151,1296,156,1292,155,1156,125,1020,108,896,99,801,96"/>
<area shape="rect" href="time__derivative_8h.html" title="Header for the time derivative structure and related functions." alt="" coords="1161,160,1280,186"/>
<area shape="poly" title=" " alt="" coords="801,97,960,117,1150,150,1165,153,1164,159,1149,155,959,123,801,102"/>
<area shape="rect" title=" " alt="" coords="1385,160,1490,186"/>
<area shape="poly" title=" " alt="" coords="801,92,1052,108,1212,125,1373,150,1387,153,1386,158,1372,155,1211,130,1051,113,801,98"/>
<area shape="rect" title=" " alt="" coords="112,160,257,186"/>
<area shape="poly" title=" " alt="" coords="680,102,496,122,269,155,250,159,249,154,268,150,495,117,679,96"/>
<area shape="rect" title=" " alt="" coords="281,160,440,186"/>
<area shape="poly" title=" " alt="" coords="682,108,434,159,433,154,681,103"/>
<area shape="rect" title=" " alt="" coords="465,160,632,186"/>
<area shape="poly" title=" " alt="" coords="712,108,593,156,591,151,710,103"/>
<area shape="rect" title=" " alt="" coords="656,160,825,186"/>
<area shape="poly" title=" " alt="" coords="743,105,743,144,738,144,738,105"/>
<area shape="rect" title=" " alt="" coords="849,153,976,193"/>
<area shape="poly" title=" " alt="" coords="768,103,857,143,855,148,766,108"/>
<area shape="rect" title=" " alt="" coords="1000,153,1137,193"/>
<area shape="poly" title=" " alt="" coords="791,103,985,149,984,154,790,108"/>
<area shape="poly" title=" " alt="" coords="1180,189,1150,196,1004,219,859,236,637,253,637,248,858,230,1003,214,1149,191,1179,184"/>
<area shape="poly" title=" " alt="" coords="1179,189,995,242,994,237,1178,184"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h__dep__incl.png" border="0" usemap="#asub__models_8hdep" alt=""/></div>
<map name="asub__models_8hdep" id="asub__models_8hdep">
<area shape="rect" title="Header file for sub model functions." alt="" coords="292,5,393,31"/>
<area shape="rect" href="sub__model___p_d_fi_t_e_8c.html" title="PDFiTE Activity sub model solver functions." alt="" coords="5,87,152,112"/>
<area shape="poly" title=" " alt="" coords="288,38,120,88,118,83,287,33"/>
<area shape="rect" href="sub__model___u_n_i_f_a_c_8c.html" title="UNIFAC activity coefficient calculation." alt="" coords="176,87,328,112"/>
<area shape="poly" title=" " alt="" coords="319,43,267,88,264,84,316,39"/>
<area shape="rect" href="sub__model___z_s_r__aerosol__water_8c.html" title="ZSR Aerosol Water sub model solver functions." alt="" coords="351,79,518,120"/>
<area shape="poly" title=" " alt="" coords="370,39,414,77,410,81,366,43"/>
<area shape="rect" href="sub__model__solver_8c.html" title="Sub model solver functions." alt="" coords="542,87,679,112"/>
<area shape="poly" title=" " alt="" coords="399,33,570,83,568,88,397,38"/>
</map>
</div>
</div>
<p><a href="sub__models_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1c3598c177755e3ca9d3bde1ace7c0e0" id="r_a1c3598c177755e3ca9d3bde1ace7c0e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a1c3598c177755e3ca9d3bde1ace7c0e0">sub_model_PDFiTE_get_used_jac_elem</a> (int *sub_model_int_data, double *sub_model_float_data, <a class="el" href="struct_jacobian.html">Jacobian</a> *jac)</td></tr>
<tr class="memdesc:a1c3598c177755e3ca9d3bde1ace7c0e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag <a class="el" href="struct_jacobian.html">Jacobian</a> elements used by this sub model.  <br /></td></tr>
<tr class="separator:a1c3598c177755e3ca9d3bde1ace7c0e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0578f51652ce992842c2e65c8d84e55" id="r_ad0578f51652ce992842c2e65c8d84e55"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#ad0578f51652ce992842c2e65c8d84e55">sub_model_PDFiTE_update_ids</a> (int *sub_model_int_data, double *sub_model_float_data, int *deriv_ids, <a class="el" href="struct_jacobian.html">Jacobian</a> jac)</td></tr>
<tr class="memdesc:ad0578f51652ce992842c2e65c8d84e55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the time derivative and Jacbobian array indices.  <br /></td></tr>
<tr class="separator:ad0578f51652ce992842c2e65c8d84e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2d20ec59ac4397714d038f51324809d" id="r_ae2d20ec59ac4397714d038f51324809d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#ae2d20ec59ac4397714d038f51324809d">sub_model_PDFiTE_update_env_state</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data)</td></tr>
<tr class="memdesc:ae2d20ec59ac4397714d038f51324809d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update sub model data for new environmental conditions.  <br /></td></tr>
<tr class="separator:ae2d20ec59ac4397714d038f51324809d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f46f791a4a74c77e283b5afb91911aa" id="r_a2f46f791a4a74c77e283b5afb91911aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a2f46f791a4a74c77e283b5afb91911aa">sub_model_PDFiTE_calculate</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data)</td></tr>
<tr class="memdesc:a2f46f791a4a74c77e283b5afb91911aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the sub-model calculations for the current model state.  <br /></td></tr>
<tr class="separator:a2f46f791a4a74c77e283b5afb91911aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d2ccc5a5c4b40019447f6b7dd5feab" id="r_a50d2ccc5a5c4b40019447f6b7dd5feab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a50d2ccc5a5c4b40019447f6b7dd5feab">sub_model_PDFiTE_get_jac_contrib</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data, realtype *J, double time_step)</td></tr>
<tr class="memdesc:a50d2ccc5a5c4b40019447f6b7dd5feab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add contributions to the <a class="el" href="struct_jacobian.html">Jacobian</a> from derivates calculated using the output of this sub model.  <br /></td></tr>
<tr class="separator:a50d2ccc5a5c4b40019447f6b7dd5feab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f2820ce385881014fed09a82ae5364" id="r_a57f2820ce385881014fed09a82ae5364"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a57f2820ce385881014fed09a82ae5364">sub_model_PDFiTE_print</a> (int *sub_model_int_data, double *sub_model_float_data)</td></tr>
<tr class="memdesc:a57f2820ce385881014fed09a82ae5364"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the PDFiTE Activity sub model parameters.  <br /></td></tr>
<tr class="separator:a57f2820ce385881014fed09a82ae5364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6895ac51f6122ce830f30d8b1f09d052" id="r_a6895ac51f6122ce830f30d8b1f09d052"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a6895ac51f6122ce830f30d8b1f09d052">sub_model_UNIFAC_get_used_jac_elem</a> (int *sub_model_int_data, double *sub_model_float_data, <a class="el" href="struct_jacobian.html">Jacobian</a> *jac)</td></tr>
<tr class="memdesc:a6895ac51f6122ce830f30d8b1f09d052"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the <a class="el" href="struct_jacobian.html">Jacobian</a> elements used for a particular row of the matrix.  <br /></td></tr>
<tr class="separator:a6895ac51f6122ce830f30d8b1f09d052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2674d98846a9c4933d56156ec1f0deb5" id="r_a2674d98846a9c4933d56156ec1f0deb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a2674d98846a9c4933d56156ec1f0deb5">sub_model_UNIFAC_update_ids</a> (int *sub_model_int_data, double *sub_model_float_data, int *deriv_ids, <a class="el" href="struct_jacobian.html">Jacobian</a> jac)</td></tr>
<tr class="memdesc:a2674d98846a9c4933d56156ec1f0deb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update stored ids for elements used within a row of the <a class="el" href="struct_jacobian.html">Jacobian</a> matrix.  <br /></td></tr>
<tr class="separator:a2674d98846a9c4933d56156ec1f0deb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f3628a20f1bf545034554576e9c85c" id="r_a43f3628a20f1bf545034554576e9c85c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a43f3628a20f1bf545034554576e9c85c">sub_model_UNIFAC_update_env_state</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data)</td></tr>
<tr class="memdesc:a43f3628a20f1bf545034554576e9c85c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update sub-model data for new environmental conditions.  <br /></td></tr>
<tr class="separator:a43f3628a20f1bf545034554576e9c85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91d55564c556bf61d6bf0ccac7b43e4b" id="r_a91d55564c556bf61d6bf0ccac7b43e4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a91d55564c556bf61d6bf0ccac7b43e4b">sub_model_UNIFAC_calculate</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data)</td></tr>
<tr class="memdesc:a91d55564c556bf61d6bf0ccac7b43e4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the sub-model calculations for the current model state.  <br /></td></tr>
<tr class="separator:a91d55564c556bf61d6bf0ccac7b43e4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0301d06b09af90fcfe49f9a1ba7c6742" id="r_a0301d06b09af90fcfe49f9a1ba7c6742"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a0301d06b09af90fcfe49f9a1ba7c6742">sub_model_UNIFAC_get_jac_contrib</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data, realtype *J, double time_step)</td></tr>
<tr class="memdesc:a0301d06b09af90fcfe49f9a1ba7c6742"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add contributions to the <a class="el" href="struct_jacobian.html">Jacobian</a> from derivates calculated using the output of this sub model.  <br /></td></tr>
<tr class="separator:a0301d06b09af90fcfe49f9a1ba7c6742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac47310b67585f52b71ff6aac1c603ba5" id="r_ac47310b67585f52b71ff6aac1c603ba5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#ac47310b67585f52b71ff6aac1c603ba5">sub_model_UNIFAC_print</a> (int *sub_model_int_data, double *sub_model_float_data)</td></tr>
<tr class="memdesc:ac47310b67585f52b71ff6aac1c603ba5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the sub model data.  <br /></td></tr>
<tr class="separator:ac47310b67585f52b71ff6aac1c603ba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c47a7f4b91fa19f71a1a69237a6754e" id="r_a0c47a7f4b91fa19f71a1a69237a6754e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a0c47a7f4b91fa19f71a1a69237a6754e">sub_model_ZSR_aerosol_water_get_used_jac_elem</a> (int *sub_model_int_data, double *sub_model_float_data, <a class="el" href="struct_jacobian.html">Jacobian</a> *jac)</td></tr>
<tr class="memdesc:a0c47a7f4b91fa19f71a1a69237a6754e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag <a class="el" href="struct_jacobian.html">Jacobian</a> elements used by this sub model.  <br /></td></tr>
<tr class="separator:a0c47a7f4b91fa19f71a1a69237a6754e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af42c83e6bae3321e17f4bf21620e36ed" id="r_af42c83e6bae3321e17f4bf21620e36ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#af42c83e6bae3321e17f4bf21620e36ed">sub_model_ZSR_aerosol_water_update_ids</a> (int *sub_model_int_data, double *sub_model_float_data, int *deriv_ids, <a class="el" href="struct_jacobian.html">Jacobian</a> jac)</td></tr>
<tr class="memdesc:af42c83e6bae3321e17f4bf21620e36ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the time derivative and Jacbobian array indices.  <br /></td></tr>
<tr class="separator:af42c83e6bae3321e17f4bf21620e36ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a915b2885008bfb4bd6c9c37efd6e8d82" id="r_a915b2885008bfb4bd6c9c37efd6e8d82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a915b2885008bfb4bd6c9c37efd6e8d82">sub_model_ZSR_aerosol_water_update_env_state</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data)</td></tr>
<tr class="memdesc:a915b2885008bfb4bd6c9c37efd6e8d82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update sub model data for new environmental conditions.  <br /></td></tr>
<tr class="separator:a915b2885008bfb4bd6c9c37efd6e8d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6639a32646d84e02917b64167f36ea89" id="r_a6639a32646d84e02917b64167f36ea89"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a6639a32646d84e02917b64167f36ea89">sub_model_ZSR_aerosol_water_calculate</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data)</td></tr>
<tr class="memdesc:a6639a32646d84e02917b64167f36ea89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do pre-derivative calculations.  <br /></td></tr>
<tr class="separator:a6639a32646d84e02917b64167f36ea89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6bf886e4a9fadb02913dab07e19018b" id="r_aa6bf886e4a9fadb02913dab07e19018b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#aa6bf886e4a9fadb02913dab07e19018b">sub_model_ZSR_aerosol_water_get_jac_contrib</a> (int *sub_model_int_data, double *sub_model_float_data, double *sub_model_env_data, <a class="el" href="struct_model_data.html">ModelData</a> *model_data, realtype *J, double time_step)</td></tr>
<tr class="memdesc:aa6bf886e4a9fadb02913dab07e19018b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add contributions to the <a class="el" href="struct_jacobian.html">Jacobian</a> from derivates calculated using the output of this sub model.  <br /></td></tr>
<tr class="separator:aa6bf886e4a9fadb02913dab07e19018b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a95ee9cc01c0905493fcb19e00c8b0" id="r_a74a95ee9cc01c0905493fcb19e00c8b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sub__models_8h.html#a74a95ee9cc01c0905493fcb19e00c8b0">sub_model_ZSR_aerosol_water_print</a> (int *sub_model_int_data, double *sub_model_float_data)</td></tr>
<tr class="memdesc:a74a95ee9cc01c0905493fcb19e00c8b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the ZSR Aerosol Water sub model parameters.  <br /></td></tr>
<tr class="separator:a74a95ee9cc01c0905493fcb19e00c8b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for sub model functions. </p>

<p class="definition">Definition in file <a class="el" href="sub__models_8h_source.html">sub_models.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a2f46f791a4a74c77e283b5afb91911aa" name="a2f46f791a4a74c77e283b5afb91911aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f46f791a4a74c77e283b5afb91911aa">&#9670;&#160;</a></span>sub_model_PDFiTE_calculate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_PDFiTE_calculate </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the sub-model calculations for the current model state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data including the current state and environmental conditions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html#l00167">167</a> of file <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html">sub_model_PDFiTE.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a2f46f791a4a74c77e283b5afb91911aa_icgraph.png" border="0" usemap="#asub__models_8h_a2f46f791a4a74c77e283b5afb91911aa_icgraph" alt=""/></div>
<map name="asub__models_8h_a2f46f791a4a74c77e283b5afb91911aa_icgraph" id="asub__models_8h_a2f46f791a4a74c77e283b5afb91911aa_icgraph">
<area shape="rect" title="Perform the sub&#45;model calculations for the current model state." alt="" coords="795,150,990,175"/>
<area shape="rect" href="sub__model__solver_8c.html#a7f9027610b25bafcc5b6c5af1344dd65" title="Perform the sub model calculations for the current model state." alt="" coords="604,150,747,175"/>
<area shape="poly" title=" " alt="" coords="780,165,747,165,747,160,780,160"/>
<area shape="rect" href="camp__solver_8c.html#ac55302bc18db0d68d78f543aad6a16c4" title="Compute the time derivative f(t,y)" alt="" coords="517,150,556,175"/>
<area shape="poly" title=" " alt="" coords="588,165,556,165,556,160,588,160"/>
<area shape="rect" href="camp__solver_8c.html#a13451d507558a61a2353adfed58db468" title="Compute the Jacobian." alt="" coords="182,38,225,63"/>
<area shape="poly" title=" " alt="" coords="649,141,616,111,573,77,523,46,468,22,420,11,382,9,293,22,257,32,226,44,224,39,255,27,291,17,381,3,421,5,470,17,525,41,576,73,620,107,652,137"/>
<area shape="rect" href="camp__solver_8c.html#afc5ec8680b419e7ab49530d53a76cee4" title="Solve for a given timestep." alt="" coords="163,279,244,305"/>
<area shape="poly" title=" " alt="" coords="653,188,620,218,577,253,526,286,470,310,409,322,348,322,291,315,244,306,245,300,291,310,348,317,409,317,469,305,523,281,574,249,617,214,649,184"/>
<area shape="rect" href="camp__solver_8c.html#ad45be595da1a1d6fd40179d9743a9a65" title="Check a Jacobian for accuracy." alt="" coords="339,63,423,89"/>
<area shape="poly" title=" " alt="" coords="512,140,492,121,468,103,422,86,424,81,471,99,495,116,516,136"/>
<area shape="poly" title=" " alt="" coords="525,136,504,90,488,69,468,53,437,39,403,31,369,27,335,28,272,36,226,47,224,42,271,30,334,22,369,22,404,26,439,34,471,48,492,65,509,88,530,133"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,120,115,146"/>
<area shape="poly" title=" " alt="" coords="502,167,469,168,381,170,292,168,198,158,115,145,116,140,199,153,292,162,381,165,469,162,502,161"/>
<area shape="rect" href="camp__solver_8c.html#a51bc2a16028d4c72dd39669c31f6fc17" title="Determine if there is anything to solve." alt="" coords="292,228,469,254"/>
<area shape="poly" title=" " alt="" coords="509,187,471,211,427,230,425,225,468,207,506,183"/>
<area shape="poly" title=" " alt="" coords="528,191,507,232,491,253,471,269,443,283,413,293,352,304,293,305,244,301,245,296,293,299,351,298,412,288,441,278,468,264,487,249,502,230,523,189"/>
<area shape="rect" href="camp__debug_8h.html#a0352ebf153678772ffbeb405834c141d" title="Evaluate the derivative and Jacobian near a given state for a specified species." alt="" coords="318,113,444,153"/>
<area shape="poly" title=" " alt="" coords="502,159,444,148,445,142,503,154"/>
<area shape="poly" title=" " alt="" coords="323,70,224,56,225,51,323,65"/>
<area shape="poly" title=" " alt="" coords="170,72,86,122,83,117,168,68"/>
<area shape="poly" title=" " alt="" coords="319,261,245,283,243,278,318,256"/>
</map>
</div>

</div>
</div>
<a id="a50d2ccc5a5c4b40019447f6b7dd5feab" name="a50d2ccc5a5c4b40019447f6b7dd5feab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50d2ccc5a5c4b40019447f6b7dd5feab">&#9670;&#160;</a></span>sub_model_PDFiTE_get_jac_contrib()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_PDFiTE_get_jac_contrib </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype *&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add contributions to the <a class="el" href="struct_jacobian.html">Jacobian</a> from derivates calculated using the output of this sub model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data </td></tr>
    <tr><td class="paramname">J</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> to be calculated </td></tr>
    <tr><td class="paramname">time_step</td><td>Current time step in [s] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html#l00277">277</a> of file <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html">sub_model_PDFiTE.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a50d2ccc5a5c4b40019447f6b7dd5feab_icgraph.png" border="0" usemap="#asub__models_8h_a50d2ccc5a5c4b40019447f6b7dd5feab_icgraph" alt=""/></div>
<map name="asub__models_8h_a50d2ccc5a5c4b40019447f6b7dd5feab_icgraph" id="asub__models_8h_a50d2ccc5a5c4b40019447f6b7dd5feab_icgraph">
<area shape="rect" title="Add contributions to the Jacobian from derivates calculated using the output of this sub model." alt="" coords="480,5,642,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a9575eb8104f46d396268c361164e88fb" title="Calculate the Jacobian constributions from sub model calculations." alt="" coords="253,13,432,39"/>
<area shape="poly" title=" " alt="" coords="465,28,433,28,433,23,465,23"/>
<area shape="rect" href="camp__solver_8c.html#a13451d507558a61a2353adfed58db468" title="Compute the Jacobian." alt="" coords="163,13,205,39"/>
<area shape="poly" title=" " alt="" coords="238,28,205,28,205,23,238,23"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,13,115,39"/>
<area shape="poly" title=" " alt="" coords="147,28,115,28,115,23,147,23"/>
</map>
</div>

</div>
</div>
<a id="a1c3598c177755e3ca9d3bde1ace7c0e0" name="a1c3598c177755e3ca9d3bde1ace7c0e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c3598c177755e3ca9d3bde1ace7c0e0">&#9670;&#160;</a></span>sub_model_PDFiTE_get_used_jac_elem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_PDFiTE_get_used_jac_elem </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_jacobian.html">Jacobian</a> *&#160;</td>
          <td class="paramname"><em>jac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag <a class="el" href="struct_jacobian.html">Jacobian</a> elements used by this sub model. </p>
<p>activity sub models are assumed to be at equilibrium</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">jac</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html#l00073">73</a> of file <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html">sub_model_PDFiTE.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0_cgraph.png" border="0" usemap="#asub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0_cgraph" alt=""/></div>
<map name="asub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0_cgraph" id="asub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0_cgraph">
<area shape="rect" title="Flag Jacobian elements used by this sub model." alt="" coords="5,5,167,46"/>
<area shape="rect" href="_jacobian_8c.html#aac51ac6b1cf239a84899308dab229441" title="Adds an element to the sparse matrix." alt="" coords="215,13,387,39"/>
<area shape="poly" title=" " alt="" coords="167,23,199,23,199,28,167,28"/>
<area shape="rect" href="_jacobian_8c.html#ad9cda15d66705739c9d7bdf63c4636a3" title=" " alt="" coords="435,5,613,46"/>
<area shape="poly" title=" " alt="" coords="387,23,419,23,419,28,387,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0_icgraph.png" border="0" usemap="#asub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0_icgraph" alt=""/></div>
<map name="asub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0_icgraph" id="asub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0_icgraph">
<area shape="rect" title="Flag Jacobian elements used by this sub model." alt="" coords="714,35,875,75"/>
<area shape="rect" href="sub__model__solver_8c.html#a4b1d9807c5fc6b0f2129eb420fa191ad" title="Get the Jacobian elements used by a particular sub model." alt="" coords="303,5,447,46"/>
<area shape="poly" title=" " alt="" coords="698,51,448,33,448,28,698,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a61bf1cc1ad435b59182e1db138cc1b53" title="Set the map for sub&#45;model interdependence." alt="" coords="500,68,666,93"/>
<area shape="poly" title=" " alt="" coords="699,69,666,73,666,68,698,64"/>
<area shape="rect" href="camp__solver_8c.html#a5b485fa25356197023889f3795888e98" title="Try to improve guesses of y sent to the linear solver." alt="" coords="163,42,250,68"/>
<area shape="poly" title=" " alt="" coords="288,44,251,50,250,45,287,38"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,42,115,68"/>
<area shape="poly" title=" " alt="" coords="147,58,115,58,115,52,147,52"/>
<area shape="rect" href="sub__model__solver_8c.html#a38ebe393b32d9f9ac185b12801c69e17" title="Update the time derivative and Jacobian array ids." alt="" coords="298,70,452,96"/>
<area shape="poly" title=" " alt="" coords="485,84,453,85,453,79,485,79"/>
<area shape="poly" title=" " alt="" coords="282,70,250,65,251,60,283,65"/>
</map>
</div>

</div>
</div>
<a id="a57f2820ce385881014fed09a82ae5364" name="a57f2820ce385881014fed09a82ae5364"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57f2820ce385881014fed09a82ae5364">&#9670;&#160;</a></span>sub_model_PDFiTE_print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_PDFiTE_print </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the PDFiTE Activity sub model parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html#l00462">462</a> of file <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html">sub_model_PDFiTE.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a57f2820ce385881014fed09a82ae5364_icgraph.png" border="0" usemap="#asub__models_8h_a57f2820ce385881014fed09a82ae5364_icgraph" alt=""/></div>
<map name="asub__models_8h_a57f2820ce385881014fed09a82ae5364_icgraph" id="asub__models_8h_a57f2820ce385881014fed09a82ae5364_icgraph">
<area shape="rect" title="Print the PDFiTE Activity sub model parameters." alt="" coords="202,5,370,31"/>
<area shape="rect" href="sub__model__solver_8c.html#a1e59f0e39671190ef139baa1021d9edf" title="Print the sub model data." alt="" coords="5,5,154,31"/>
<area shape="poly" title=" " alt="" coords="186,21,154,21,154,16,186,16"/>
</map>
</div>

</div>
</div>
<a id="ae2d20ec59ac4397714d038f51324809d" name="ae2d20ec59ac4397714d038f51324809d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2d20ec59ac4397714d038f51324809d">&#9670;&#160;</a></span>sub_model_PDFiTE_update_env_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_PDFiTE_update_env_state </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update sub model data for new environmental conditions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html#l00137">137</a> of file <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html">sub_model_PDFiTE.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_ae2d20ec59ac4397714d038f51324809d_icgraph.png" border="0" usemap="#asub__models_8h_ae2d20ec59ac4397714d038f51324809d_icgraph" alt=""/></div>
<map name="asub__models_8h_ae2d20ec59ac4397714d038f51324809d_icgraph" id="asub__models_8h_ae2d20ec59ac4397714d038f51324809d_icgraph">
<area shape="rect" title="Update sub model data for new environmental conditions." alt="" coords="341,5,523,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a78345e452d180e21b072ca0bc574042b" title="Update sub model data for a new environmental state." alt="" coords="135,5,293,46"/>
<area shape="poly" title=" " alt="" coords="325,28,293,28,293,23,325,23"/>
<area shape="rect" href="camp__solver_8c.html#afc5ec8680b419e7ab49530d53a76cee4" title="Solve for a given timestep." alt="" coords="5,13,87,39"/>
<area shape="poly" title=" " alt="" coords="119,28,87,28,87,23,119,23"/>
</map>
</div>

</div>
</div>
<a id="ad0578f51652ce992842c2e65c8d84e55" name="ad0578f51652ce992842c2e65c8d84e55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0578f51652ce992842c2e65c8d84e55">&#9670;&#160;</a></span>sub_model_PDFiTE_update_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_PDFiTE_update_ids </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>deriv_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_jacobian.html">Jacobian</a>&#160;</td>
          <td class="paramname"><em>jac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the time derivative and Jacbobian array indices. </p>
<p>activity sub models are assumed to be at equilibrium</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">deriv_ids</td><td>Indices for state array variables on the solver state array </td></tr>
    <tr><td class="paramname">jac</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html#l00105">105</a> of file <a class="el" href="sub__model___p_d_fi_t_e_8c_source.html">sub_model_PDFiTE.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_ad0578f51652ce992842c2e65c8d84e55_cgraph.png" border="0" usemap="#asub__models_8h_ad0578f51652ce992842c2e65c8d84e55_cgraph" alt=""/></div>
<map name="asub__models_8h_ad0578f51652ce992842c2e65c8d84e55_cgraph" id="asub__models_8h_ad0578f51652ce992842c2e65c8d84e55_cgraph">
<area shape="rect" title="Update the time derivative and Jacbobian array indices." alt="" coords="5,5,212,31"/>
<area shape="rect" href="_jacobian_8c.html#a7b43d5884ec62826389d6d739b7f25eb" title="Get an element id in the Jacobian data arrays." alt="" coords="260,5,424,31"/>
<area shape="poly" title=" " alt="" coords="212,16,244,16,244,21,212,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_ad0578f51652ce992842c2e65c8d84e55_icgraph.png" border="0" usemap="#asub__models_8h_ad0578f51652ce992842c2e65c8d84e55_icgraph" alt=""/></div>
<map name="asub__models_8h_ad0578f51652ce992842c2e65c8d84e55_icgraph" id="asub__models_8h_ad0578f51652ce992842c2e65c8d84e55_icgraph">
<area shape="rect" title="Update the time derivative and Jacbobian array indices." alt="" coords="500,5,707,31"/>
<area shape="rect" href="sub__model__solver_8c.html#a38ebe393b32d9f9ac185b12801c69e17" title="Update the time derivative and Jacobian array ids." alt="" coords="298,5,452,31"/>
<area shape="poly" title=" " alt="" coords="485,21,453,21,453,16,485,16"/>
<area shape="rect" href="camp__solver_8c.html#a5b485fa25356197023889f3795888e98" title="Try to improve guesses of y sent to the linear solver." alt="" coords="163,5,250,31"/>
<area shape="poly" title=" " alt="" coords="282,21,250,21,250,16,282,16"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,5,115,31"/>
<area shape="poly" title=" " alt="" coords="147,21,115,21,115,16,147,16"/>
</map>
</div>

</div>
</div>
<a id="a91d55564c556bf61d6bf0ccac7b43e4b" name="a91d55564c556bf61d6bf0ccac7b43e4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91d55564c556bf61d6bf0ccac7b43e4b">&#9670;&#160;</a></span>sub_model_UNIFAC_calculate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_UNIFAC_calculate </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the sub-model calculations for the current model state. </p>
<p>These calculations are based on equations (1)&ndash;(9) in <b>[Marcolli2005]</b>. Variable names used in the derivation of the <a class="el" href="struct_jacobian.html">Jacobian</a> equations are adopted here for consistency. Specifically, these are:  </p><p class="formulaDsp">
\[
  \begin{align*}
   \sigma &amp; \equiv \displaystyle\sum_k r_k x_k, \\
   \tau &amp; \equiv \displaystyle\sum_k q_k x_k, \\
   \mu &amp; \equiv \displaystyle\sum_j x_j l_j, \\
   c_{xX} &amp; = \frac{1}{\displaystyle\sum_j
                  \displaystyle\sum_i v_j^{(i)} x_i}, \textrm{ and} \\
   \Pi &amp; \equiv \displaystyle\sum_n Q_n X_n. \\
  \end{align*}
\]
</p>
<p> Using these variables and subscript \(j\) for the species whose activity is being calculated for easy comparison with the <a class="el" href="struct_jacobian.html">Jacobian</a> calculations, equations (1)&ndash;(9) in <b>[Marcolli2005]</b> become:  </p><p class="formulaDsp">
\[
  \begin{align*}
   \ln{\gamma_j} &amp; = \ln{\gamma_j^C} + \ln{\gamma_j^R} &amp; (1) \\
   \alpha_w &amp; = \gamma_w x_w &amp; (2) \\
   \ln{\gamma_j^C} &amp; = \ln{\frac{\Phi_j}{x_j}}
                      + \frac{z}{2}q_j\ln{\frac{\Theta_j}{\Phi_j}}
                      + l_j
                      - \frac{\Phi_j}{x_j}\mu &amp; (3) \\
   \Phi_j &amp; = \frac{r_j x_j}{\sigma}; \qquad
   \Theta_j = \frac{q_j x_j}{\tau} &amp; (4) \\
   l_j &amp; = \frac{z}{2}\left(r_j - q_j\right) - r_j + 1 &amp; (5) \\
   r_j &amp; = \displaystyle\sum_k v_k^{(j)}R_k; \qquad
   q_j   = \displaystyle\sum_k v_k^{(j)}Q_k &amp; (6) \\
   \ln{\gamma_j^R} &amp; = \displaystyle\sum_k v_k^{(j)} \left[
                       \ln{\Gamma_k} - \ln{\Gamma_k^{(j)}}\right] &amp; (7) \\
   \ln{\Gamma_k} &amp; = Q_k \left[ 1 - \ln{\Xi_k} -
                     \displaystyle\sum_m\frac{\Theta_m\Phi_{km}}{\Xi_m}
                     \right] &amp; (8) \\
   \Theta_m &amp; = \frac{Q_m X_m}{\Pi}; \qquad
   \Psi_{mn} = \mathrm{exp}\left[\frac{-a_{mn}}{T}\right] &amp; (9) \\
  \end{align*}
\]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data including the current state and environmental conditions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html#l00226">226</a> of file <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html">sub_model_UNIFAC.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a91d55564c556bf61d6bf0ccac7b43e4b_icgraph.png" border="0" usemap="#asub__models_8h_a91d55564c556bf61d6bf0ccac7b43e4b_icgraph" alt=""/></div>
<map name="asub__models_8h_a91d55564c556bf61d6bf0ccac7b43e4b_icgraph" id="asub__models_8h_a91d55564c556bf61d6bf0ccac7b43e4b_icgraph">
<area shape="rect" title="Perform the sub&#45;model calculations for the current model state." alt="" coords="795,150,995,175"/>
<area shape="rect" href="sub__model__solver_8c.html#a7f9027610b25bafcc5b6c5af1344dd65" title="Perform the sub model calculations for the current model state." alt="" coords="604,150,747,175"/>
<area shape="poly" title=" " alt="" coords="780,165,747,165,747,160,780,160"/>
<area shape="rect" href="camp__solver_8c.html#ac55302bc18db0d68d78f543aad6a16c4" title="Compute the time derivative f(t,y)" alt="" coords="517,150,556,175"/>
<area shape="poly" title=" " alt="" coords="588,165,556,165,556,160,588,160"/>
<area shape="rect" href="camp__solver_8c.html#a13451d507558a61a2353adfed58db468" title="Compute the Jacobian." alt="" coords="182,38,225,63"/>
<area shape="poly" title=" " alt="" coords="649,141,616,111,573,77,523,46,468,22,420,11,382,9,293,22,257,32,226,44,224,39,255,27,291,17,381,3,421,5,470,17,525,41,576,73,620,107,652,137"/>
<area shape="rect" href="camp__solver_8c.html#afc5ec8680b419e7ab49530d53a76cee4" title="Solve for a given timestep." alt="" coords="163,279,244,305"/>
<area shape="poly" title=" " alt="" coords="653,188,620,218,577,253,526,286,470,310,409,322,348,322,291,315,244,306,245,300,291,310,348,317,409,317,469,305,523,281,574,249,617,214,649,184"/>
<area shape="rect" href="camp__solver_8c.html#ad45be595da1a1d6fd40179d9743a9a65" title="Check a Jacobian for accuracy." alt="" coords="339,63,423,89"/>
<area shape="poly" title=" " alt="" coords="512,140,492,121,468,103,422,86,424,81,471,99,495,116,516,136"/>
<area shape="poly" title=" " alt="" coords="525,136,504,90,488,69,468,53,437,39,403,31,369,27,335,28,272,36,226,47,224,42,271,30,334,22,369,22,404,26,439,34,471,48,492,65,509,88,530,133"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,120,115,146"/>
<area shape="poly" title=" " alt="" coords="502,167,469,168,381,170,292,168,198,158,115,145,116,140,199,153,292,162,381,165,469,162,502,161"/>
<area shape="rect" href="camp__solver_8c.html#a51bc2a16028d4c72dd39669c31f6fc17" title="Determine if there is anything to solve." alt="" coords="292,228,469,254"/>
<area shape="poly" title=" " alt="" coords="509,187,471,211,427,230,425,225,468,207,506,183"/>
<area shape="poly" title=" " alt="" coords="528,191,507,232,491,253,471,269,443,283,413,293,352,304,293,305,244,301,245,296,293,299,351,298,412,288,441,278,468,264,487,249,502,230,523,189"/>
<area shape="rect" href="camp__debug_8h.html#a0352ebf153678772ffbeb405834c141d" title="Evaluate the derivative and Jacobian near a given state for a specified species." alt="" coords="318,113,444,153"/>
<area shape="poly" title=" " alt="" coords="502,159,444,148,445,142,503,154"/>
<area shape="poly" title=" " alt="" coords="323,70,224,56,225,51,323,65"/>
<area shape="poly" title=" " alt="" coords="170,72,86,122,83,117,168,68"/>
<area shape="poly" title=" " alt="" coords="319,261,245,283,243,278,318,256"/>
</map>
</div>

</div>
</div>
<a id="a0301d06b09af90fcfe49f9a1ba7c6742" name="a0301d06b09af90fcfe49f9a1ba7c6742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0301d06b09af90fcfe49f9a1ba7c6742">&#9670;&#160;</a></span>sub_model_UNIFAC_get_jac_contrib()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_UNIFAC_get_jac_contrib </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype *&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add contributions to the <a class="el" href="struct_jacobian.html">Jacobian</a> from derivates calculated using the output of this sub model. </p>
<p>This derivation starts from equations (1)&ndash;(9) in <b>[Marcolli2005]</b>. The mole fraction of species \(i\) is calculated as:  </p><p class="formulaDsp">
\[
   x_i = \frac{m_i}{m_T},
\]
</p>
<p> where \(m_T = \displaystyle\sum_j m_j\), \(m_i = \frac{c_i}{\mathrm{MW}_i}\) is the number in moles of species \(i\), \(c_i\) is its mass concentration ( \(\mathrm{ug} \: \mathrm{m}^{-3}\); the state variable), and \(\mathrm{MW}_i\) is its molecular weight ( \(\mathrm{ug} \: \mathrm{mol}^{-1}\)). Thus,  </p><p class="formulaDsp">
\[
  \begin{align*}
   \frac{\partial x_i}{\partial c_i} &amp; =
      \frac{(m_T-m_i)}{\mathrm{MW}_i m_T^2}, \textrm{ and} \\
   \frac{\partial x_j}{\partial c_i} &amp; =
      -\frac{m_j}{\mathrm{MW}_i m_T^2} \quad \text{for } i\neq j. \\
  \end{align*}
\]
</p>
<p> The partial derivative of \(\Phi_j\) (Eq. 4) with respect to \(c_i\) is derived as follows:  </p><p class="formulaDsp">
\[
  \begin{align*}
    \frac{\partial r_i x_i}{\partial c_i} &amp; =
       r_i \frac{(m_T-m_i)}{\mathrm{MW}_i m_T^2}, \\
    \frac{\partial r_j x_j}{\partial c_i} &amp; =
       - r_j \frac{m_j}{\mathrm{MW}_i m_T^2}
       \quad \text{for } i\neq j, \\
    \frac{\partial \displaystyle\sum_j r_j x_j}{\partial c_i} &amp; =
       \frac{1}{\mathrm{MW}_i m_T}\left[r_i -
       \displaystyle\sum_j r_j x_j\right], \\
    \sigma &amp; \equiv \displaystyle\sum_k r_k x_k, \\
    \frac{\partial \Phi_j}{\partial c_i} &amp; =
    \frac{r_j}{\mathrm{MW}_i m_T \sigma^2}
    \left(\sigma^{\prime} - x_j r_i \right)
    , \qquad
        \sigma^{\prime} =
        \begin{cases}
          \sigma  &amp; \quad \text{if } i=j \\
          0    &amp; \quad \text{if } i\neq j
        \end{cases} \\
  \end{align*}
\]
</p>
<p> Similarly, the partial derivative of \(\Theta_j\) (Eq. 4) with respect to \(c_i\) is:  </p><p class="formulaDsp">
\[
\begin{align*}
   \tau &amp; \equiv \displaystyle\sum_k q_k x_k, \\
   \frac{\partial \Theta_j}{\partial c_i} &amp; =
    \frac{q_j}{\mathrm{MW}_i m_T \tau^2}
    \left(\tau^{\prime} - x_j q_i \right)
    , \qquad
        \tau^{\prime} =
        \begin{cases}
          \tau  &amp; \quad \text{if } i=j \\
          0    &amp; \quad \text{if } i\neq j
        \end{cases} \\
\end{align*}
\]
</p>
<p> From Eqs 5 and 6,  </p><p class="formulaDsp">
\[
   \frac{\partial r_j}{\partial c_i} =
   \frac{\partial q_j}{\partial c_i} =
   \frac{\partial l_j}{\partial c_i} = 0.
\]
</p>
<p> For the last term in Eq. 3,  </p><p class="formulaDsp">
\[
\begin{align*}
   \mu &amp; \equiv \displaystyle\sum_j x_j l_j, \\
   \frac{\partial \mu}{\partial c_i} &amp; = \frac{1}{\mathrm{MW}_i m_T}
       \left( l_i - \mu \right). \\
\end{align*}
\]
</p>
<p> The partial derivative of the full combinatorial term (Eq. 3) is:  </p><p class="formulaDsp">
\[
\begin{align*}
   \frac{\partial \ln{\gamma^C_j}}{\partial c_i} &amp; =
       \frac{x_j}{\Phi_j}\frac{\left( \frac{\partial \Phi_j}{\partial c_i}
           x_j - \Phi_j\frac{\partial x_j}{\partial c_i} \right)}{x_j^2} \\
     &amp; \quad + \frac{z}{2}q_j\frac{\Phi_j}{\Theta_j}\frac{\left(
           \frac{\partial \Theta_j}{\partial c_i} \Phi_j -
           \Theta_j\frac{\partial \Phi_j}{\partial c_i}\right)}{\Phi_j^2} \\
     &amp; \quad - \frac{\left[ \left( \frac{\partial \Phi_j}{\partial c_i} \mu +
            \Phi_j \frac{\partial \mu}{\partial c_i} \right) x_j
            - \Phi_j \mu \frac{\partial x_j}{\partial c_i} \right]}{x_j^2}.
\end{align*}
\]
</p>
<p> After some rearranging, this becomes:  </p><p class="formulaDsp">
\[
\begin{align*}
   \frac{\partial \ln{\gamma^C_j}}{\partial c_i} &amp; =
       \frac{1}{\Phi_j}\frac{\partial \Phi_j}{\partial c_i}
       - \frac{1}{x_j}\frac{\partial x_j}{\partial c_i} \\
     &amp; \quad + \frac{z}{2}q_j\left(
       \frac{1}{\Theta_j}\frac{\partial \Theta_j}{\partial c_i}
       - \frac{1}{\Phi_j}\frac{\partial \Phi_j}{\partial c_i}\right) \\
     &amp; \quad - \frac{\partial \Phi_j}{\partial c_i}\frac{\mu}{x_j}
     - \frac{\Phi_j}{x_j}\frac{\partial \mu}{\partial c_i}
     + \frac{\Phi_j \mu}{x_j^2}\frac{\partial x_j}{\partial c_i}
\end{align*}
\]
</p>
<p> As \(\sigma\), \(\tau\), and \(\mu\) are independent of species \(i\), these can be calculated outside the loop over the independent species. Moving to the residual term (Eq. 7), the mole fraction ( \(X_p\)) of group \(p\) in the mixture is related to the mole fraction ( \(x_j\)) of species \(j\) according to:  </p><p class="formulaDsp">
\[
   X_p = c_{xX} \omega_p, \textrm{ where }
   \omega_p \equiv \displaystyle\sum_j v_p^{(j)} x_j, \\
\]
</p>
<p> and \(c_{xX}\) is a conversion factor accounting for the difference in total species and total group number concentrations:  </p><p class="formulaDsp">
\[
   c_{xX} = \frac{1}{\displaystyle\sum_p \omega_p}.
\]
</p>
<p> Partial derivatives of the group interaction terms in Eq 9, \(\Theta_m\) and \(\Psi_{mn}\), with respect to \(c_i\) are derived as follows:  </p><p class="formulaDsp">
\[
  \begin{align*}
    \frac{\partial c_{xX}}{\partial c_i} &amp; = - c_{xX}^2
      \displaystyle\sum_p \displaystyle\sum_j v_p^{(j)}
      \frac{\partial x_j}{\partial c_i}
      = - \frac{c_{xX}^2}{\mathrm{MW}_im_T} \left(
            \displaystyle\sum_p v_p^{(i)} -
            \displaystyle\sum_p \omega_p \right), \\
      &amp; = \frac{c_{xX}}{\mathrm{MW}_im_T} \left(
              1 - c_{xX} \displaystyle\sum_p v_p^{(i)} \right), \\
    \frac{\partial X_n}{\partial c_i} &amp; =
      c_{xX} \displaystyle\sum_j v_n^{(j)}
           \frac{\partial x_j}{\partial c_i}
      + \frac{\partial c_{xX}}{\partial c_i} \omega_n, \\
      &amp; = \frac{c_{xX}}{\mathrm{MW}_im_T}
                 \left( v_n^{(i)} - \omega_n \right)
            + \frac{c_{xX}}{\mathrm{MW}_im_T}
                 \left( \omega_n - c_{xX}\omega_n
                     \displaystyle\sum_p v_p^{(i)} \right), \\
       &amp; = \frac{c_{xX}}{\mathrm{MW}_im_T} \left(
                 v_n^{(i)} - X_n
                     \displaystyle\sum_p v_p^{(i)} \right), \\
    \Pi &amp; \equiv \displaystyle\sum_n Q_n X_n, \\
    \frac{\partial \Pi}{\partial c_i} &amp; =
       \displaystyle\sum_n Q_n
       \frac{c_{xX}}{\mathrm{MW}_i m_T}\left(
           v_n^{(i)} - X_n \displaystyle\sum_p v_p^{(i)} \right), \\
    &amp; = \frac{c_{xX}}{\mathrm{MW}_i m_T} \left(
           \displaystyle\sum_n Q_n v_n^{(i)} -
           \Pi \displaystyle\sum_p v_p^{(i)} \right), \\
    \frac{\partial \Theta_m}{\partial c_i} &amp; = \frac{
    \left(Q_m\frac{\partial X_m}{\partial c_i} \Pi -
        Q_m X_m \frac{\partial \Pi}{\partial c_i} \right)}{\Pi^2} , \\
    &amp; = \frac{c_{xX} Q_m}{\mathrm{MW}_im_T\Pi^2} \left[
             \left( \Pi v_m^{(i)} - \Pi X_m
                 \displaystyle\sum_p v_p^{(i)} \right) -
             \left( X_m \displaystyle\sum_n Q_n v_n^{(i)} -
                 X_m \Pi \displaystyle\sum_p v_p^{(i)} \right) \right], \\
    &amp; = \frac{c_{xX} Q_m}{\mathrm{MW}_im_T\Pi^2} \left[
           \Pi v_m^{(i)} - X_m\displaystyle\sum_n Q_n v_n^{(i)}\right],
       \textrm{ and} \\
   \frac{\partial \Psi_{mn}}{\partial c_i} &amp; = 0
  \end{align*}
\]
</p>
<p> The partial derivative of the group residual activity coefficient (Eq. 8) with respect to \(c_i\) is:  </p><p class="formulaDsp">
\[
  \begin{align*}
   \frac{\partial \ln{\Gamma_k}}{\partial c_i} &amp; = Q_k \left[
     - \frac{1}{\displaystyle\sum_m\Theta_m\Psi_{mk}}
       \displaystyle\sum_m\frac{\partial\Theta_m}{\partial c_i}\Psi_{mk} \\
     \quad - \displaystyle\sum_m\left(
       \frac{\partial\Theta_m}{\partial c_i}\Psi_{km}
         \displaystyle\sum_n\Theta_n\Psi_{nm}
     - \Theta_m\Psi_{km}\displaystyle\sum_n
         \frac{\partial\Theta_n}{\partial c_i}
         \Psi_{nm}\right)/\left(
           \displaystyle\sum_n\Theta_n\Psi_{nm}\right)^2
     \right]
  \end{align*}
\]
</p>
<p> After some rearranging, this becomes:  </p><p class="formulaDsp">
\[
  \begin{align*}
   \Xi_m &amp; \equiv \displaystyle\sum_n\Theta_n\Psi_{nm}, \\
   \frac{\partial \ln{\Gamma_k}}{\partial c_i} &amp; =
     - Q_k \displaystyle\sum_m \left(
     \frac{\Psi_{mk}}{\Xi_k}\frac{\partial\Theta_m}{\partial c_i}
     + \frac{\Psi_{km}}{\Xi_m}
       \frac{\partial\Theta_m}{\partial c_i}
     - \frac{\Theta_m\Psi_{km}}
            {\Xi_m^2}
       \displaystyle\sum_n\frac{\partial\Theta_n}{\partial c_i}\Psi_{nm}
   \right)
  \end{align*}
\]
</p>
<p> The left side of the three bracketed terms in the above equation are independent of species \(i\) and can be calculated outside of the loop over the independent species. The partial derivative of the full residual term with respect to \(c_i\) is:  </p><p class="formulaDsp">
\[
  \begin{align*}
  \frac{\partial \ln{\Gamma_k^{(j)}}}{\partial c_i} &amp; = 0 \\
  \frac{\partial \ln{\gamma_j^R}}{\partial c_i} &amp; =
    \displaystyle\sum_k v_k^{(j)}
       \frac{\partial \ln{\Gamma_k}}{\partial c_i}
  \end{align*}
\]
</p>
<p> The overall equation for the partial derivative of \(\gamma_j\) with respect to species \(i\) is:  </p><p class="formulaDsp">
\[
   \frac{\partial\gamma_j}{\partial c_i} = \gamma_j \left(
     \frac{\partial\ln{\gamma_j^C}}{\partial c_i}
     + \frac{\partial\ln{\gamma_j^R}}{\partial c_i} \right)
\]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data </td></tr>
    <tr><td class="paramname">J</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> to be calculated </td></tr>
    <tr><td class="paramname">time_step</td><td>Current time step [s] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html#l00575">575</a> of file <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html">sub_model_UNIFAC.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a0301d06b09af90fcfe49f9a1ba7c6742_icgraph.png" border="0" usemap="#asub__models_8h_a0301d06b09af90fcfe49f9a1ba7c6742_icgraph" alt=""/></div>
<map name="asub__models_8h_a0301d06b09af90fcfe49f9a1ba7c6742_icgraph" id="asub__models_8h_a0301d06b09af90fcfe49f9a1ba7c6742_icgraph">
<area shape="rect" title="Add contributions to the Jacobian from derivates calculated using the output of this sub model." alt="" coords="480,5,647,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a9575eb8104f46d396268c361164e88fb" title="Calculate the Jacobian constributions from sub model calculations." alt="" coords="253,13,432,39"/>
<area shape="poly" title=" " alt="" coords="464,28,433,28,433,23,464,23"/>
<area shape="rect" href="camp__solver_8c.html#a13451d507558a61a2353adfed58db468" title="Compute the Jacobian." alt="" coords="163,13,205,39"/>
<area shape="poly" title=" " alt="" coords="238,28,205,28,205,23,238,23"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,13,115,39"/>
<area shape="poly" title=" " alt="" coords="147,28,115,28,115,23,147,23"/>
</map>
</div>

</div>
</div>
<a id="a6895ac51f6122ce830f30d8b1f09d052" name="a6895ac51f6122ce830f30d8b1f09d052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6895ac51f6122ce830f30d8b1f09d052">&#9670;&#160;</a></span>sub_model_UNIFAC_get_used_jac_elem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_UNIFAC_get_used_jac_elem </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_jacobian.html">Jacobian</a> *&#160;</td>
          <td class="paramname"><em>jac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the <a class="el" href="struct_jacobian.html">Jacobian</a> elements used for a particular row of the matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">jac</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html#l00082">82</a> of file <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html">sub_model_UNIFAC.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a6895ac51f6122ce830f30d8b1f09d052_cgraph.png" border="0" usemap="#asub__models_8h_a6895ac51f6122ce830f30d8b1f09d052_cgraph" alt=""/></div>
<map name="asub__models_8h_a6895ac51f6122ce830f30d8b1f09d052_cgraph" id="asub__models_8h_a6895ac51f6122ce830f30d8b1f09d052_cgraph">
<area shape="rect" title="Get the Jacobian elements used for a particular row of the matrix." alt="" coords="5,5,172,46"/>
<area shape="rect" href="_jacobian_8c.html#aac51ac6b1cf239a84899308dab229441" title="Adds an element to the sparse matrix." alt="" coords="220,13,392,39"/>
<area shape="poly" title=" " alt="" coords="172,23,204,23,204,28,172,28"/>
<area shape="rect" href="_jacobian_8c.html#ad9cda15d66705739c9d7bdf63c4636a3" title=" " alt="" coords="440,5,618,46"/>
<area shape="poly" title=" " alt="" coords="392,23,424,23,424,28,392,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a6895ac51f6122ce830f30d8b1f09d052_icgraph.png" border="0" usemap="#asub__models_8h_a6895ac51f6122ce830f30d8b1f09d052_icgraph" alt=""/></div>
<map name="asub__models_8h_a6895ac51f6122ce830f30d8b1f09d052_icgraph" id="asub__models_8h_a6895ac51f6122ce830f30d8b1f09d052_icgraph">
<area shape="rect" title="Get the Jacobian elements used for a particular row of the matrix." alt="" coords="714,35,880,75"/>
<area shape="rect" href="sub__model__solver_8c.html#a4b1d9807c5fc6b0f2129eb420fa191ad" title="Get the Jacobian elements used by a particular sub model." alt="" coords="303,5,447,46"/>
<area shape="poly" title=" " alt="" coords="698,51,448,33,448,28,698,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a61bf1cc1ad435b59182e1db138cc1b53" title="Set the map for sub&#45;model interdependence." alt="" coords="500,68,666,93"/>
<area shape="poly" title=" " alt="" coords="698,69,666,73,666,68,698,64"/>
<area shape="rect" href="camp__solver_8c.html#a5b485fa25356197023889f3795888e98" title="Try to improve guesses of y sent to the linear solver." alt="" coords="163,42,250,68"/>
<area shape="poly" title=" " alt="" coords="288,44,251,50,250,45,287,38"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,42,115,68"/>
<area shape="poly" title=" " alt="" coords="147,58,115,58,115,52,147,52"/>
<area shape="rect" href="sub__model__solver_8c.html#a38ebe393b32d9f9ac185b12801c69e17" title="Update the time derivative and Jacobian array ids." alt="" coords="298,70,452,96"/>
<area shape="poly" title=" " alt="" coords="485,84,453,85,453,79,485,79"/>
<area shape="poly" title=" " alt="" coords="282,70,250,65,251,60,283,65"/>
</map>
</div>

</div>
</div>
<a id="ac47310b67585f52b71ff6aac1c603ba5" name="ac47310b67585f52b71ff6aac1c603ba5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac47310b67585f52b71ff6aac1c603ba5">&#9670;&#160;</a></span>sub_model_UNIFAC_print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_UNIFAC_print </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the sub model data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html#l00771">771</a> of file <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html">sub_model_UNIFAC.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_ac47310b67585f52b71ff6aac1c603ba5_icgraph.png" border="0" usemap="#asub__models_8h_ac47310b67585f52b71ff6aac1c603ba5_icgraph" alt=""/></div>
<map name="asub__models_8h_ac47310b67585f52b71ff6aac1c603ba5_icgraph" id="asub__models_8h_ac47310b67585f52b71ff6aac1c603ba5_icgraph">
<area shape="rect" title="Print the sub model data." alt="" coords="202,5,375,31"/>
<area shape="rect" href="sub__model__solver_8c.html#a1e59f0e39671190ef139baa1021d9edf" title="Print the sub model data." alt="" coords="5,5,154,31"/>
<area shape="poly" title=" " alt="" coords="186,21,154,21,154,16,186,16"/>
</map>
</div>

</div>
</div>
<a id="a43f3628a20f1bf545034554576e9c85c" name="a43f3628a20f1bf545034554576e9c85c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f3628a20f1bf545034554576e9c85c">&#9670;&#160;</a></span>sub_model_UNIFAC_update_env_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_UNIFAC_update_env_state </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update sub-model data for new environmental conditions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html#l00129">129</a> of file <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html">sub_model_UNIFAC.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a43f3628a20f1bf545034554576e9c85c_icgraph.png" border="0" usemap="#asub__models_8h_a43f3628a20f1bf545034554576e9c85c_icgraph" alt=""/></div>
<map name="asub__models_8h_a43f3628a20f1bf545034554576e9c85c_icgraph" id="asub__models_8h_a43f3628a20f1bf545034554576e9c85c_icgraph">
<area shape="rect" title="Update sub&#45;model data for new environmental conditions." alt="" coords="341,5,528,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a78345e452d180e21b072ca0bc574042b" title="Update sub model data for a new environmental state." alt="" coords="135,5,293,46"/>
<area shape="poly" title=" " alt="" coords="326,28,293,28,293,23,326,23"/>
<area shape="rect" href="camp__solver_8c.html#afc5ec8680b419e7ab49530d53a76cee4" title="Solve for a given timestep." alt="" coords="5,13,87,39"/>
<area shape="poly" title=" " alt="" coords="119,28,87,28,87,23,119,23"/>
</map>
</div>

</div>
</div>
<a id="a2674d98846a9c4933d56156ec1f0deb5" name="a2674d98846a9c4933d56156ec1f0deb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2674d98846a9c4933d56156ec1f0deb5">&#9670;&#160;</a></span>sub_model_UNIFAC_update_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_UNIFAC_update_ids </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>deriv_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_jacobian.html">Jacobian</a>&#160;</td>
          <td class="paramname"><em>jac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update stored ids for elements used within a row of the <a class="el" href="struct_jacobian.html">Jacobian</a> matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">deriv_ids</td><td>Indices for state array variables on the solver state array </td></tr>
    <tr><td class="paramname">jac</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html#l00106">106</a> of file <a class="el" href="sub__model___u_n_i_f_a_c_8c_source.html">sub_model_UNIFAC.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a2674d98846a9c4933d56156ec1f0deb5_cgraph.png" border="0" usemap="#asub__models_8h_a2674d98846a9c4933d56156ec1f0deb5_cgraph" alt=""/></div>
<map name="asub__models_8h_a2674d98846a9c4933d56156ec1f0deb5_cgraph" id="asub__models_8h_a2674d98846a9c4933d56156ec1f0deb5_cgraph">
<area shape="rect" title="Update stored ids for elements used within a row of the Jacobian matrix." alt="" coords="5,5,217,31"/>
<area shape="rect" href="_jacobian_8c.html#a7b43d5884ec62826389d6d739b7f25eb" title="Get an element id in the Jacobian data arrays." alt="" coords="265,5,429,31"/>
<area shape="poly" title=" " alt="" coords="217,16,249,16,249,21,217,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a2674d98846a9c4933d56156ec1f0deb5_icgraph.png" border="0" usemap="#asub__models_8h_a2674d98846a9c4933d56156ec1f0deb5_icgraph" alt=""/></div>
<map name="asub__models_8h_a2674d98846a9c4933d56156ec1f0deb5_icgraph" id="asub__models_8h_a2674d98846a9c4933d56156ec1f0deb5_icgraph">
<area shape="rect" title="Update stored ids for elements used within a row of the Jacobian matrix." alt="" coords="500,5,712,31"/>
<area shape="rect" href="sub__model__solver_8c.html#a38ebe393b32d9f9ac185b12801c69e17" title="Update the time derivative and Jacobian array ids." alt="" coords="298,5,452,31"/>
<area shape="poly" title=" " alt="" coords="485,21,453,21,453,16,485,16"/>
<area shape="rect" href="camp__solver_8c.html#a5b485fa25356197023889f3795888e98" title="Try to improve guesses of y sent to the linear solver." alt="" coords="163,5,250,31"/>
<area shape="poly" title=" " alt="" coords="282,21,250,21,250,16,282,16"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,5,115,31"/>
<area shape="poly" title=" " alt="" coords="147,21,115,21,115,16,147,16"/>
</map>
</div>

</div>
</div>
<a id="a6639a32646d84e02917b64167f36ea89" name="a6639a32646d84e02917b64167f36ea89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6639a32646d84e02917b64167f36ea89">&#9670;&#160;</a></span>sub_model_ZSR_aerosol_water_calculate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_ZSR_aerosol_water_calculate </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do pre-derivative calculations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data, including the state array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html#l00216">216</a> of file <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html">sub_model_ZSR_aerosol_water.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a6639a32646d84e02917b64167f36ea89_icgraph.png" border="0" usemap="#asub__models_8h_a6639a32646d84e02917b64167f36ea89_icgraph" alt=""/></div>
<map name="asub__models_8h_a6639a32646d84e02917b64167f36ea89_icgraph" id="asub__models_8h_a6639a32646d84e02917b64167f36ea89_icgraph">
<area shape="rect" title="Do pre&#45;derivative calculations." alt="" coords="795,142,961,183"/>
<area shape="rect" href="sub__model__solver_8c.html#a7f9027610b25bafcc5b6c5af1344dd65" title="Perform the sub model calculations for the current model state." alt="" coords="604,150,747,175"/>
<area shape="poly" title=" " alt="" coords="780,165,747,165,747,160,780,160"/>
<area shape="rect" href="camp__solver_8c.html#ac55302bc18db0d68d78f543aad6a16c4" title="Compute the time derivative f(t,y)" alt="" coords="517,150,556,175"/>
<area shape="poly" title=" " alt="" coords="588,165,556,165,556,160,588,160"/>
<area shape="rect" href="camp__solver_8c.html#a13451d507558a61a2353adfed58db468" title="Compute the Jacobian." alt="" coords="182,38,225,63"/>
<area shape="poly" title=" " alt="" coords="649,141,616,111,573,77,523,46,468,22,420,11,382,9,293,22,257,32,226,44,224,39,255,27,291,17,381,3,421,5,470,17,525,41,576,73,620,107,652,137"/>
<area shape="rect" href="camp__solver_8c.html#afc5ec8680b419e7ab49530d53a76cee4" title="Solve for a given timestep." alt="" coords="163,279,244,305"/>
<area shape="poly" title=" " alt="" coords="653,188,620,218,577,253,526,286,470,310,409,322,348,322,291,315,244,306,245,300,291,310,348,317,409,317,469,305,523,281,574,249,617,214,649,184"/>
<area shape="rect" href="camp__solver_8c.html#ad45be595da1a1d6fd40179d9743a9a65" title="Check a Jacobian for accuracy." alt="" coords="339,63,423,89"/>
<area shape="poly" title=" " alt="" coords="512,140,492,121,468,103,422,86,424,81,471,99,495,116,516,136"/>
<area shape="poly" title=" " alt="" coords="525,136,504,90,488,69,468,53,437,39,403,31,369,27,335,28,272,36,226,47,224,42,271,30,334,22,369,22,404,26,439,34,471,48,492,65,509,88,530,133"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,120,115,146"/>
<area shape="poly" title=" " alt="" coords="502,167,469,168,381,170,292,168,198,158,115,145,116,140,199,153,292,162,381,165,469,162,502,161"/>
<area shape="rect" href="camp__solver_8c.html#a51bc2a16028d4c72dd39669c31f6fc17" title="Determine if there is anything to solve." alt="" coords="292,228,469,254"/>
<area shape="poly" title=" " alt="" coords="509,187,471,211,427,230,425,225,468,207,506,183"/>
<area shape="poly" title=" " alt="" coords="528,191,507,232,491,253,471,269,443,283,413,293,352,304,293,305,244,301,245,296,293,299,351,298,412,288,441,278,468,264,487,249,502,230,523,189"/>
<area shape="rect" href="camp__debug_8h.html#a0352ebf153678772ffbeb405834c141d" title="Evaluate the derivative and Jacobian near a given state for a specified species." alt="" coords="318,113,444,153"/>
<area shape="poly" title=" " alt="" coords="502,159,444,148,445,142,503,154"/>
<area shape="poly" title=" " alt="" coords="323,70,224,56,225,51,323,65"/>
<area shape="poly" title=" " alt="" coords="170,72,86,122,83,117,168,68"/>
<area shape="poly" title=" " alt="" coords="319,261,245,283,243,278,318,256"/>
</map>
</div>

</div>
</div>
<a id="aa6bf886e4a9fadb02913dab07e19018b" name="aa6bf886e4a9fadb02913dab07e19018b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6bf886e4a9fadb02913dab07e19018b">&#9670;&#160;</a></span>sub_model_ZSR_aerosol_water_get_jac_contrib()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_ZSR_aerosol_water_get_jac_contrib </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype *&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add contributions to the <a class="el" href="struct_jacobian.html">Jacobian</a> from derivates calculated using the output of this sub model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data </td></tr>
    <tr><td class="paramname">J</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> to be calculated </td></tr>
    <tr><td class="paramname">time_step</td><td>Current time step [s] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html#l00314">314</a> of file <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html">sub_model_ZSR_aerosol_water.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_aa6bf886e4a9fadb02913dab07e19018b_icgraph.png" border="0" usemap="#asub__models_8h_aa6bf886e4a9fadb02913dab07e19018b_icgraph" alt=""/></div>
<map name="asub__models_8h_aa6bf886e4a9fadb02913dab07e19018b_icgraph" id="asub__models_8h_aa6bf886e4a9fadb02913dab07e19018b_icgraph">
<area shape="rect" title="Add contributions to the Jacobian from derivates calculated using the output of this sub model." alt="" coords="480,5,647,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a9575eb8104f46d396268c361164e88fb" title="Calculate the Jacobian constributions from sub model calculations." alt="" coords="253,13,432,39"/>
<area shape="poly" title=" " alt="" coords="464,28,433,28,433,23,464,23"/>
<area shape="rect" href="camp__solver_8c.html#a13451d507558a61a2353adfed58db468" title="Compute the Jacobian." alt="" coords="163,13,205,39"/>
<area shape="poly" title=" " alt="" coords="238,28,205,28,205,23,238,23"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,13,115,39"/>
<area shape="poly" title=" " alt="" coords="147,28,115,28,115,23,147,23"/>
</map>
</div>

</div>
</div>
<a id="a0c47a7f4b91fa19f71a1a69237a6754e" name="a0c47a7f4b91fa19f71a1a69237a6754e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c47a7f4b91fa19f71a1a69237a6754e">&#9670;&#160;</a></span>sub_model_ZSR_aerosol_water_get_used_jac_elem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_ZSR_aerosol_water_get_used_jac_elem </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_jacobian.html">Jacobian</a> *&#160;</td>
          <td class="paramname"><em>jac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag <a class="el" href="struct_jacobian.html">Jacobian</a> elements used by this sub model. </p>
<p>ZSR aerosol water sub models are assumed to be at equilibrium</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">jac</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html#l00081">81</a> of file <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html">sub_model_ZSR_aerosol_water.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a0c47a7f4b91fa19f71a1a69237a6754e_cgraph.png" border="0" usemap="#asub__models_8h_a0c47a7f4b91fa19f71a1a69237a6754e_cgraph" alt=""/></div>
<map name="asub__models_8h_a0c47a7f4b91fa19f71a1a69237a6754e_cgraph" id="asub__models_8h_a0c47a7f4b91fa19f71a1a69237a6754e_cgraph">
<area shape="rect" title="Flag Jacobian elements used by this sub model." alt="" coords="5,5,185,46"/>
<area shape="rect" href="_jacobian_8c.html#aac51ac6b1cf239a84899308dab229441" title="Adds an element to the sparse matrix." alt="" coords="233,13,405,39"/>
<area shape="poly" title=" " alt="" coords="185,23,217,23,217,28,185,28"/>
<area shape="rect" href="_jacobian_8c.html#ad9cda15d66705739c9d7bdf63c4636a3" title=" " alt="" coords="453,5,631,46"/>
<area shape="poly" title=" " alt="" coords="405,23,437,23,437,28,405,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a0c47a7f4b91fa19f71a1a69237a6754e_icgraph.png" border="0" usemap="#asub__models_8h_a0c47a7f4b91fa19f71a1a69237a6754e_icgraph" alt=""/></div>
<map name="asub__models_8h_a0c47a7f4b91fa19f71a1a69237a6754e_icgraph" id="asub__models_8h_a0c47a7f4b91fa19f71a1a69237a6754e_icgraph">
<area shape="rect" title="Flag Jacobian elements used by this sub model." alt="" coords="714,35,893,75"/>
<area shape="rect" href="sub__model__solver_8c.html#a4b1d9807c5fc6b0f2129eb420fa191ad" title="Get the Jacobian elements used by a particular sub model." alt="" coords="303,5,447,46"/>
<area shape="poly" title=" " alt="" coords="698,51,448,33,448,28,698,45"/>
<area shape="rect" href="sub__model__solver_8c.html#a61bf1cc1ad435b59182e1db138cc1b53" title="Set the map for sub&#45;model interdependence." alt="" coords="500,68,666,93"/>
<area shape="poly" title=" " alt="" coords="699,70,666,73,666,68,698,64"/>
<area shape="rect" href="camp__solver_8c.html#a5b485fa25356197023889f3795888e98" title="Try to improve guesses of y sent to the linear solver." alt="" coords="163,42,250,68"/>
<area shape="poly" title=" " alt="" coords="288,44,251,50,250,45,287,38"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,42,115,68"/>
<area shape="poly" title=" " alt="" coords="147,58,115,58,115,52,147,52"/>
<area shape="rect" href="sub__model__solver_8c.html#a38ebe393b32d9f9ac185b12801c69e17" title="Update the time derivative and Jacobian array ids." alt="" coords="298,70,452,96"/>
<area shape="poly" title=" " alt="" coords="485,84,453,85,453,79,485,79"/>
<area shape="poly" title=" " alt="" coords="282,70,250,65,251,60,283,65"/>
</map>
</div>

</div>
</div>
<a id="a74a95ee9cc01c0905493fcb19e00c8b0" name="a74a95ee9cc01c0905493fcb19e00c8b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a95ee9cc01c0905493fcb19e00c8b0">&#9670;&#160;</a></span>sub_model_ZSR_aerosol_water_print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_ZSR_aerosol_water_print </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the ZSR Aerosol Water sub model parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html#l00445">445</a> of file <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html">sub_model_ZSR_aerosol_water.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a74a95ee9cc01c0905493fcb19e00c8b0_icgraph.png" border="0" usemap="#asub__models_8h_a74a95ee9cc01c0905493fcb19e00c8b0_icgraph" alt=""/></div>
<map name="asub__models_8h_a74a95ee9cc01c0905493fcb19e00c8b0_icgraph" id="asub__models_8h_a74a95ee9cc01c0905493fcb19e00c8b0_icgraph">
<area shape="rect" title="Print the ZSR Aerosol Water sub model parameters." alt="" coords="202,5,368,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a1e59f0e39671190ef139baa1021d9edf" title="Print the sub model data." alt="" coords="5,13,154,39"/>
<area shape="poly" title=" " alt="" coords="186,28,154,28,154,23,186,23"/>
</map>
</div>

</div>
</div>
<a id="a915b2885008bfb4bd6c9c37efd6e8d82" name="a915b2885008bfb4bd6c9c37efd6e8d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a915b2885008bfb4bd6c9c37efd6e8d82">&#9670;&#160;</a></span>sub_model_ZSR_aerosol_water_update_env_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_ZSR_aerosol_water_update_env_state </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_env_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_model_data.html">ModelData</a> *&#160;</td>
          <td class="paramname"><em>model_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update sub model data for new environmental conditions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">sub_model_env_data</td><td>Pointer to the sub model environment-dependent data </td></tr>
    <tr><td class="paramname">model_data</td><td>Pointer to the model data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html#l00189">189</a> of file <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html">sub_model_ZSR_aerosol_water.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_a915b2885008bfb4bd6c9c37efd6e8d82_icgraph.png" border="0" usemap="#asub__models_8h_a915b2885008bfb4bd6c9c37efd6e8d82_icgraph" alt=""/></div>
<map name="asub__models_8h_a915b2885008bfb4bd6c9c37efd6e8d82_icgraph" id="asub__models_8h_a915b2885008bfb4bd6c9c37efd6e8d82_icgraph">
<area shape="rect" title="Update sub model data for new environmental conditions." alt="" coords="341,5,511,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a78345e452d180e21b072ca0bc574042b" title="Update sub model data for a new environmental state." alt="" coords="135,5,293,46"/>
<area shape="poly" title=" " alt="" coords="326,28,293,28,293,23,326,23"/>
<area shape="rect" href="camp__solver_8c.html#afc5ec8680b419e7ab49530d53a76cee4" title="Solve for a given timestep." alt="" coords="5,13,87,39"/>
<area shape="poly" title=" " alt="" coords="119,28,87,28,87,23,119,23"/>
</map>
</div>

</div>
</div>
<a id="af42c83e6bae3321e17f4bf21620e36ed" name="af42c83e6bae3321e17f4bf21620e36ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af42c83e6bae3321e17f4bf21620e36ed">&#9670;&#160;</a></span>sub_model_ZSR_aerosol_water_update_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sub_model_ZSR_aerosol_water_update_ids </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sub_model_int_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sub_model_float_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>deriv_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_jacobian.html">Jacobian</a>&#160;</td>
          <td class="paramname"><em>jac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the time derivative and Jacbobian array indices. </p>
<p>ZSR aerosol water sub models are assumed to be at equilibrium</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub_model_int_data</td><td>Pointer to the sub model integer data </td></tr>
    <tr><td class="paramname">sub_model_float_data</td><td>Pointer to the sub model floating-point data </td></tr>
    <tr><td class="paramname">deriv_ids</td><td>Indices for state array variables on the solver state array </td></tr>
    <tr><td class="paramname">jac</td><td><a class="el" href="struct_jacobian.html">Jacobian</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html#l00133">133</a> of file <a class="el" href="sub__model___z_s_r__aerosol__water_8c_source.html">sub_model_ZSR_aerosol_water.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_af42c83e6bae3321e17f4bf21620e36ed_cgraph.png" border="0" usemap="#asub__models_8h_af42c83e6bae3321e17f4bf21620e36ed_cgraph" alt=""/></div>
<map name="asub__models_8h_af42c83e6bae3321e17f4bf21620e36ed_cgraph" id="asub__models_8h_af42c83e6bae3321e17f4bf21620e36ed_cgraph">
<area shape="rect" title="Update the time derivative and Jacbobian array indices." alt="" coords="5,5,172,46"/>
<area shape="rect" href="_jacobian_8c.html#a7b43d5884ec62826389d6d739b7f25eb" title="Get an element id in the Jacobian data arrays." alt="" coords="220,13,384,39"/>
<area shape="poly" title=" " alt="" coords="172,23,204,23,204,28,172,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="sub__models_8h_af42c83e6bae3321e17f4bf21620e36ed_icgraph.png" border="0" usemap="#asub__models_8h_af42c83e6bae3321e17f4bf21620e36ed_icgraph" alt=""/></div>
<map name="asub__models_8h_af42c83e6bae3321e17f4bf21620e36ed_icgraph" id="asub__models_8h_af42c83e6bae3321e17f4bf21620e36ed_icgraph">
<area shape="rect" title="Update the time derivative and Jacbobian array indices." alt="" coords="500,5,667,46"/>
<area shape="rect" href="sub__model__solver_8c.html#a38ebe393b32d9f9ac185b12801c69e17" title="Update the time derivative and Jacobian array ids." alt="" coords="298,13,452,39"/>
<area shape="poly" title=" " alt="" coords="484,28,453,28,453,23,484,23"/>
<area shape="rect" href="camp__solver_8c.html#a5b485fa25356197023889f3795888e98" title="Try to improve guesses of y sent to the linear solver." alt="" coords="163,13,250,39"/>
<area shape="poly" title=" " alt="" coords="282,28,250,28,250,23,282,23"/>
<area shape="rect" href="camp__solver_8c.html#a599ffdef916b139a1690bfd41aa386b6" title="Solver initialization." alt="" coords="5,13,115,39"/>
<area shape="poly" title=" " alt="" coords="147,28,115,28,115,23,147,23"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
CAMP 1.0.0 documentation generated by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.9.8</small></address>
</body>
</html>
