\doxysection{sub\+\_\+model\+\_\+\+PDFi\+TE.\+c}
\hypertarget{sub__model___p_d_fi_t_e_8c_source}{}\label{sub__model___p_d_fi_t_e_8c_source}\index{sub\_model\_PDFiTE.c@{sub\_model\_PDFiTE.c}}
\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00001}00001\ \textcolor{comment}{/*\ Copyright\ (C)\ 2021\ Barcelona\ Supercomputing\ Center\ and\ University\ of}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00002}00002\ \textcolor{comment}{\ *\ Illinois\ at\ Urbana-\/Champaign}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00003}00003\ \textcolor{comment}{\ *\ SPDX-\/License-\/Identifier:\ MIT}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00004}00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00005}00005\ \textcolor{comment}{\ *\ PDFiTE\ Activity\ sub\ model\ solver\ functions}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00006}00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00007}00007\ \textcolor{comment}{\ */}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00008}00008\ \textcolor{comment}{/**\ \(\backslash\)file}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00009}00009\ \textcolor{comment}{\ *\ \(\backslash\)brief\ PDFiTE\ Activity\ sub\ model\ solver\ functions}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00010}00010\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <math.h>}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00012}00012\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00013}00013\ \textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00014}00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_jacobian_8h}{../Jacobian.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00015}00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sub__models_8h}{../sub\_models.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00017}00017\ \textcolor{comment}{//\ TODO\ Lookup\ environmental\ indices\ during\ initialization}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00018}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aa90d2b6c48aceb4d7ac3d93d5249bb60}{00018}}\ \textcolor{preprocessor}{\#define\ TEMPERATURE\_K\_\ env\_data[0]}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00019}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a32cc078fd8ca9ad0684c48ae0aad7135}{00019}}\ \textcolor{preprocessor}{\#define\ PRESSURE\_PA\_\ env\_data[1]}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00021}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{00021}}\ \textcolor{preprocessor}{\#define\ NUM\_PHASE\_\ (int\_data[0])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00022}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a75ac531220686f1130f21aca98adf72f}{00022}}\ \textcolor{preprocessor}{\#define\ GAS\_WATER\_ID\_\ (int\_data[1]\ -\/\ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00023}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{00023}}\ \textcolor{preprocessor}{\#define\ NUM\_ION\_PAIRS\_\ (int\_data[2])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00024}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aa0dffbf9b27f4705b9462d86376d1506}{00024}}\ \textcolor{preprocessor}{\#define\ INT\_DATA\_SIZE\_\ (int\_data[3])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00025}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4c9e4c5f3ca6b19f4eb79ae59cc281eb}{00025}}\ \textcolor{preprocessor}{\#define\ FLOAT\_DATA\_SIZE\_\ (int\_data[4])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00026}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a895b6a254902b0817da027532796db35}{00026}}\ \textcolor{preprocessor}{\#define\ PPM\_TO\_RH\_\ (sub\_model\_env\_data[0])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00027}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a13ba1b28e3d8a5e60eec52ce6bbabe4f}{00027}}\ \textcolor{preprocessor}{\#define\ NUM\_INT\_PROP\_\ 5}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00028}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aa9808eb54fa06bcf890dd1aa1fc6ca5b}{00028}}\ \textcolor{preprocessor}{\#define\ NUM\_REAL\_PROP\_\ 0}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00029}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1f68a3544ae39a7815cbb5c09dfdeff0}{00029}}\ \textcolor{preprocessor}{\#define\ NUM\_ENV\_PARAM\_\ 1}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00030}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{00030}}\ \textcolor{preprocessor}{\#define\ PHASE\_ID\_(x)\ (int\_data[NUM\_INT\_PROP\_\ +\ x]\ -\/\ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00031}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a75013494646b87ae6218ce67f18b4eb1}{00031}}\ \textcolor{preprocessor}{\#define\ PAIR\_INT\_PARAM\_LOC\_(x)\ (int\_data[NUM\_INT\_PROP\_\ +\ NUM\_PHASE\_\ +\ x]\ -\/\ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00032}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a2c3304509ffdd8f8e2bd59c37a76af69}{00032}}\ \textcolor{preprocessor}{\#define\ PAIR\_FLOAT\_PARAM\_LOC\_(x)\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00033}00033\ \textcolor{preprocessor}{\ \ (int\_data[NUM\_INT\_PROP\_\ +\ NUM\_PHASE\_\ +\ NUM\_ION\_PAIRS\_\ +\ x]\ -\/\ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00034}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{00034}}\ \textcolor{preprocessor}{\#define\ ION\_PAIR\_ACT\_ID\_(x)\ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00035}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aca730dbac706a2b1066bb0e1a561cf70}{00035}}\ \textcolor{preprocessor}{\#define\ NUM\_CATION\_(x)\ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 1])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00036}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a3e0d89d3515492d7377285a57644d72e}{00036}}\ \textcolor{preprocessor}{\#define\ NUM\_ANION\_(x)\ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 2])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00037}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ac16e157f1f96e0ef91e6f08036b12c7a}{00037}}\ \textcolor{preprocessor}{\#define\ CATION\_ID\_(x)\ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 3])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00038}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a908d4e051ac9bb3450f9201194f086bf}{00038}}\ \textcolor{preprocessor}{\#define\ ANION\_ID\_(x)\ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 4])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00039}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af4d34c316b8f0219e9d8c106176efe52}{00039}}\ \textcolor{preprocessor}{\#define\ NUM\_INTER\_(x)\ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 5])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00040}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af1e6ab11ed64bb87c61797efead6017a}{00040}}\ \textcolor{preprocessor}{\#define\ JAC\_WATER\_ID\_(p,\ x)\ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 6\ +\ p])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00041}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_afe801e26fe0d88c30f8a592ff0c24cfd}{00041}}\ \textcolor{preprocessor}{\#define\ JAC\_CATION\_ID\_(p,\ x,\ y)\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00042}00042\ \textcolor{preprocessor}{\ \ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 6\ +\ NUM\_PHASE\_\ +\ p\ *\ NUM\_ION\_PAIRS\_\ +\ y])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00043}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_adfad50e5953c49bc824f6b610f673dcd}{00043}}\ \textcolor{preprocessor}{\#define\ JAC\_ANION\_ID\_(p,\ x,\ y)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00044}00044\ \textcolor{preprocessor}{\ \ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 6\ +\ (1\ +\ NUM\_ION\_PAIRS\_)\ *\ NUM\_PHASE\_\ +\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00045}00045\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ p\ *\ NUM\_ION\_PAIRS\_\ +\ y])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00046}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_abfeb83833b166b21cd1e7037af63059b}{00046}}\ \textcolor{preprocessor}{\#define\ NUM\_B\_(x,\ y)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00047}00047\ \textcolor{preprocessor}{\ \ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 6\ +\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00048}00048\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ (1\ +\ 2\ *\ NUM\_ION\_PAIRS\_)\ *\ NUM\_PHASE\_\ +\ y])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00049}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a02a474af8927829d7fd9151748b5ac6d}{00049}}\ \textcolor{preprocessor}{\#define\ INTER\_SPEC\_ID\_(x,\ y)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00050}00050\ \textcolor{preprocessor}{\ \ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 6\ +\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00051}00051\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ (1\ +\ 2\ *\ NUM\_ION\_PAIRS\_)\ *\ NUM\_PHASE\_\ +\ NUM\_INTER\_(x)\ +\ y]\ -\/\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00052}00052\ \textcolor{preprocessor}{\ \ \ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00053}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4b9df621f386bc252902863d5b4f1d61}{00053}}\ \textcolor{preprocessor}{\#define\ INTER\_SPEC\_LOC\_(x,\ y)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00054}00054\ \textcolor{preprocessor}{\ \ (int\_data[PAIR\_INT\_PARAM\_LOC\_(x)\ +\ 6\ +\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00055}00055\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ (1\ +\ 2\ *\ NUM\_ION\_PAIRS\_)\ *\ NUM\_PHASE\_\ +\ 2\ *\ (NUM\_INTER\_(x))\ +\ y]\ -\/\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00056}00056\ \textcolor{preprocessor}{\ \ \ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00057}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af30992074351d1fc62267e7a0d234b79}{00057}}\ \textcolor{preprocessor}{\#define\ CATION\_MW\_(x)\ (float\_data[PAIR\_FLOAT\_PARAM\_LOC\_(x)])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00058}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ab651fcbff092007a94f147602f065e01}{00058}}\ \textcolor{preprocessor}{\#define\ ANION\_MW\_(x)\ (float\_data[PAIR\_FLOAT\_PARAM\_LOC\_(x)\ +\ 1])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00059}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{00059}}\ \textcolor{preprocessor}{\#define\ CATION\_N\_(x)\ (float\_data[PAIR\_FLOAT\_PARAM\_LOC\_(x)\ +\ 2])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00060}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{00060}}\ \textcolor{preprocessor}{\#define\ ANION\_N\_(x)\ (float\_data[PAIR\_FLOAT\_PARAM\_LOC\_(x)\ +\ 3])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00061}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1756e6d53076042962889be52e07d522}{00061}}\ \textcolor{preprocessor}{\#define\ MIN\_RH\_(x,\ y)\ (float\_data[INTER\_SPEC\_LOC\_(x,\ y)])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00062}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a998afd242a326331e35792946f9b8e72}{00062}}\ \textcolor{preprocessor}{\#define\ MAX\_RH\_(x,\ y)\ (float\_data[INTER\_SPEC\_LOC\_(x,\ y)\ +\ 1])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00063}\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a808e07e512299609f2225ad16af879cb}{00063}}\ \textcolor{preprocessor}{\#define\ B\_Z\_(x,\ y,\ z)\ (float\_data[INTER\_SPEC\_LOC\_(x,\ y)\ +\ 2\ +\ z])}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00064}00064\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00065}00065\ \textcolor{comment}{/**\ \(\backslash\)brief\ Flag\ Jacobian\ elements\ used\ by\ this\ sub\ model}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00066}00066\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00067}00067\ \textcolor{comment}{\ *\ activity\ sub\ models\ are\ assumed\ to\ be\ at\ equilibrium}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00068}00068\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00069}00069\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_int\_data\ Pointer\ to\ the\ sub\ model\ integer\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00070}00070\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_float\_data\ Pointer\ to\ the\ sub\ model\ floating-\/point\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00071}00071\ \textcolor{comment}{\ *\ \(\backslash\)param\ jac\ Jacobian}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00072}00072\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00073}\mbox{\hyperlink{sub__models_8h_a1c3598c177755e3ca9d3bde1ace7c0e0}{00073}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1c3598c177755e3ca9d3bde1ace7c0e0}{sub\_model\_PDFiTE\_get\_used\_jac\_elem}}(\textcolor{keywordtype}{int}\ *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_float\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_jacobian}{Jacobian}}\ *jac)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00076}00076\ \ \ \textcolor{keywordtype}{int}\ *int\_data\ =\ sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00077}00077\ \ \ \textcolor{keywordtype}{double}\ *float\_data\ =\ sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00079}00079\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ ++i\_phase)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_ion\_pair\ =\ 0;\ i\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ ++i\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00081}00081\ \ \ \ \ \ \ \mbox{\hyperlink{_jacobian_8c_aac51ac6b1cf239a84899308dab229441}{jacobian\_register\_element}}(}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ jac,\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{ION\_PAIR\_ACT\_ID\_}}(i\_ion\_pair),}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a75ac531220686f1130f21aca98adf72f}{GAS\_WATER\_ID\_}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00084}00084\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\_ion\_pair\ =\ 0;\ j\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ ++j\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00085}00085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_jacobian_8c_aac51ac6b1cf239a84899308dab229441}{jacobian\_register\_element}}(}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ jac,\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{ION\_PAIR\_ACT\_ID\_}}(i\_ion\_pair),}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ac16e157f1f96e0ef91e6f08036b12c7a}{CATION\_ID\_}}(j\_ion\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00088}00088\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_jacobian_8c_aac51ac6b1cf239a84899308dab229441}{jacobian\_register\_element}}(}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ jac,\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{ION\_PAIR\_ACT\_ID\_}}(i\_ion\_pair),}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a908d4e051ac9bb3450f9201194f086bf}{ANION\_ID\_}}(j\_ion\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00091}00091\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00092}00092\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00093}00093\ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00094}00094\ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00095}00095\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00096}00096\ \textcolor{comment}{/**\ \(\backslash\)brief\ Update\ the\ time\ derivative\ and\ Jacbobian\ array\ indices}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00097}00097\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00098}00098\ \textcolor{comment}{\ *\ activity\ sub\ models\ are\ assumed\ to\ be\ at\ equilibrium}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00099}00099\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00100}00100\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_int\_data\ Pointer\ to\ the\ sub\ model\ integer\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00101}00101\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_float\_data\ Pointer\ to\ the\ sub\ model\ floating-\/point\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00102}00102\ \textcolor{comment}{\ *\ \(\backslash\)param\ deriv\_ids\ Indices\ for\ state\ array\ variables\ on\ the\ solver\ state\ array}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00103}00103\ \textcolor{comment}{\ *\ \(\backslash\)param\ jac\ Jacobian}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00104}00104\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00105}\mbox{\hyperlink{sub__models_8h_ad0578f51652ce992842c2e65c8d84e55}{00105}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ad0578f51652ce992842c2e65c8d84e55}{sub\_model\_PDFiTE\_update\_ids}}(\textcolor{keywordtype}{int}\ *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_float\_data,\ \textcolor{keywordtype}{int}\ *deriv\_ids,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_jacobian}{Jacobian}}\ jac)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00108}00108\ \ \ \textcolor{keywordtype}{int}\ *int\_data\ =\ sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00109}00109\ \ \ \textcolor{keywordtype}{double}\ *float\_data\ =\ sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00111}00111\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ ++i\_phase)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00112}00112\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_ion\_pair\ =\ 0;\ i\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ ++i\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00113}00113\ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af1e6ab11ed64bb87c61797efead6017a}{JAC\_WATER\_ID\_}}(i\_phase,\ i\_ion\_pair)\ =\ \mbox{\hyperlink{_jacobian_8c_a7b43d5884ec62826389d6d739b7f25eb}{jacobian\_get\_element\_id}}(}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ jac,\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{ION\_PAIR\_ACT\_ID\_}}(i\_ion\_pair),}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a75ac531220686f1130f21aca98adf72f}{GAS\_WATER\_ID\_}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00116}00116\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\_ion\_pair\ =\ 0;\ j\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ ++j\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00117}00117\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_afe801e26fe0d88c30f8a592ff0c24cfd}{JAC\_CATION\_ID\_}}(i\_phase,\ i\_ion\_pair,\ j\_ion\_pair)\ =}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_jacobian_8c_a7b43d5884ec62826389d6d739b7f25eb}{jacobian\_get\_element\_id}}(}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jac,\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{ION\_PAIR\_ACT\_ID\_}}(i\_ion\_pair),}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ac16e157f1f96e0ef91e6f08036b12c7a}{CATION\_ID\_}}(j\_ion\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00121}00121\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_adfad50e5953c49bc824f6b610f673dcd}{JAC\_ANION\_ID\_}}(i\_phase,\ i\_ion\_pair,\ j\_ion\_pair)\ =}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_jacobian_8c_a7b43d5884ec62826389d6d739b7f25eb}{jacobian\_get\_element\_id}}(}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jac,\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{ION\_PAIR\_ACT\_ID\_}}(i\_ion\_pair),}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a908d4e051ac9bb3450f9201194f086bf}{ANION\_ID\_}}(j\_ion\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00125}00125\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00126}00126\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00127}00127\ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00128}00128\ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00129}00129\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00130}00130\ \textcolor{comment}{/**\ \(\backslash\)brief\ Update\ sub\ model\ data\ for\ new\ environmental\ conditions}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00131}00131\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00132}00132\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_int\_data\ Pointer\ to\ the\ sub\ model\ integer\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00133}00133\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_float\_data\ Pointer\ to\ the\ sub\ model\ floating-\/point\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00134}00134\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_env\_data\ Pointer\ to\ the\ sub\ model\ environment-\/dependent\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00135}00135\ \textcolor{comment}{\ *\ \(\backslash\)param\ model\_data\ Pointer\ to\ the\ model\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00136}00136\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00137}\mbox{\hyperlink{sub__models_8h_ae2d20ec59ac4397714d038f51324809d}{00137}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ae2d20ec59ac4397714d038f51324809d}{sub\_model\_PDFiTE\_update\_env\_state}}(\textcolor{keywordtype}{int}\ *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_float\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_env\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_model_data}{ModelData}}\ *model\_data)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00141}00141\ \ \ \textcolor{keywordtype}{int}\ *int\_data\ =\ sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00142}00142\ \ \ \textcolor{keywordtype}{double}\ *float\_data\ =\ sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00143}00143\ \ \ \textcolor{keywordtype}{double}\ *env\_data\ =\ model\_data-\/>\mbox{\hyperlink{struct_model_data_a847bd594a8e88da48104655fdc8524d7}{grid\_cell\_env}};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00145}00145\ \ \ \textcolor{comment}{//\ Calculate\ PPM\_TO\_RH\_}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00146}00146\ \ \ \textcolor{comment}{//\ From\ MOSAIC\ code\ -\/\ reference\ to\ Seinfeld\ \&\ Pandis\ page\ 181}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00147}00147\ \ \ \textcolor{comment}{//\ TODO\ Figure\ out\ how\ to\ have\ consistent\ RH<-\/>ppm\ conversions}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00148}00148\ \ \ \textcolor{keywordtype}{double}\ t\_steam\ =\ 373.15;\ \ \textcolor{comment}{//\ steam\ temperature\ (K)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00149}00149\ \ \ \textcolor{keywordtype}{double}\ a\ =\ 1.0\ -\/\ t\_steam\ /\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aa90d2b6c48aceb4d7ac3d93d5249bb60}{TEMPERATURE\_K\_}};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00151}00151\ \ \ a\ =\ (((-\/0.1299\ *\ a\ -\/\ 0.6445)\ *\ a\ -\/\ 1.976)\ *\ a\ +\ 13.3185)\ *\ a;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00152}00152\ \ \ \textcolor{keywordtype}{double}\ water\_vp\ =\ 101325.0\ *\ exp(a);\ \ \textcolor{comment}{//\ (Pa)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00153}00153\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00154}00154\ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a895b6a254902b0817da027532796db35}{PPM\_TO\_RH\_}}\ =\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a32cc078fd8ca9ad0684c48ae0aad7135}{PRESSURE\_PA\_}}\ /\ water\_vp\ /\ 1.0e6;\ \ \textcolor{comment}{//\ (1/ppm)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00156}00156\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00157}00157\ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00158}00158\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00159}00159\ \textcolor{comment}{/**\ \(\backslash\)brief\ Perform\ the\ sub-\/model\ calculations\ for\ the\ current\ model\ state}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00160}00160\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00161}00161\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_int\_data\ Pointer\ to\ the\ sub\ model\ integer\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00162}00162\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_float\_data\ Pointer\ to\ the\ sub\ model\ floating-\/point\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00163}00163\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_env\_data\ Pointer\ to\ the\ sub\ model\ environment-\/dependent\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00164}00164\ \textcolor{comment}{\ *\ \(\backslash\)param\ model\_data\ Pointer\ to\ the\ model\ data\ including\ the\ current\ state\ and}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00165}00165\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ environmental\ conditions}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00166}00166\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00167}\mbox{\hyperlink{sub__models_8h_a2f46f791a4a74c77e283b5afb91911aa}{00167}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a2f46f791a4a74c77e283b5afb91911aa}{sub\_model\_PDFiTE\_calculate}}(\textcolor{keywordtype}{int}\ *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_float\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_env\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_model_data}{ModelData}}\ *model\_data)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00171}00171\ \ \ \textcolor{keywordtype}{double}\ *state\ =\ model\_data-\/>\mbox{\hyperlink{struct_model_data_a97655058cfc0116225582920128111ef}{grid\_cell\_state}};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00172}00172\ \ \ \textcolor{keywordtype}{int}\ *int\_data\ =\ sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00173}00173\ \ \ \textcolor{keywordtype}{double}\ *float\_data\ =\ sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00175}00175\ \ \ \textcolor{comment}{//\ Calculate\ the\ water\ activity-\/-\/-\/i.e.,\ relative\ humidity\ (0-\/1)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00176}00176\ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ a\_w\ =\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a895b6a254902b0817da027532796db35}{PPM\_TO\_RH\_}}\ *\ state[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a75ac531220686f1130f21aca98adf72f}{GAS\_WATER\_ID\_}}];}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00178}00178\ \ \ \textcolor{comment}{//\ Keep\ a\_w\ within\ 0-\/1}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00179}00179\ \ \ \textcolor{comment}{//\ TODO\ Filter\ =(\ try\ to\ remove}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00180}00180\ \ \ \textcolor{keywordflow}{if}\ (a\_w\ <\ 0.0)\ a\_w\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00181}00181\ \ \ \textcolor{keywordflow}{if}\ (a\_w\ >\ 1.0)\ a\_w\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00183}00183\ \ \ \textcolor{comment}{//\ Calculate\ ion\_pair\ activity\ coefficients\ in\ each\ phase}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00184}00184\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ i\_phase++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00185}00185\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ number\ of\ moles\ of\ each\ ion}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00186}00186\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_ion\_pair\ =\ 0;\ i\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ i\_ion\_pair++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00187}00187\ \ \ \ \ \ \ \textcolor{comment}{//\ N\ (mol\_i/m3)\ =\ c\_i\ (ug/m3)\ /\ 10\string^6\ (ug/g)\ /\ MW\_i\ (ug/umol)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00188}00188\ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(i\_ion\_pair)\ =}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ state[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ac16e157f1f96e0ef91e6f08036b12c7a}{CATION\_ID\_}}(i\_ion\_pair)]\ /}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af30992074351d1fc62267e7a0d234b79}{CATION\_MW\_}}(i\_ion\_pair)\ /\ 1000000.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00191}00191\ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(i\_ion\_pair)\ =\ state[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a908d4e051ac9bb3450f9201194f086bf}{ANION\_ID\_}}(i\_ion\_pair)]\ /}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ab651fcbff092007a94f147602f065e01}{ANION\_MW\_}}(i\_ion\_pair)\ /\ 1000000.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00193}00193\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00194}00194\ \ \ \ \ \}\ \ \textcolor{comment}{//\ Loop\ on\ primary\ ion\_pair}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00196}00196\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ activity\ coefficient}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00197}00197\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_ion\_pair\ =\ 0;\ i\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ i\_ion\_pair++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00198}00198\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ there\ are\ no\ interactions,\ the\ remaining\ ion\ pairs\ will\ not}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00199}00199\ \ \ \ \ \ \ \textcolor{comment}{//\ have\ activity\ calculations\ (they\ only\ participate\ in\ interactions)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00200}00200\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af4d34c316b8f0219e9d8c106176efe52}{NUM\_INTER\_}}(i\_ion\_pair)\ ==\ 0)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00202}00202\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ omega\ for\ this\ ion\_pair}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00203}00203\ \ \ \ \ \ \ \textcolor{comment}{//\ (eq.\ 15\ in\ \(\backslash\)cite\{Topping2009\})\ as\ the\ sum\ of}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00204}00204\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ v\_e\string^C\ =\ 2\ *\ (\ v\_cation\ +\ v\_anion)\ *\ N\_cation\ *\ N\_anion}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00205}00205\ \ \ \ \ \ \ \textcolor{comment}{//\ across\ all\ other\ ion\ pairs\ (not\ i\_ion\_pair)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00206}00206\ \ \ \ \ \ \ \textcolor{comment}{//\ where\ v\_x\ is\ the\ stoichiometric\ coefficient\ for\ species\ x\ in}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00207}00207\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ other\ ion\_pair\ and\ N\_x\ is\ its\ concentration.}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00208}00208\ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ omega\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00209}00209\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\_ion\_pair\ =\ 0;\ j\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ ++j\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00210}00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\_ion\_pair\ ==\ j\_ion\_pair)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00211}00211\ \ \ \ \ \ \ \ \ omega\ +=\ (\textcolor{keywordtype}{long}\ double)2.0\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aca730dbac706a2b1066bb0e1a561cf70}{NUM\_CATION\_}}(j\_ion\_pair)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a3e0d89d3515492d7377285a57644d72e}{NUM\_ANION\_}}(j\_ion\_pair))\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(j\_ion\_pair)\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(j\_ion\_pair);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00214}00214\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00215}00215\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00216}00216\ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ ln(gamma)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00217}00217\ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ ln\_gamma\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00219}00219\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ contributions\ from\ each\ interacting\ ion\_pair}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00220}00220\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_inter\ =\ 0;\ i\_inter\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af4d34c316b8f0219e9d8c106176efe52}{NUM\_INTER\_}}(i\_ion\_pair);\ i\_inter++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00221}00221\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ include\ interactions\ in\ the\ correct\ RH\ range}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00222}00222\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ where\ the\ range\ is\ in\ (minRH,\ maxRH]\ except\ when\ a\_w\ =\ 0.0}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00223}00223\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ where\ the\ range\ is\ in\ [0.0,\ maxRH]}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00224}00224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((a\_w\ <=\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1756e6d53076042962889be52e07d522}{MIN\_RH\_}}(i\_ion\_pair,\ i\_inter)\ ||}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00225}00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_w\ >\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a998afd242a326331e35792946f9b8e72}{MAX\_RH\_}}(i\_ion\_pair,\ i\_inter))\ \&\&}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ !(a\_w\ <=\ 0.0\ \&\&\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1756e6d53076042962889be52e07d522}{MIN\_RH\_}}(i\_ion\_pair,\ i\_inter)\ <=\ 0.0))}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00228}00228\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00229}00229\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ ion\_pair\ id\ of\ the\ interacting\ species}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00230}00230\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\_ion\_pair\ =\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a02a474af8927829d7fd9151748b5ac6d}{INTER\_SPEC\_ID\_}}(i\_ion\_pair,\ i\_inter);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00232}00232\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ ln\_gamma\_inter}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00233}00233\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ ln\_gamma\_inter\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00234}00234\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_B\ =\ 0;\ i\_B\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_abfeb83833b166b21cd1e7037af63059b}{NUM\_B\_}}(i\_ion\_pair,\ i\_inter);\ i\_B++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ ln\_gamma\_inter\ +=\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a808e07e512299609f2225ad16af879cb}{B\_Z\_}}(i\_ion\_pair,\ i\_inter,\ i\_B)\ *\ pow(a\_w,\ i\_B);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00236}00236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00237}00237\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00238}00238\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ this\ is\ the\ "{}self"{}\ interaction,\ ln\_gamma\_inter\ is\ ln(gamma\_0A)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00239}00239\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (eq.\ 15\ in\ \(\backslash\)cite\{Topping2009\})}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00240}00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\_ion\_pair\ ==\ j\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ contribution\ to\ ln(gamma\_A)\ from\ ln(gamma\_0A)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ ln\_gamma\ +=\ ln\_gamma\_inter;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00243}00243\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00244}00244\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ...\ otherwise\ it\ is\ d(ln(gamma\_A))/g(N\_B,M\ N\_B,x)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00245}00245\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (eq.\ 15\ in\ \(\backslash\)cite\{Topping2009\})}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00246}00246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ contribution\ to\ ln(gamma\_A)\ from\ interacting\ ion\_pair.}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00248}00248\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ When\ omega\ ==\ 0,\ N\_cation\ or\ N\_anion\ must\ be\ 0,\ so}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00249}00249\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skip\ to\ avoid\ divide\ by\ zero\ errors}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00250}00250\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (omega\ >\ 0.0)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00251}00251\ \ \ \ \ \ \ \ \ \ \ \ \ ln\_gamma\ +=\ ln\_gamma\_inter\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(j\_ion\_pair)\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00252}00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(j\_ion\_pair)\ /\ omega;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00253}00253\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00254}00254\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00255}00255\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00256}00256\ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ Loop\ on\ interacting\ ion\_pairs}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00257}00257\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00258}00258\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ ion\_pair\ activity}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00259}00259\ \ \ \ \ \ \ state[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{ION\_PAIR\_ACT\_ID\_}}(i\_ion\_pair)]\ =\ exp(ln\_gamma);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00260}00260\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00261}00261\ \ \ \ \ \}\ \ \textcolor{comment}{//\ Loop\ on\ primary\ ion\_pairs}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00262}00262\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00263}00263\ \ \ \}\ \ \textcolor{comment}{//\ Loop\ on\ aerosol\ phases}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00264}00264\ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00265}00265\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00266}00266\ \textcolor{comment}{/**\ \(\backslash\)brief\ Add\ contributions\ to\ the\ Jacobian\ from\ derivates\ calculated\ using\ the}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00267}00267\ \textcolor{comment}{\ *\ output\ of\ this\ sub\ model}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00268}00268\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00269}00269\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_int\_data\ Pointer\ to\ the\ sub\ model\ integer\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00270}00270\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_float\_data\ Pointer\ to\ the\ sub\ model\ floating-\/point\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00271}00271\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_env\_data\ Pointer\ to\ the\ sub\ model\ environment-\/dependent\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00272}00272\ \textcolor{comment}{\ *\ \(\backslash\)param\ model\_data\ Pointer\ to\ the\ model\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00273}00273\ \textcolor{comment}{\ *\ \(\backslash\)param\ J\ Jacobian\ to\ be\ calculated}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00274}00274\ \textcolor{comment}{\ *\ \(\backslash\)param\ time\_step\ Current\ time\ step\ in\ [s]}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00275}00275\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00276}00276\ \textcolor{preprocessor}{\#ifdef\ CAMP\_USE\_SUNDIALS}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00277}\mbox{\hyperlink{sub__models_8h_a50d2ccc5a5c4b40019447f6b7dd5feab}{00277}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a50d2ccc5a5c4b40019447f6b7dd5feab}{sub\_model\_PDFiTE\_get\_jac\_contrib}}(\textcolor{keywordtype}{int}\ *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_float\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_env\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_model_data}{ModelData}}\ *model\_data,\ realtype\ *J,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ time\_step)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00282}00282\ \ \ \textcolor{keywordtype}{int}\ *int\_data\ =\ sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00283}00283\ \ \ \textcolor{keywordtype}{double}\ *float\_data\ =\ sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00284}00284\ \ \ \textcolor{keywordtype}{double}\ *state\ =\ model\_data-\/>\mbox{\hyperlink{struct_model_data_a97655058cfc0116225582920128111ef}{grid\_cell\_state}};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00285}00285\ \ \ \textcolor{keywordtype}{double}\ *env\_data\ =\ model\_data-\/>\mbox{\hyperlink{struct_model_data_a847bd594a8e88da48104655fdc8524d7}{grid\_cell\_env}};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00287}00287\ \ \ \textcolor{comment}{//\ Calculate\ the\ water\ activity-\/-\/-\/i.e.,\ relative\ humidity\ (0-\/1)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00288}00288\ \ \ \textcolor{keywordtype}{double}\ a\_w\ =\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a895b6a254902b0817da027532796db35}{PPM\_TO\_RH\_}}\ *\ state[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a75ac531220686f1130f21aca98adf72f}{GAS\_WATER\_ID\_}}];}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00289}00289\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00290}00290\ \ \ \textcolor{comment}{//\ Keep\ a\_w\ within\ 0-\/1}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00291}00291\ \ \ \textcolor{comment}{//\ TODO\ Filter\ =(\ try\ to\ remove}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00292}00292\ \ \ \textcolor{keywordflow}{if}\ (a\_w\ <\ 0.0)\ a\_w\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00293}00293\ \ \ \textcolor{keywordflow}{if}\ (a\_w\ >\ 1.0)\ a\_w\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00294}00294\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00295}00295\ \ \ \textcolor{comment}{//\ Calculate\ ion\_pair\ activity\ coefficients\ in\ each\ phase}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00296}00296\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ i\_phase++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00297}00297\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ number\ of\ moles\ of\ each\ ion}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00298}00298\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_ion\_pair\ =\ 0;\ i\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ i\_ion\_pair++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00299}00299\ \ \ \ \ \ \ \textcolor{comment}{//\ N\ (mol\_i/m3)\ =\ c\_i\ (ug/m3)\ /\ 10\string^6\ (ug/g)\ /\ MW\_i\ (ug/umol)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00300}00300\ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(i\_ion\_pair)\ =}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00301}00301\ \ \ \ \ \ \ \ \ \ \ state[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ac16e157f1f96e0ef91e6f08036b12c7a}{CATION\_ID\_}}(i\_ion\_pair)]\ /}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00302}00302\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af30992074351d1fc62267e7a0d234b79}{CATION\_MW\_}}(i\_ion\_pair)\ /\ 1000000.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00303}00303\ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(i\_ion\_pair)\ =\ state[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a908d4e051ac9bb3450f9201194f086bf}{ANION\_ID\_}}(i\_ion\_pair)]\ /}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ab651fcbff092007a94f147602f065e01}{ANION\_MW\_}}(i\_ion\_pair)\ /\ 1000000.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00305}00305\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00306}00306\ \ \ \ \ \}\ \ \textcolor{comment}{//\ Loop\ on\ primary\ ion\_pair}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00307}00307\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00308}00308\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ activity\ coefficient}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00309}00309\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_ion\_pair\ =\ 0;\ i\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ i\_ion\_pair++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00310}00310\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ there\ are\ no\ interactions,\ the\ remaining\ ion\ pairs\ will\ not}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00311}00311\ \ \ \ \ \ \ \textcolor{comment}{//\ have\ activity\ calculations\ (they\ only\ participate\ in\ interactions)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00312}00312\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af4d34c316b8f0219e9d8c106176efe52}{NUM\_INTER\_}}(i\_ion\_pair)\ ==\ 0)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00314}00314\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ omega\ for\ this\ ion\_pair}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00315}00315\ \ \ \ \ \ \ \textcolor{comment}{//\ (eq.\ 15\ in\ \(\backslash\)cite\{Topping2009\})\ as\ the\ sum\ of}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00316}00316\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ v\_e\string^C\ =\ 2\ *\ (\ v\_cation\ +\ v\_anion)\ *\ N\_cation\ *\ N\_anion}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00317}00317\ \ \ \ \ \ \ \textcolor{comment}{//\ across\ all\ other\ ion\ pairs\ (not\ i\_ion\_pair)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00318}00318\ \ \ \ \ \ \ \textcolor{comment}{//\ where\ v\_x\ is\ the\ stoichiometric\ coefficient\ for\ species\ x\ in}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00319}00319\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ other\ ion\_pair\ and\ N\_x\ is\ its\ concentration.}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00320}00320\ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ omega\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00321}00321\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\_ion\_pair\ =\ 0;\ j\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ ++j\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00322}00322\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\_ion\_pair\ ==\ j\_ion\_pair)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00323}00323\ \ \ \ \ \ \ \ \ omega\ +=\ (\textcolor{keywordtype}{long}\ double)2.0\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aca730dbac706a2b1066bb0e1a561cf70}{NUM\_CATION\_}}(j\_ion\_pair)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a3e0d89d3515492d7377285a57644d72e}{NUM\_ANION\_}}(j\_ion\_pair))\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00325}00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(j\_ion\_pair)\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(j\_ion\_pair);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00326}00326\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00327}00327\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00328}00328\ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ ln(gamma)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00329}00329\ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ ln\_gamma\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00330}00330\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00331}00331\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ contributions\ from\ each\ interacting\ ion\_pair}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00332}00332\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_inter\ =\ 0;\ i\_inter\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af4d34c316b8f0219e9d8c106176efe52}{NUM\_INTER\_}}(i\_ion\_pair);\ i\_inter++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00333}00333\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ include\ interactions\ in\ the\ correct\ RH\ range}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00334}00334\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ where\ the\ range\ is\ in\ (minRH,\ maxRH]\ except\ when\ a\_w\ =\ 0.0}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00335}00335\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ where\ the\ range\ is\ in\ [0.0,\ maxRH]}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00336}00336\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((a\_w\ <=\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1756e6d53076042962889be52e07d522}{MIN\_RH\_}}(i\_ion\_pair,\ i\_inter)\ ||}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_w\ >\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a998afd242a326331e35792946f9b8e72}{MAX\_RH\_}}(i\_ion\_pair,\ i\_inter))\ \&\&}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ !(a\_w\ <=\ 0.0\ \&\&\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1756e6d53076042962889be52e07d522}{MIN\_RH\_}}(i\_ion\_pair,\ i\_inter)\ <=\ 0.0))}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00340}00340\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00341}00341\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ ion\_pair\ id\ of\ the\ interacting\ species}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00342}00342\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\_ion\_pair\ =\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a02a474af8927829d7fd9151748b5ac6d}{INTER\_SPEC\_ID\_}}(i\_ion\_pair,\ i\_inter);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00343}00343\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00344}00344\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ ln\_gamma\_inter}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00345}00345\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ ln\_gamma\_inter\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00346}00346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_B\ =\ 0;\ i\_B\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_abfeb83833b166b21cd1e7037af63059b}{NUM\_B\_}}(i\_ion\_pair,\ i\_inter);\ i\_B++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00347}00347\ \ \ \ \ \ \ \ \ \ \ ln\_gamma\_inter\ +=\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a808e07e512299609f2225ad16af879cb}{B\_Z\_}}(i\_ion\_pair,\ i\_inter,\ i\_B)\ *\ pow(a\_w,\ i\_B);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00348}00348\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00349}00349\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00350}00350\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ this\ is\ the\ "{}self"{}\ interaction,\ ln\_gamma\_inter\ is\ ln(gamma\_0A)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00351}00351\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (eq.\ 15\ in\ \(\backslash\)cite\{Topping2009\})}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00352}00352\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\_ion\_pair\ ==\ j\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00353}00353\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ contribution\ to\ ln(gamma\_A)\ from\ ln(gamma\_0A)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00354}00354\ \ \ \ \ \ \ \ \ \ \ ln\_gamma\ +=\ ln\_gamma\_inter;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00355}00355\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00356}00356\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ...\ otherwise\ it\ is\ d(ln(gamma\_A))/g(N\_B,M\ N\_B,x)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00357}00357\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (eq.\ 15\ in\ \(\backslash\)cite\{Topping2009\})}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00358}00358\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00359}00359\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ contribution\ to\ ln(gamma\_A)\ from\ interacting\ ion\_pair.}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00360}00360\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ When\ omega\ ==\ 0,\ N\_cation\ or\ N\_anion\ must\ be\ 0,\ so}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00361}00361\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skip\ to\ avoid\ divide\ by\ zero\ errors}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00362}00362\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (omega\ >\ 0.0)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00363}00363\ \ \ \ \ \ \ \ \ \ \ \ \ ln\_gamma\ +=\ ln\_gamma\_inter\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(j\_ion\_pair)\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00364}00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(j\_ion\_pair)\ /\ omega;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00365}00365\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00366}00366\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00367}00367\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00368}00368\ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ Loop\ on\ interacting\ ion\_pairs}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00369}00369\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00370}00370\ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ gamma\_i\ =\ exp(ln\_gamma);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00371}00371\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00372}00372\ \ \ \ \ \ \ \textcolor{comment}{//\ Loop\ through\ the\ ion\ pairs\ to\ set\ the\ partial\ derivatives}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00373}00373\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_inter\ =\ 0;\ i\_inter\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af4d34c316b8f0219e9d8c106176efe52}{NUM\_INTER\_}}(i\_ion\_pair);\ i\_inter++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00374}00374\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ include\ interactions\ in\ the\ correct\ RH\ range}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00375}00375\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ where\ the\ range\ is\ in\ (minRH,\ maxRH]\ except\ when\ a\_w\ =\ 0.0}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00376}00376\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ where\ the\ range\ is\ in\ [0.0,\ maxRH]}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00377}00377\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((a\_w\ <=\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1756e6d53076042962889be52e07d522}{MIN\_RH\_}}(i\_ion\_pair,\ i\_inter)\ ||}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00378}00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_w\ >\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a998afd242a326331e35792946f9b8e72}{MAX\_RH\_}}(i\_ion\_pair,\ i\_inter))\ \&\&}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00379}00379\ \ \ \ \ \ \ \ \ \ \ \ \ !(a\_w\ <=\ 0.0\ \&\&\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1756e6d53076042962889be52e07d522}{MIN\_RH\_}}(i\_ion\_pair,\ i\_inter)\ <=\ 0.0))}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00380}00380\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00381}00381\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00382}00382\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ ion\_pair\ id\ of\ the\ interacting\ species}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00383}00383\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\_ion\_pair\ =\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a02a474af8927829d7fd9151748b5ac6d}{INTER\_SPEC\_ID\_}}(i\_ion\_pair,\ i\_inter);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00384}00384\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00385}00385\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ ln\_gamma\_inter\ and\ dln\_gamma\_inter\_d\_water}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00386}00386\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ ln\_gamma\_inter\ =\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a808e07e512299609f2225ad16af879cb}{B\_Z\_}}(i\_ion\_pair,\ i\_inter,\ 0);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00387}00387\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ d\_ln\_gamma\_inter\_d\_water\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00388}00388\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_B\ =\ 1;\ i\_B\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_abfeb83833b166b21cd1e7037af63059b}{NUM\_B\_}}(i\_ion\_pair,\ i\_inter);\ i\_B++)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00389}00389\ \ \ \ \ \ \ \ \ \ \ ln\_gamma\_inter\ +=\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a808e07e512299609f2225ad16af879cb}{B\_Z\_}}(i\_ion\_pair,\ i\_inter,\ i\_B)\ *\ pow(a\_w,\ i\_B);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00390}00390\ \ \ \ \ \ \ \ \ \ \ d\_ln\_gamma\_inter\_d\_water\ +=}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00391}00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a808e07e512299609f2225ad16af879cb}{B\_Z\_}}(i\_ion\_pair,\ i\_inter,\ i\_B)\ *\ i\_B\ *\ pow(a\_w,\ i\_B\ -\/\ 1);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00392}00392\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00393}00393\ \ \ \ \ \ \ \ \ d\_ln\_gamma\_inter\_d\_water\ *=\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a895b6a254902b0817da027532796db35}{PPM\_TO\_RH\_}};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00394}00394\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00395}00395\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ this\ is\ the\ "{}self"{}\ interaction,\ ln\_gamma\_inter\ is\ ln(gamma\_0A)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00396}00396\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (eq.\ 15\ in\ \(\backslash\)cite\{Topping2009\})}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00397}00397\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\_ion\_pair\ ==\ j\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00398}00398\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ the\ water\ contribution\ to\ ln(gamma\_0A)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00399}00399\ \ \ \ \ \ \ \ \ \ \ J[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af1e6ab11ed64bb87c61797efead6017a}{JAC\_WATER\_ID\_}}(i\_phase,\ i\_ion\_pair)]\ +=}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00400}00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma\_i\ *\ d\_ln\_gamma\_inter\_d\_water;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00401}00401\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00402}00402\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00403}00403\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ...\ otherwise\ it\ is\ d(ln(gamma\_A))/g(N\_B,M\ N\_B,x)}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00404}00404\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (eq.\ 15\ in\ \(\backslash\)cite\{Topping2009\})}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00405}00405\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00406}00406\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ contribution\ to\ ln(gamma\_A)\ from\ interacting\ ion\_pair.}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00407}00407\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ When\ omega\ ==\ 0,\ N\_cation\ or\ N\_anion\ must\ be\ 0,\ so}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00408}00408\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skip\ to\ avoid\ divide\ by\ zero\ errors}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00409}00409\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (omega\ >\ 0.0)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00410}00410\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ d\_gamma\ /\ d\_cation}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00411}00411\ \ \ \ \ \ \ \ \ \ \ \ \ J[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_afe801e26fe0d88c30f8a592ff0c24cfd}{JAC\_CATION\_ID\_}}(i\_phase,\ i\_ion\_pair,\ j\_ion\_pair)]\ +=}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00412}00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma\_i\ *\ ln\_gamma\_inter\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(j\_ion\_pair)\ /}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00413}00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af30992074351d1fc62267e7a0d234b79}{CATION\_MW\_}}(j\_ion\_pair)\ /\ omega\ *\ 1.0e-\/6;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00414}00414\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00415}00415\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ d\_gamma\ /\ d\_anion}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00416}00416\ \ \ \ \ \ \ \ \ \ \ \ \ J[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_adfad50e5953c49bc824f6b610f673dcd}{JAC\_ANION\_ID\_}}(i\_phase,\ i\_ion\_pair,\ j\_ion\_pair)]\ +=}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00417}00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma\_i\ *\ ln\_gamma\_inter\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(j\_ion\_pair)\ /}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00418}00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ab651fcbff092007a94f147602f065e01}{ANION\_MW\_}}(j\_ion\_pair)\ /\ omega\ *\ 1.0e-\/6;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00419}00419\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00420}00420\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ d\_gamma\ /\ d\_water}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00421}00421\ \ \ \ \ \ \ \ \ \ \ \ \ J[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af1e6ab11ed64bb87c61797efead6017a}{JAC\_WATER\_ID\_}}(i\_phase,\ i\_ion\_pair)]\ +=}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00422}00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma\_i\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(j\_ion\_pair)\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(j\_ion\_pair)\ /\ omega\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00423}00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\_ln\_gamma\_inter\_d\_water;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00424}00424\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00425}00425\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ the\ contributions\ from\ other\ ion\ pairs\ to\ omega}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00426}00426\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\_ion\_pair\ =\ 0;\ k\_ion\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00427}00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++k\_ion\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00428}00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ ion\ pair\ whose\ activity\ is\ being\ calculated\ is\ not}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00429}00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ included\ in\ omega}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00430}00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\_ion\_pair\ ==\ i\_ion\_pair)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00431}00431\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00432}00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ d\_gamma\ /\ d\_cation}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00433}00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ J[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_afe801e26fe0d88c30f8a592ff0c24cfd}{JAC\_CATION\_ID\_}}(i\_phase,\ i\_ion\_pair,\ k\_ion\_pair)]\ +=}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00434}00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/gamma\_i\ *\ ln\_gamma\_inter\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(j\_ion\_pair)\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00435}00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(j\_ion\_pair)\ /\ (omega\ *\ omega)\ *\ 2.0\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00436}00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aca730dbac706a2b1066bb0e1a561cf70}{NUM\_CATION\_}}(k\_ion\_pair)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a3e0d89d3515492d7377285a57644d72e}{NUM\_ANION\_}}(k\_ion\_pair))\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00437}00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(k\_ion\_pair)\ /\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af30992074351d1fc62267e7a0d234b79}{CATION\_MW\_}}(k\_ion\_pair)\ *\ 1.0e-\/6;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00439}00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ d\_gamma\ /\ d\_anion}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00440}00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ J[\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_adfad50e5953c49bc824f6b610f673dcd}{JAC\_ANION\_ID\_}}(i\_phase,\ i\_ion\_pair,\ k\_ion\_pair)]\ +=}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00441}00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/gamma\_i\ *\ ln\_gamma\_inter\ *\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(j\_ion\_pair)\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00442}00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(j\_ion\_pair)\ /\ (omega\ *\ omega)\ *\ 2.0\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00443}00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aca730dbac706a2b1066bb0e1a561cf70}{NUM\_CATION\_}}(k\_ion\_pair)\ +\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a3e0d89d3515492d7377285a57644d72e}{NUM\_ANION\_}}(k\_ion\_pair))\ *}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00444}00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(k\_ion\_pair)\ /\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ab651fcbff092007a94f147602f065e01}{ANION\_MW\_}}(k\_ion\_pair)\ *\ 1.0e-\/6;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00445}00445\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00446}00446\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00447}00447\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00448}00448\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00449}00449\ \ \ \ \ \ \ \}\ \ \textcolor{comment}{//\ Loop\ over\ ion\ pairs\ for\ partial\ derivatives}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00450}00450\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00451}00451\ \ \ \ \ \}\ \ \textcolor{comment}{//\ Loop\ on\ primary\ ion\_pairs}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00452}00452\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00453}00453\ \ \ \}\ \ \textcolor{comment}{//\ Loop\ on\ aerosol\ phases}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00454}00454\ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00455}00455\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00456}00456\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00457}00457\ \textcolor{comment}{/**\ \(\backslash\)brief\ Print\ the\ PDFiTE\ Activity\ sub\ model\ parameters}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00458}00458\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00459}00459\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_int\_data\ Pointer\ to\ the\ sub\ model\ integer\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00460}00460\ \textcolor{comment}{\ *\ \(\backslash\)param\ sub\_model\_float\_data\ Pointer\ to\ the\ sub\ model\ floating-\/point\ data}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00461}00461\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00462}\mbox{\hyperlink{sub__models_8h_a57f2820ce385881014fed09a82ae5364}{00462}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a57f2820ce385881014fed09a82ae5364}{sub\_model\_PDFiTE\_print}}(\textcolor{keywordtype}{int}\ *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00463}00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *sub\_model\_float\_data)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00464}00464\ \ \ \textcolor{keywordtype}{int}\ *int\_data\ =\ sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00465}00465\ \ \ \textcolor{keywordtype}{double}\ *float\_data\ =\ sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00466}00466\ }
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00467}00467\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n***\ PD-\/FiTE\ activity\ sub\ model\ ***\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00468}00468\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00469}00469\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i=0;\ i<\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aa0dffbf9b27f4705b9462d86376d1506}{INT\_DATA\_SIZE\_}};\ i++)}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00470}00470\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \ int\ param\ \%d\ =\ \%d\(\backslash\)n"{}},\ i,\ int\_data[i]);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00471}00471\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i=0;\ i<\mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4c9e4c5f3ca6b19f4eb79ae59cc281eb}{FLOAT\_DATA\_SIZE\_}};\ i++)}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00472}00472\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \ float\ param\ \%d\ =\ \%le\(\backslash\)n"{}},\ i,\ float\_data[i]);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00473}00473\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00474}00474\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ number\ of\ phases:\ \ \ \ \ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00475}00475\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ gas-\/phase\ water\ id:\ \ \ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a75ac531220686f1130f21aca98adf72f}{GAS\_WATER\_ID\_}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00476}00476\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ number\ of\ ion\ pairs:\ \ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00477}00477\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ **\ Phase\ data\ **"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00478}00478\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ (Ids\ for\ ions\ and\ activity\ coefficients\ are\ relative"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00479}00479\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ to\ the\ state\ id\ of\ aerosol-\/phase\ water\ for\ each\ phase.)"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00480}00480\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ ++i\_phase)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00481}00481\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ phase\ \%d:\ aerosol-\/phase\ water\ state\ id:\ \%d"{}},\ i\_phase,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00482}00482\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a6516861a7e3bae5147d70f6411e11117}{PHASE\_ID\_}}(i\_phase));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00483}00483\ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00484}00484\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ **\ Ion\ pair\ data\ **"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00485}00485\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_pair\ =\ 0;\ i\_pair\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ ++i\_pair)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00486}00486\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ Ion\ pair\ \%d"{}},\ i\_pair);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00487}00487\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ State\ ids\ (relative\ to\ aerosol-\/phase\ water)"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00488}00488\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ Activity\ coeff:\ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a38a422887b1248140b51d6beff1930c5}{ION\_PAIR\_ACT\_ID\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00489}00489\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ Cation:\ \ \ \ \ \ \ \ \ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ac16e157f1f96e0ef91e6f08036b12c7a}{CATION\_ID\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00490}00490\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ Anion:\ \ \ \ \ \ \ \ \ \ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a908d4e051ac9bb3450f9201194f086bf}{ANION\_ID\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00491}00491\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Jacobian\ aerosol\ water\ id\ (by\ phase):"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00492}00492\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ ++i\_phase)}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00493}00493\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af1e6ab11ed64bb87c61797efead6017a}{JAC\_WATER\_ID\_}}(i\_phase,\ i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00494}00494\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Cation\ stoichiometry:\ \ \ \ \ \ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aca730dbac706a2b1066bb0e1a561cf70}{NUM\_CATION\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00495}00495\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Anion\ stoichiometry:\ \ \ \ \ \ \ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a3e0d89d3515492d7377285a57644d72e}{NUM\_ANION\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00496}00496\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Cation\ MW\ (kg/mol):\ \ \ \ \ \ \ \ \%le"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af30992074351d1fc62267e7a0d234b79}{CATION\_MW\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00497}00497\ \ \ \ \ ;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00498}00498\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Anion\ MW\ (kg/mol):\ \ \ \ \ \ \ \ \ \%le"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_ab651fcbff092007a94f147602f065e01}{ANION\_MW\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00499}00499\ \ \ \ \ ;}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00500}00500\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Cation\ concentration\ (mol\ m-\/3):\ \%le"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a52fdc833ce625c5207869764adeb6e33}{CATION\_N\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00501}00501\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Anion\ concentration\ (mol\ m-\/3):\ \ \%le"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aabe6c6c9920f5749027caab37713fd56}{ANION\_N\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00502}00502\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Number\ of\ ion-\/pair\ interactions:\ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af4d34c316b8f0219e9d8c106176efe52}{NUM\_INTER\_}}(i\_pair));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00503}00503\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ *\ Jacobian\ Omega\ ids\ *"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00504}00504\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_oip\ =\ 0;\ i\_oip\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a4008250ee798e933af3839ff7df66da6}{NUM\_ION\_PAIRS\_}};\ ++i\_oip)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00505}00505\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ Ion\ pair\ index:\ \%d"{}},\ i\_oip);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00506}00506\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ Anion\ \ (by\ phase)"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00507}00507\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ ++i\_phase)}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00508}00508\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_adfad50e5953c49bc824f6b610f673dcd}{JAC\_ANION\_ID\_}}(i\_phase,\ i\_pair,\ i\_oip));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00509}00509\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ Cation\ (by\ phase)"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00510}00510\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ ++i\_phase)}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00511}00511\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_afe801e26fe0d88c30f8a592ff0c24cfd}{JAC\_CATION\_ID\_}}(i\_phase,\ i\_pair,\ i\_oip));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00512}00512\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00513}00513\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ *\ Ion-\/pair\ interaction\ data\ *"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00514}00514\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_inter\ =\ 0;\ i\_inter\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_af4d34c316b8f0219e9d8c106176efe52}{NUM\_INTER\_}}(i\_pair);\ ++i\_inter)\ \{}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00515}00515\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ Interaction\ \%d:"{}},\ i\_inter);}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00516}00516\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ Ion\ pair\ index:\ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a02a474af8927829d7fd9151748b5ac6d}{INTER\_SPEC\_ID\_}}(i\_pair,\ i\_inter));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00517}00517\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ Min\ RH:\ \%le"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a1756e6d53076042962889be52e07d522}{MIN\_RH\_}}(i\_pair,\ i\_inter));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00518}00518\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ Max\ RH:\ \%le"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a998afd242a326331e35792946f9b8e72}{MAX\_RH\_}}(i\_pair,\ i\_inter));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00519}00519\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ Jacobian\ ids\ (by\ phase)"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00520}00520\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ \ \ Cation:"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00521}00521\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ ++i\_phase)}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00522}00522\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \%d"{}},\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_afe801e26fe0d88c30f8a592ff0c24cfd}{JAC\_CATION\_ID\_}}(i\_phase,\ i\_pair,}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00523}00523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a02a474af8927829d7fd9151748b5ac6d}{INTER\_SPEC\_ID\_}}(i\_pair,\ i\_inter)));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00524}00524\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ \ \ Anion:\ "{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00525}00525\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_phase\ =\ 0;\ i\_phase\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_aff1191174604af4c86c622f98cd18c17}{NUM\_PHASE\_}};\ ++i\_phase)}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00526}00526\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \%d"{}},}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00527}00527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_adfad50e5953c49bc824f6b610f673dcd}{JAC\_ANION\_ID\_}}(i\_phase,\ i\_pair,\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a02a474af8927829d7fd9151748b5ac6d}{INTER\_SPEC\_ID\_}}(i\_pair,\ i\_inter)));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00528}00528\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ "{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00529}00529\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\_B\ =\ 0;\ i\_B\ <\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_abfeb83833b166b21cd1e7037af63059b}{NUM\_B\_}}(i\_pair,\ i\_inter);\ ++i\_B)}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00530}00530\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ B\%d:\ \%le"{}},\ i\_B,\ \mbox{\hyperlink{sub__model___p_d_fi_t_e_8c_a808e07e512299609f2225ad16af879cb}{B\_Z\_}}(i\_pair,\ i\_inter,\ i\_B));}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00531}00531\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00532}00532\ \ \ \}}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00533}00533\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n***\ end\ PD-\/FiTE\ activity\ sub\ model\ ***"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___p_d_fi_t_e_8c_source_l00534}00534\ \}}

\end{DoxyCode}
