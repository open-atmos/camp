\hypertarget{sub__model___u_n_i_f_a_c_8c_source}{}\doxysection{sub\+\_\+model\+\_\+\+UNIFAC.\+c}
\label{sub__model___u_n_i_f_a_c_8c_source}\index{sub\_model\_UNIFAC.c@{sub\_model\_UNIFAC.c}}
\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00001}00001 \textcolor{comment}{/* Copyright (C) 2021 Barcelona Supercomputing Center and University of}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00002}00002 \textcolor{comment}{ * Illinois at Urbana-\/Champaign}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00003}00003 \textcolor{comment}{ * SPDX-\/License-\/Identifier: MIT}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00004}00004 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00005}00005 \textcolor{comment}{ * UNIFAC activity coefficient calculation}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00006}00006 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00007}00007 \textcolor{comment}{ */}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00008}00008 \textcolor{comment}{/** \(\backslash\)file}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00009}00009 \textcolor{comment}{ * \(\backslash\)brief UNIFAC activity coefficient calculation}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00010}00010 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00011}00011 \textcolor{comment}{ * For more info see the camp\_sub\_model\_UNIFAC module}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00012}00012 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00013}00013 \textcolor{comment}{ * Equation references are to Marcolli and Peter, ACP 5(2), 1501-\/1527, 2005.}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00014}00014 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00015}00015 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00016}00016 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00017}00017 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00018}00018 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00019}00019 \textcolor{preprocessor}{\#include "{}../Jacobian.h"{}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00020}00020 \textcolor{preprocessor}{\#include "{}../sub\_models.h"{}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00022}00022 \textcolor{comment}{// TODO Lookup environmental indicies during initialization}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00023}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa90d2b6c48aceb4d7ac3d93d5249bb60}{00023}} \textcolor{preprocessor}{\#define TEMPERATURE\_K\_ env\_data[0]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00024}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a32cc078fd8ca9ad0684c48ae0aad7135}{00024}} \textcolor{preprocessor}{\#define PRESSURE\_PA\_ env\_data[1]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00025}00025 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00026}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa97428673e94e122eea2cf55bdc0e8d3}{00026}} \textcolor{preprocessor}{\#define NUM\_UNIQUE\_PHASE\_ (int\_data[0])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00027}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{00027}} \textcolor{preprocessor}{\#define NUM\_GROUP\_ (int\_data[1])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00028}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a6dc5674d6d69ee7413767ee9076138ae}{00028}} \textcolor{preprocessor}{\#define TOTAL\_INT\_PROP\_ (int\_data[2])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00029}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a449afc986a9379f304456d0b93c06c52}{00029}} \textcolor{preprocessor}{\#define TOTAL\_FLOAT\_PROP\_ (int\_data[3])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00030}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a13ba1b28e3d8a5e60eec52ce6bbabe4f}{00030}} \textcolor{preprocessor}{\#define NUM\_INT\_PROP\_ 4}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00031}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a0e9ae6000e4ed18f5938bddaddb13d1b}{00031}} \textcolor{preprocessor}{\#define NUM\_FLOAT\_PROP\_ 0}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00032}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac0b5b9446b202d1ce286ecefe0108869}{00032}} \textcolor{preprocessor}{\#define PHASE\_INT\_LOC\_(p) (int\_data[NUM\_INT\_PROP\_ + p] -\/ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00033}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a1ad2cc048e99792784cf0798275e6ff0}{00033}} \textcolor{preprocessor}{\#define PHASE\_FLOAT\_LOC\_(p) \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00034}00034 \textcolor{preprocessor}{  (int\_data[NUM\_INT\_PROP\_ + NUM\_UNIQUE\_PHASE\_ + p] -\/ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00035}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a56362e1faed2ba94b75e5a223b60b424}{00035}} \textcolor{preprocessor}{\#define PHASE\_ENV\_LOC\_(p) \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00036}00036 \textcolor{preprocessor}{  (int\_data[NUM\_INT\_PROP\_ + 2 * NUM\_UNIQUE\_PHASE\_ + p] -\/ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00037}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a96afb96b89157441704719c55a19fd76}{00037}} \textcolor{preprocessor}{\#define NUM\_PHASE\_INSTANCE\_(p) (int\_data[PHASE\_INT\_LOC\_(p)])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00038}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{00038}} \textcolor{preprocessor}{\#define NUM\_SPEC\_(p) (int\_data[PHASE\_INT\_LOC\_(p) + 1])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00039}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{00039}} \textcolor{preprocessor}{\#define PHASE\_INST\_ID\_(p, c) (int\_data[PHASE\_INT\_LOC\_(p) + 2 + c] -\/ 1)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00040}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{00040}} \textcolor{preprocessor}{\#define SPEC\_ID\_(p, i) \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00041}00041 \textcolor{preprocessor}{  (int\_data[PHASE\_INT\_LOC\_(p) + 2 + NUM\_PHASE\_INSTANCE\_(p) + i])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00042}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa4a9078d99a1dbfa58de04936d652bce}{00042}} \textcolor{preprocessor}{\#define GAMMA\_ID\_(p, i) \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00043}00043 \textcolor{preprocessor}{  (int\_data[PHASE\_INT\_LOC\_(p) + 2 + NUM\_PHASE\_INSTANCE\_(p) + NUM\_SPEC\_(p) + i])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00044}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad30fc663399a0c977685d511359e6f7a}{00044}} \textcolor{preprocessor}{\#define JAC\_ID\_(p, c, j, i)                                 \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00045}00045 \textcolor{preprocessor}{  int\_data[PHASE\_INT\_LOC\_(p) + 2 + NUM\_PHASE\_INSTANCE\_(p) + \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00046}00046 \textcolor{preprocessor}{           (2 + c * NUM\_SPEC\_(p) + j) * NUM\_SPEC\_(p) + i]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00047}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{00047}} \textcolor{preprocessor}{\#define V\_IK\_(p, i, k)                                                       \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00048}00048 \textcolor{preprocessor}{  (int\_data[PHASE\_INT\_LOC\_(p) + 2 + NUM\_PHASE\_INSTANCE\_(p) +                 \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00049}00049 \textcolor{preprocessor}{            (k + 2 + NUM\_PHASE\_INSTANCE\_(p) * NUM\_SPEC\_(p)) * NUM\_SPEC\_(p) + \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00050}00050 \textcolor{preprocessor}{            i])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00052}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{00052}} \textcolor{preprocessor}{\#define Q\_K\_(k) (float\_data[k])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00053}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_abb8a6874bbc52c11b838e00ab5ebaa5e}{00053}} \textcolor{preprocessor}{\#define R\_K\_(k) (float\_data[NUM\_GROUP\_ + k])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00054}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{00054}} \textcolor{preprocessor}{\#define X\_K\_(m) (float\_data[2 * NUM\_GROUP\_ + m])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00055}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a55b754107c270c7b258232638bf7d394}{00055}} \textcolor{preprocessor}{\#define DTHETA\_M\_DC\_I\_(m) (float\_data[3 * NUM\_GROUP\_ + m])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00056}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{00056}} \textcolor{preprocessor}{\#define XI\_M\_(m) (float\_data[4 * NUM\_GROUP\_ + m])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00057}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{00057}} \textcolor{preprocessor}{\#define LN\_GAMMA\_K\_(m) (float\_data[5 * NUM\_GROUP\_ + m])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00058}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad857d77cfc3f85ade1e96ba998454aa9}{00058}} \textcolor{preprocessor}{\#define A\_MN\_(m, n) (float\_data[(m + 6) * NUM\_GROUP\_ + n])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00059}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{00059}} \textcolor{preprocessor}{\#define R\_I\_(p, i) (float\_data[PHASE\_FLOAT\_LOC\_(p) + i])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00060}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{00060}} \textcolor{preprocessor}{\#define Q\_I\_(p, i) (float\_data[PHASE\_FLOAT\_LOC\_(p) + NUM\_SPEC\_(p) + i])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00061}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ae785d2a9fe11700b737572da4bc84b14}{00061}} \textcolor{preprocessor}{\#define L\_I\_(p, i) (float\_data[PHASE\_FLOAT\_LOC\_(p) + 2 * NUM\_SPEC\_(p) + i])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00062}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a1f5c2d7f5d00731ad2b59dafd08f8b26}{00062}} \textcolor{preprocessor}{\#define MW\_I\_(p, i) (float\_data[PHASE\_FLOAT\_LOC\_(p) + 3 * NUM\_SPEC\_(p) + i])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00063}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{00063}} \textcolor{preprocessor}{\#define X\_I\_(p, i) (float\_data[PHASE\_FLOAT\_LOC\_(p) + 4 * NUM\_SPEC\_(p) + i])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00064}00064 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00065}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{00065}} \textcolor{preprocessor}{\#define THETA\_M\_(m) (sub\_model\_env\_data[m])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00066}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{00066}} \textcolor{preprocessor}{\#define PSI\_MN\_(m, n) (sub\_model\_env\_data[(m + 1) * NUM\_GROUP\_ + n])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00067}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38e65393d48cdee41eefe73e2279e55a}{00067}} \textcolor{preprocessor}{\#define LN\_GAMMA\_IK\_(p, i, k) \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00068}00068 \textcolor{preprocessor}{  (sub\_model\_env\_data[PHASE\_ENV\_LOC\_(p) + i * NUM\_GROUP\_ + k])}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00070}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa0dffbf9b27f4705b9462d86376d1506}{00070}} \textcolor{preprocessor}{\#define INT\_DATA\_SIZE\_ (TOTAL\_INT\_PROP\_)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00071}\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a4c9e4c5f3ca6b19f4eb79ae59cc281eb}{00071}} \textcolor{preprocessor}{\#define FLOAT\_DATA\_SIZE\_ (TOTAL\_FLOAT\_PROP\_)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00073}00073 \textcolor{comment}{// Update types (These must match values in sub\_model\_UNIFAC.F90)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00074}00074 \textcolor{comment}{// (none right now)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00075}00075 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00076}00076 \textcolor{comment}{/** \(\backslash\)brief Get the Jacobian elements used for a particular row of the matrix}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00077}00077 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00078}00078 \textcolor{comment}{ * \(\backslash\)param sub\_model\_int\_data Pointer to the sub model integer data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00079}00079 \textcolor{comment}{ * \(\backslash\)param sub\_model\_float\_data Pointer to the sub model floating-\/point data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00080}00080 \textcolor{comment}{ * \(\backslash\)param jac Jacobian}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00081}00081 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00082}\mbox{\hyperlink{sub__models_8h_a6895ac51f6122ce830f30d8b1f09d052}{00082}} \textcolor{keywordtype}{void} \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a6895ac51f6122ce830f30d8b1f09d052}{sub\_model\_UNIFAC\_get\_used\_jac\_elem}}(\textcolor{keywordtype}{int} *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00083}00083                                         \textcolor{keywordtype}{double} *sub\_model\_float\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00084}00084                                         \mbox{\hyperlink{struct_jacobian}{Jacobian}} *jac) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00085}00085   \textcolor{keywordtype}{int} *int\_data = sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00086}00086   \textcolor{keywordtype}{double} *float\_data = sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00088}00088   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_phase = 0; i\_phase < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa97428673e94e122eea2cf55bdc0e8d3}{NUM\_UNIQUE\_PHASE\_}}; ++i\_phase)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00089}00089     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_inst = 0; i\_inst < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a96afb96b89157441704719c55a19fd76}{NUM\_PHASE\_INSTANCE\_}}(i\_phase); ++i\_inst)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00090}00090       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_gamma = 0; i\_gamma < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_gamma)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00091}00091         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00092}00092           \mbox{\hyperlink{_jacobian_8c_aac51ac6b1cf239a84899308dab229441}{jacobian\_register\_element}}(}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00093}00093               jac,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00094}00094               \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_inst) + \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa4a9078d99a1dbfa58de04936d652bce}{GAMMA\_ID\_}}(i\_phase, i\_gamma),}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00095}00095               \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_inst) + \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{SPEC\_ID\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00096}00096 \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00097}00097 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00098}00098 \textcolor{comment}{/** \(\backslash\)brief Update stored ids for elements used within a row of the Jacobian}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00099}00099 \textcolor{comment}{ * matrix}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00100}00100 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00101}00101 \textcolor{comment}{ * \(\backslash\)param sub\_model\_int\_data Pointer to the sub model integer data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00102}00102 \textcolor{comment}{ * \(\backslash\)param sub\_model\_float\_data Pointer to the sub model floating-\/point data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00103}00103 \textcolor{comment}{ * \(\backslash\)param deriv\_ids Indices for state array variables on the solver state array}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00104}00104 \textcolor{comment}{ * \(\backslash\)param jac Jacobian}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00105}00105 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00106}\mbox{\hyperlink{sub__models_8h_a2674d98846a9c4933d56156ec1f0deb5}{00106}} \textcolor{keywordtype}{void} \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a2674d98846a9c4933d56156ec1f0deb5}{sub\_model\_UNIFAC\_update\_ids}}(\textcolor{keywordtype}{int} *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00107}00107                                  \textcolor{keywordtype}{double} *sub\_model\_float\_data, \textcolor{keywordtype}{int} *deriv\_ids,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00108}00108                                  \mbox{\hyperlink{struct_jacobian}{Jacobian}} jac) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00109}00109   \textcolor{keywordtype}{int} *int\_data = sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00110}00110   \textcolor{keywordtype}{double} *float\_data = sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00111}00111 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00112}00112   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_phase = 0; i\_phase < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa97428673e94e122eea2cf55bdc0e8d3}{NUM\_UNIQUE\_PHASE\_}}; ++i\_phase)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00113}00113     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_inst = 0; i\_inst < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a96afb96b89157441704719c55a19fd76}{NUM\_PHASE\_INSTANCE\_}}(i\_phase); ++i\_inst)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00114}00114       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_gamma = 0; i\_gamma < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_gamma)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00115}00115         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00116}00116           \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad30fc663399a0c977685d511359e6f7a}{JAC\_ID\_}}(i\_phase, i\_inst, i\_gamma, i\_spec) = \mbox{\hyperlink{_jacobian_8c_a7b43d5884ec62826389d6d739b7f25eb}{jacobian\_get\_element\_id}}(}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00117}00117               jac,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00118}00118               \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_inst) + \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa4a9078d99a1dbfa58de04936d652bce}{GAMMA\_ID\_}}(i\_phase, i\_gamma),}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00119}00119               \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_inst) + \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{SPEC\_ID\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00120}00120 \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00121}00121 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00122}00122 \textcolor{comment}{/** \(\backslash\)brief Update sub-\/model data for new environmental conditions}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00123}00123 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00124}00124 \textcolor{comment}{ * \(\backslash\)param sub\_model\_int\_data Pointer to the sub model integer data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00125}00125 \textcolor{comment}{ * \(\backslash\)param sub\_model\_float\_data Pointer to the sub model floating-\/point data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00126}00126 \textcolor{comment}{ * \(\backslash\)param sub\_model\_env\_data Pointer to the sub model environment-\/dependent data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00127}00127 \textcolor{comment}{ * \(\backslash\)param model\_data Pointer to the model data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00128}00128 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00129}\mbox{\hyperlink{sub__models_8h_a43f3628a20f1bf545034554576e9c85c}{00129}} \textcolor{keywordtype}{void} \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a43f3628a20f1bf545034554576e9c85c}{sub\_model\_UNIFAC\_update\_env\_state}}(\textcolor{keywordtype}{int} *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00130}00130                                        \textcolor{keywordtype}{double} *sub\_model\_float\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00131}00131                                        \textcolor{keywordtype}{double} *sub\_model\_env\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00132}00132                                        \mbox{\hyperlink{struct_model_data}{ModelData}} *model\_data) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00133}00133   \textcolor{keywordtype}{int} *int\_data = sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00134}00134   \textcolor{keywordtype}{double} *float\_data = sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00135}00135   \textcolor{keywordtype}{double} *env\_data = model\_data-\/>\mbox{\hyperlink{struct_model_data_a847bd594a8e88da48104655fdc8524d7}{grid\_cell\_env}};}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00137}00137   \textcolor{comment}{// Update the interaction parameters}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00138}00138   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} m = 0; m < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; m++)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00139}00139     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n = 0; n < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; n++)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00140}00140       \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(m, n) = exp(-\/\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad857d77cfc3f85ade1e96ba998454aa9}{A\_MN\_}}(m, n) / \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa90d2b6c48aceb4d7ac3d93d5249bb60}{TEMPERATURE\_K\_}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00141}00141 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00142}00142   \textcolor{comment}{// Calculate the pure liquid residual acitivity ceofficient ln(GAMMA\_k\string^(i))}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00143}00143   \textcolor{comment}{// terms. Eq. 7 \& 8}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00144}00144   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_phase = 0; i\_phase < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa97428673e94e122eea2cf55bdc0e8d3}{NUM\_UNIQUE\_PHASE\_}}; i\_phase++) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00145}00145     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); i\_spec++) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00146}00146       \textcolor{comment}{// Calculate the sum (Q\_n * X\_n) in the denominator of Eq. 9 for the}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00147}00147       \textcolor{comment}{// pure liquid}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00148}00148       \textcolor{keywordtype}{double} sum\_Qn\_Xn = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00149}00149       \textcolor{keywordtype}{double} total\_group\_moles = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00150}00150       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; i\_group++) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00151}00151         sum\_Qn\_Xn += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(i\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, i\_spec, i\_group);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00152}00152         total\_group\_moles += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, i\_spec, i\_group);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00153}00153       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00154}00154       sum\_Qn\_Xn *= 1.0 / total\_group\_moles;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00156}00156       \textcolor{comment}{// Calculate THETA\_m Eq. 9}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00157}00157       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} m = 0; m < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; m++)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00158}00158         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(m) =}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00159}00159             \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(m) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, i\_spec, m) / sum\_Qn\_Xn / total\_group\_moles;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00161}00161       \textcolor{comment}{// Calculate ln(GAMMA\_k\string^(i))}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00162}00162       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; k++) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00163}00163         \textcolor{keywordtype}{double} sum\_m\_A = 0.0;  \textcolor{comment}{// ln( sum\_m\_A ) term in Eq. 8}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00164}00164         \textcolor{keywordtype}{double} sum\_m\_B = 0.0;  \textcolor{comment}{// last term in Eq. 8}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00165}00165         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} m = 0; m < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; m++) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00166}00166           sum\_m\_A += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(m) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(m, k);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00167}00167           \textcolor{keywordtype}{double} sum\_n = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00168}00168           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n = 0; n < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; n++)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00169}00169             sum\_n += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(n) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(n, m);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00170}00170           sum\_m\_B += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(m) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(k, m) / sum\_n;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00171}00171         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00172}00172         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38e65393d48cdee41eefe73e2279e55a}{LN\_GAMMA\_IK\_}}(i\_phase, i\_spec, k) =}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00173}00173             \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(k) * (1.0 -\/ log(sum\_m\_A) -\/ sum\_m\_B);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00174}00174       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00175}00175     \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00176}00176   \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00177}00177 \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00178}00178 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00179}00179 \textcolor{comment}{/** \(\backslash\)brief Perform the sub-\/model calculations for the current model state}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00180}00180 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00181}00181 \textcolor{comment}{ * These calculations are based on equations (1)-\/-\/(9) in \(\backslash\)cite Marcolli2005.}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00182}00182 \textcolor{comment}{ * Variable names used in the derivation of the Jacobian equations are}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00183}00183 \textcolor{comment}{ * adopted here for consistency. Specifically, these are:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00184}00184 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00185}00185 \textcolor{comment}{ *   \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00186}00186 \textcolor{comment}{ *    \(\backslash\)sigma \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_k r\_k x\_k, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00187}00187 \textcolor{comment}{ *    \(\backslash\)tau \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_k q\_k x\_k, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00188}00188 \textcolor{comment}{ *    \(\backslash\)mu \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_j x\_j l\_j, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00189}00189 \textcolor{comment}{ *    c\_\{xX\} \& = \(\backslash\)frac\{1\}\{\(\backslash\)displaystyle\(\backslash\)sum\_j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00190}00190 \textcolor{comment}{ *                   \(\backslash\)displaystyle\(\backslash\)sum\_i v\_j\string^\{(i)\} x\_i\}, \(\backslash\)textrm\{ and\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00191}00191 \textcolor{comment}{ *    \(\backslash\)Pi \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_n Q\_n X\_n. \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00192}00192 \textcolor{comment}{ *   \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00193}00193 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00194}00194 \textcolor{comment}{ * Using these variables and subscript \(\backslash\)f\$j\(\backslash\)f\$ for the species whose activity}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00195}00195 \textcolor{comment}{ * is being calculated for easy comparison with the Jacobian calculations,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00196}00196 \textcolor{comment}{ * equations (1)-\/-\/(9) in \(\backslash\)cite Marcolli2005 become:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00197}00197 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00198}00198 \textcolor{comment}{ *   \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00199}00199 \textcolor{comment}{ *    \(\backslash\)ln\{\(\backslash\)gamma\_j\} \& = \(\backslash\)ln\{\(\backslash\)gamma\_j\string^C\} + \(\backslash\)ln\{\(\backslash\)gamma\_j\string^R\} \& (1) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00200}00200 \textcolor{comment}{ *    \(\backslash\)alpha\_w \& = \(\backslash\)gamma\_w x\_w \& (2) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00201}00201 \textcolor{comment}{ *    \(\backslash\)ln\{\(\backslash\)gamma\_j\string^C\} \& = \(\backslash\)ln\{\(\backslash\)frac\{\(\backslash\)Phi\_j\}\{x\_j\}\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00202}00202 \textcolor{comment}{ *                       + \(\backslash\)frac\{z\}\{2\}q\_j\(\backslash\)ln\{\(\backslash\)frac\{\(\backslash\)Theta\_j\}\{\(\backslash\)Phi\_j\}\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00203}00203 \textcolor{comment}{ *                       + l\_j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00204}00204 \textcolor{comment}{ *                       -\/ \(\backslash\)frac\{\(\backslash\)Phi\_j\}\{x\_j\}\(\backslash\)mu \& (3) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00205}00205 \textcolor{comment}{ *    \(\backslash\)Phi\_j \& = \(\backslash\)frac\{r\_j x\_j\}\{\(\backslash\)sigma\}; \(\backslash\)qquad}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00206}00206 \textcolor{comment}{ *    \(\backslash\)Theta\_j = \(\backslash\)frac\{q\_j x\_j\}\{\(\backslash\)tau\} \& (4) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00207}00207 \textcolor{comment}{ *    l\_j \& = \(\backslash\)frac\{z\}\{2\}\(\backslash\)left(r\_j -\/ q\_j\(\backslash\)right) -\/ r\_j + 1 \& (5) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00208}00208 \textcolor{comment}{ *    r\_j \& = \(\backslash\)displaystyle\(\backslash\)sum\_k v\_k\string^\{(j)\}R\_k; \(\backslash\)qquad}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00209}00209 \textcolor{comment}{ *    q\_j   = \(\backslash\)displaystyle\(\backslash\)sum\_k v\_k\string^\{(j)\}Q\_k \& (6) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00210}00210 \textcolor{comment}{ *    \(\backslash\)ln\{\(\backslash\)gamma\_j\string^R\} \& = \(\backslash\)displaystyle\(\backslash\)sum\_k v\_k\string^\{(j)\} \(\backslash\)left[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00211}00211 \textcolor{comment}{ *                        \(\backslash\)ln\{\(\backslash\)Gamma\_k\} -\/ \(\backslash\)ln\{\(\backslash\)Gamma\_k\string^\{(j)\}\}\(\backslash\)right] \& (7) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00212}00212 \textcolor{comment}{ *    \(\backslash\)ln\{\(\backslash\)Gamma\_k\} \& = Q\_k \(\backslash\)left[ 1 -\/ \(\backslash\)ln\{\(\backslash\)Xi\_k\} -\/}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00213}00213 \textcolor{comment}{ *                      \(\backslash\)displaystyle\(\backslash\)sum\_m\(\backslash\)frac\{\(\backslash\)Theta\_m\(\backslash\)Phi\_\{km\}\}\{\(\backslash\)Xi\_m\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00214}00214 \textcolor{comment}{ *                      \(\backslash\)right] \& (8) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00215}00215 \textcolor{comment}{ *    \(\backslash\)Theta\_m \& = \(\backslash\)frac\{Q\_m X\_m\}\{\(\backslash\)Pi\}; \(\backslash\)qquad}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00216}00216 \textcolor{comment}{ *    \(\backslash\)Psi\_\{mn\} = \(\backslash\)mathrm\{exp\}\(\backslash\)left[\(\backslash\)frac\{-\/a\_\{mn\}\}\{T\}\(\backslash\)right] \& (9) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00217}00217 \textcolor{comment}{ *   \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00218}00218 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00219}00219 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00220}00220 \textcolor{comment}{ * \(\backslash\)param sub\_model\_int\_data Pointer to the sub model integer data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00221}00221 \textcolor{comment}{ * \(\backslash\)param sub\_model\_float\_data Pointer to the sub model floating-\/point data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00222}00222 \textcolor{comment}{ * \(\backslash\)param sub\_model\_env\_data Pointer to the sub model environment-\/dependent data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00223}00223 \textcolor{comment}{ * \(\backslash\)param model\_data Pointer to the model data including the current state and}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00224}00224 \textcolor{comment}{ *                   environmental conditions}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00225}00225 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00226}\mbox{\hyperlink{sub__models_8h_a91d55564c556bf61d6bf0ccac7b43e4b}{00226}} \textcolor{keywordtype}{void} \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a91d55564c556bf61d6bf0ccac7b43e4b}{sub\_model\_UNIFAC\_calculate}}(\textcolor{keywordtype}{int} *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00227}00227                                 \textcolor{keywordtype}{double} *sub\_model\_float\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00228}00228                                 \textcolor{keywordtype}{double} *sub\_model\_env\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00229}00229                                 \mbox{\hyperlink{struct_model_data}{ModelData}} *model\_data) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00230}00230   \textcolor{keywordtype}{int} *int\_data = sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00231}00231   \textcolor{keywordtype}{double} *float\_data = sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00232}00232 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00233}00233   \textcolor{keywordtype}{double} *state = model\_data-\/>\mbox{\hyperlink{struct_model_data_a97655058cfc0116225582920128111ef}{grid\_cell\_state}};}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00234}00234 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00235}00235   \textcolor{comment}{// Loop through each instance of each phase to calculate activity}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00236}00236   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_phase = 0; i\_phase < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa97428673e94e122eea2cf55bdc0e8d3}{NUM\_UNIQUE\_PHASE\_}}; ++i\_phase) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00237}00237     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_instance = 0; i\_instance < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a96afb96b89157441704719c55a19fd76}{NUM\_PHASE\_INSTANCE\_}}(i\_phase);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00238}00238          ++i\_instance) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00239}00239       \textcolor{comment}{// Get the total number of moles of species in this phase instance}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00240}00240       \textcolor{keywordtype}{double} m\_T = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00241}00241       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00242}00242         m\_T += state[\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_instance) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00243}00243                      \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{SPEC\_ID\_}}(i\_phase, i\_spec)] /}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00244}00244                \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a1f5c2d7f5d00731ad2b59dafd08f8b26}{MW\_I\_}}(i\_phase, i\_spec);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00245}00245       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00246}00246 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00247}00247       \textcolor{comment}{// If there are no species present, skip the calculations}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00248}00248       \textcolor{keywordflow}{if} (m\_T <= 0.0) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00249}00249         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00250}00250           state[\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_instance) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00251}00251                 \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa4a9078d99a1dbfa58de04936d652bce}{GAMMA\_ID\_}}(i\_phase, i\_spec)] = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00252}00252         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00253}00253         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00254}00254       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00256}00256       \textcolor{comment}{// Pre-\/calculate mole fractions and variables that do not depend}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00257}00257       \textcolor{comment}{// on species j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00258}00258 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00259}00259       \textcolor{keywordtype}{double} sigma = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00260}00260       \textcolor{keywordtype}{double} tau = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00261}00261       \textcolor{keywordtype}{double} mu = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00262}00262       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00263}00263         \textcolor{comment}{// Mole fractions x\_i}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00264}00264         \textcolor{keywordtype}{double} x\_i = state[\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_instance) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00265}00265                            \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{SPEC\_ID\_}}(i\_phase, i\_spec)] /}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00266}00266                      \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a1f5c2d7f5d00731ad2b59dafd08f8b26}{MW\_I\_}}(i\_phase, i\_spec) / m\_T;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00267}00267         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, i\_spec) = x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00269}00269         \textcolor{comment}{// Combinatorial variables}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00270}00270         sigma += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{R\_I\_}}(i\_phase, i\_spec) * x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00271}00271         tau += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, i\_spec) * x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00272}00272         mu += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ae785d2a9fe11700b737572da4bc84b14}{L\_I\_}}(i\_phase, i\_spec) * x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00273}00273       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00274}00274 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00275}00275       \textcolor{comment}{// Residual variables}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00276}00276       \textcolor{keywordtype}{double} c\_xX = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00277}00277       \textcolor{keywordtype}{double} Pi = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00278}00278       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00279}00279         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group) = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00280}00280         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00281}00281           \textcolor{keywordtype}{double} v\_ik\_x\_i =}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00282}00282               \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, i\_spec, i\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, i\_spec);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00283}00283           c\_xX += v\_ik\_x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00284}00284           \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group) += v\_ik\_x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00285}00285         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00286}00286       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00287}00287       c\_xX = 1.0 / c\_xX;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00288}00288       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00289}00289         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group) *= c\_xX;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00290}00290         Pi += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(i\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00291}00291       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00292}00292       \textcolor{comment}{// Group surface area fractions Theta\_m (Eq. 9)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00293}00293       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00294}00294         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(i\_group) = \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(i\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group) / Pi;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00295}00295 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00296}00296       \textcolor{comment}{// Xi\_m}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00297}00297       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00298}00298         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(i\_group) = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00299}00299         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j\_group = 0; j\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++j\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00300}00300           \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(i\_group) += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(j\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(j\_group, i\_group);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00301}00301         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00302}00302       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00303}00303 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00304}00304       \textcolor{comment}{// Group residual activity coefficients ln(Gamma\_k) (Eq. 8)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00305}00305       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++k) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00306}00306         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(k) = 1.0 -\/ log(\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(k));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00307}00307         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} m = 0; m < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++m)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00308}00308           \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(k) -\/= \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(m) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(k, m) / \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(m);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00309}00309         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(k) *= \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(k);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00310}00310       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00311}00311 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00312}00312       \textcolor{comment}{// Calculate activity coefficients for each species in the phase instance}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00313}00313       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++j) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00314}00314         \textcolor{comment}{// Mole fraction for species j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00315}00315         \textcolor{keywordtype}{double} x\_j = \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, j);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00316}00316 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00317}00317         \textcolor{comment}{// Phi\_j (Eq. 4)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00318}00318         \textcolor{keywordtype}{double} Phi\_j;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00319}00319         Phi\_j = \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{R\_I\_}}(i\_phase, j) * x\_j / sigma;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00320}00320 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00321}00321         \textcolor{comment}{// Theta\_j (Eq. 4)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00322}00322         \textcolor{keywordtype}{double} Theta\_j;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00323}00323         Theta\_j = \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, j) * x\_j / tau;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00324}00324 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00325}00325         \textcolor{comment}{// Calculate the combinatorial term ln(gamma\_i\string^C) Eq. 3}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00326}00326         \textcolor{keywordtype}{double} lngammaC\_j = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00327}00327         \textcolor{keywordflow}{if} (\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, j) > 0.0) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00328}00328           lngammaC\_j = log(Phi\_j / x\_j) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00329}00329                        5.0 * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, j) * log(Theta\_j / Phi\_j) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00330}00330                        \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ae785d2a9fe11700b737572da4bc84b14}{L\_I\_}}(i\_phase, j) -\/ Phi\_j / x\_j * mu;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00331}00331         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00332}00332 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00333}00333         \textcolor{comment}{// Full residual term}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00334}00334         \textcolor{keywordtype}{double} lngammaR\_j = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00335}00335         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++k) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00336}00336           lngammaR\_j += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, j, k) *}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00337}00337                         (\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(k) -\/ \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38e65393d48cdee41eefe73e2279e55a}{LN\_GAMMA\_IK\_}}(i\_phase, j, k));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00338}00338         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00339}00339 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00340}00340         \textcolor{comment}{// Calculate gamma\_i Eq. 1}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00341}00341         state[\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_instance) + \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa4a9078d99a1dbfa58de04936d652bce}{GAMMA\_ID\_}}(i\_phase, j)] =}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00342}00342             exp(lngammaC\_j + lngammaR\_j) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, j);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00343}00343       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00344}00344     \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00345}00345   \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00346}00346 \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00347}00347 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00348}00348 \textcolor{comment}{/** \(\backslash\)brief Add contributions to the Jacobian from derivates calculated using the}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00349}00349 \textcolor{comment}{ * output of this sub model}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00350}00350 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00351}00351 \textcolor{comment}{ * This derivation starts from equations (1)-\/-\/(9) in \(\backslash\)cite Marcolli2005.}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00352}00352 \textcolor{comment}{ * The mole fraction of species \(\backslash\)f\$i\(\backslash\)f\$ is calculated as:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00353}00353 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00354}00354 \textcolor{comment}{ *    x\_i = \(\backslash\)frac\{m\_i\}\{m\_T\},}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00355}00355 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00356}00356 \textcolor{comment}{ *  where \(\backslash\)f\$m\_T = \(\backslash\)displaystyle\(\backslash\)sum\_j m\_j\(\backslash\)f\$,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00357}00357 \textcolor{comment}{ *  \(\backslash\)f\$m\_i = \(\backslash\)frac\{c\_i\}\{\(\backslash\)mathrm\{MW\}\_i\}\(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00358}00358 \textcolor{comment}{ *  is the number in moles of species \(\backslash\)f\$i\(\backslash\)f\$,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00359}00359 \textcolor{comment}{ *  \(\backslash\)f\$c\_i\(\backslash\)f\$ is its mass concentration}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00360}00360 \textcolor{comment}{ *  (\(\backslash\)f\$\(\backslash\)mathrm\{ug\} \(\backslash\): \(\backslash\)mathrm\{m\}\string^\{-\/3\}\(\backslash\)f\$; the state variable), and}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00361}00361 \textcolor{comment}{ *  \(\backslash\)f\$\(\backslash\)mathrm\{MW\}\_i\(\backslash\)f\$ is its molecular weight}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00362}00362 \textcolor{comment}{ *  (\(\backslash\)f\$\(\backslash\)mathrm\{ug\} \(\backslash\): \(\backslash\)mathrm\{mol\}\string^\{-\/1\}\(\backslash\)f\$). Thus,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00363}00363 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00364}00364 \textcolor{comment}{ *   \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00365}00365 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial x\_i\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00366}00366 \textcolor{comment}{ *       \(\backslash\)frac\{(m\_T-\/m\_i)\}\{\(\backslash\)mathrm\{MW\}\_i m\_T\string^2\}, \(\backslash\)textrm\{ and\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00367}00367 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial x\_j\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00368}00368 \textcolor{comment}{ *       -\/\(\backslash\)frac\{m\_j\}\{\(\backslash\)mathrm\{MW\}\_i m\_T\string^2\} \(\backslash\)quad \(\backslash\)text\{for \} i\(\backslash\)neq j. \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00369}00369 \textcolor{comment}{ *   \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00370}00370 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00371}00371 \textcolor{comment}{ *  The partial derivative of \(\backslash\)f\$\(\backslash\)Phi\_j\(\backslash\)f\$ (Eq. 4) with respect to \(\backslash\)f\$c\_i\(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00372}00372 \textcolor{comment}{ *  is derived as follows:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00373}00373 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00374}00374 \textcolor{comment}{ *   \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00375}00375 \textcolor{comment}{ *     \(\backslash\)frac\{\(\backslash\)partial r\_i x\_i\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00376}00376 \textcolor{comment}{ *        r\_i \(\backslash\)frac\{(m\_T-\/m\_i)\}\{\(\backslash\)mathrm\{MW\}\_i m\_T\string^2\}, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00377}00377 \textcolor{comment}{ *     \(\backslash\)frac\{\(\backslash\)partial r\_j x\_j\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00378}00378 \textcolor{comment}{ *        -\/ r\_j \(\backslash\)frac\{m\_j\}\{\(\backslash\)mathrm\{MW\}\_i m\_T\string^2\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00379}00379 \textcolor{comment}{ *        \(\backslash\)quad \(\backslash\)text\{for \} i\(\backslash\)neq j, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00380}00380 \textcolor{comment}{ *     \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)displaystyle\(\backslash\)sum\_j r\_j x\_j\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00381}00381 \textcolor{comment}{ *        \(\backslash\)frac\{1\}\{\(\backslash\)mathrm\{MW\}\_i m\_T\}\(\backslash\)left[r\_i -\/}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00382}00382 \textcolor{comment}{ *        \(\backslash\)displaystyle\(\backslash\)sum\_j r\_j x\_j\(\backslash\)right], \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00383}00383 \textcolor{comment}{ *     \(\backslash\)sigma \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_k r\_k x\_k, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00384}00384 \textcolor{comment}{ *     \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Phi\_j\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00385}00385 \textcolor{comment}{ *     \(\backslash\)frac\{r\_j\}\{\(\backslash\)mathrm\{MW\}\_i m\_T \(\backslash\)sigma\string^2\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00386}00386 \textcolor{comment}{ *     \(\backslash\)left(\(\backslash\)sigma\string^\{\(\backslash\)prime\} -\/ x\_j r\_i \(\backslash\)right)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00387}00387 \textcolor{comment}{ *     , \(\backslash\)qquad}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00388}00388 \textcolor{comment}{ *         \(\backslash\)sigma\string^\{\(\backslash\)prime\} =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00389}00389 \textcolor{comment}{ *         \(\backslash\)begin\{cases\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00390}00390 \textcolor{comment}{ *           \(\backslash\)sigma  \& \(\backslash\)quad \(\backslash\)text\{if \} i=j \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00391}00391 \textcolor{comment}{ *           0    \& \(\backslash\)quad \(\backslash\)text\{if \} i\(\backslash\)neq j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00392}00392 \textcolor{comment}{ *         \(\backslash\)end\{cases\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00393}00393 \textcolor{comment}{ *   \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00394}00394 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00395}00395 \textcolor{comment}{ *  Similarly, the partial derivative of \(\backslash\)f\$\(\backslash\)Theta\_j\(\backslash\)f\$ (Eq. 4) with respect}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00396}00396 \textcolor{comment}{ *  to \(\backslash\)f\$c\_i\(\backslash\)f\$ is:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00397}00397 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00398}00398 \textcolor{comment}{ * \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00399}00399 \textcolor{comment}{ *    \(\backslash\)tau \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_k q\_k x\_k, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00400}00400 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Theta\_j\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00401}00401 \textcolor{comment}{ *     \(\backslash\)frac\{q\_j\}\{\(\backslash\)mathrm\{MW\}\_i m\_T \(\backslash\)tau\string^2\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00402}00402 \textcolor{comment}{ *     \(\backslash\)left(\(\backslash\)tau\string^\{\(\backslash\)prime\} -\/ x\_j q\_i \(\backslash\)right)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00403}00403 \textcolor{comment}{ *     , \(\backslash\)qquad}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00404}00404 \textcolor{comment}{ *         \(\backslash\)tau\string^\{\(\backslash\)prime\} =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00405}00405 \textcolor{comment}{ *         \(\backslash\)begin\{cases\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00406}00406 \textcolor{comment}{ *           \(\backslash\)tau  \& \(\backslash\)quad \(\backslash\)text\{if \} i=j \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00407}00407 \textcolor{comment}{ *           0    \& \(\backslash\)quad \(\backslash\)text\{if \} i\(\backslash\)neq j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00408}00408 \textcolor{comment}{ *         \(\backslash\)end\{cases\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00409}00409 \textcolor{comment}{ * \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00410}00410 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00411}00411 \textcolor{comment}{ *  From Eqs 5 and 6,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00412}00412 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00413}00413 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial r\_j\}\{\(\backslash\)partial c\_i\} =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00414}00414 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial q\_j\}\{\(\backslash\)partial c\_i\} =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00415}00415 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial l\_j\}\{\(\backslash\)partial c\_i\} = 0.}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00416}00416 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00417}00417 \textcolor{comment}{ *  For the last term in Eq. 3,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00418}00418 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00419}00419 \textcolor{comment}{ * \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00420}00420 \textcolor{comment}{ *    \(\backslash\)mu \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_j x\_j l\_j, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00421}00421 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)mu\}\{\(\backslash\)partial c\_i\} \& = \(\backslash\)frac\{1\}\{\(\backslash\)mathrm\{MW\}\_i m\_T\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00422}00422 \textcolor{comment}{ *        \(\backslash\)left( l\_i -\/ \(\backslash\)mu \(\backslash\)right). \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00423}00423 \textcolor{comment}{ * \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00424}00424 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00425}00425 \textcolor{comment}{ *  The partial derivative of the full combinatorial term (Eq. 3) is:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00426}00426 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00427}00427 \textcolor{comment}{ * \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00428}00428 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)ln\{\(\backslash\)gamma\string^C\_j\}\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00429}00429 \textcolor{comment}{ *        \(\backslash\)frac\{x\_j\}\{\(\backslash\)Phi\_j\}\(\backslash\)frac\{\(\backslash\)left( \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Phi\_j\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00430}00430 \textcolor{comment}{ *            x\_j -\/ \(\backslash\)Phi\_j\(\backslash\)frac\{\(\backslash\)partial x\_j\}\{\(\backslash\)partial c\_i\} \(\backslash\)right)\}\{x\_j\string^2\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00431}00431 \textcolor{comment}{ *      \& \(\backslash\)quad + \(\backslash\)frac\{z\}\{2\}q\_j\(\backslash\)frac\{\(\backslash\)Phi\_j\}\{\(\backslash\)Theta\_j\}\(\backslash\)frac\{\(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00432}00432 \textcolor{comment}{ *            \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Theta\_j\}\{\(\backslash\)partial c\_i\} \(\backslash\)Phi\_j -\/}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00433}00433 \textcolor{comment}{ *            \(\backslash\)Theta\_j\(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Phi\_j\}\{\(\backslash\)partial c\_i\}\(\backslash\)right)\}\{\(\backslash\)Phi\_j\string^2\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00434}00434 \textcolor{comment}{ *      \& \(\backslash\)quad -\/ \(\backslash\)frac\{\(\backslash\)left[ \(\backslash\)left( \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Phi\_j\}\{\(\backslash\)partial c\_i\} \(\backslash\)mu +}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00435}00435 \textcolor{comment}{ *             \(\backslash\)Phi\_j \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)mu\}\{\(\backslash\)partial c\_i\} \(\backslash\)right) x\_j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00436}00436 \textcolor{comment}{ *             -\/ \(\backslash\)Phi\_j \(\backslash\)mu \(\backslash\)frac\{\(\backslash\)partial x\_j\}\{\(\backslash\)partial c\_i\} \(\backslash\)right]\}\{x\_j\string^2\}.}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00437}00437 \textcolor{comment}{ * \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00438}00438 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00439}00439 \textcolor{comment}{ *  After some rearranging, this becomes:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00440}00440 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00441}00441 \textcolor{comment}{ * \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00442}00442 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)ln\{\(\backslash\)gamma\string^C\_j\}\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00443}00443 \textcolor{comment}{ *        \(\backslash\)frac\{1\}\{\(\backslash\)Phi\_j\}\(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Phi\_j\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00444}00444 \textcolor{comment}{ *        -\/ \(\backslash\)frac\{1\}\{x\_j\}\(\backslash\)frac\{\(\backslash\)partial x\_j\}\{\(\backslash\)partial c\_i\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00445}00445 \textcolor{comment}{ *      \& \(\backslash\)quad + \(\backslash\)frac\{z\}\{2\}q\_j\(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00446}00446 \textcolor{comment}{ *        \(\backslash\)frac\{1\}\{\(\backslash\)Theta\_j\}\(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Theta\_j\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00447}00447 \textcolor{comment}{ *        -\/ \(\backslash\)frac\{1\}\{\(\backslash\)Phi\_j\}\(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Phi\_j\}\{\(\backslash\)partial c\_i\}\(\backslash\)right) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00448}00448 \textcolor{comment}{ *      \& \(\backslash\)quad -\/ \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Phi\_j\}\{\(\backslash\)partial c\_i\}\(\backslash\)frac\{\(\backslash\)mu\}\{x\_j\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00449}00449 \textcolor{comment}{ *      -\/ \(\backslash\)frac\{\(\backslash\)Phi\_j\}\{x\_j\}\(\backslash\)frac\{\(\backslash\)partial \(\backslash\)mu\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00450}00450 \textcolor{comment}{ *      + \(\backslash\)frac\{\(\backslash\)Phi\_j \(\backslash\)mu\}\{x\_j\string^2\}\(\backslash\)frac\{\(\backslash\)partial x\_j\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00451}00451 \textcolor{comment}{ * \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00452}00452 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00453}00453 \textcolor{comment}{ *  As \(\backslash\)f\$\(\backslash\)sigma\(\backslash\)f\$, \(\backslash\)f\$\(\backslash\)tau\(\backslash\)f\$,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00454}00454 \textcolor{comment}{ *  and \(\backslash\)f\$\(\backslash\)mu\(\backslash\)f\$ are independent of species \(\backslash\)f\$i\(\backslash\)f\$,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00455}00455 \textcolor{comment}{ *  these can be calculated outside the loop over the independent species.}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00456}00456 \textcolor{comment}{ *  Moving to the residual term (Eq. 7), the mole fraction (\(\backslash\)f\$X\_p\(\backslash\)f\$)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00457}00457 \textcolor{comment}{ *  of group \(\backslash\)f\$p\(\backslash\)f\$ in the mixture is related to the mole fraction}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00458}00458 \textcolor{comment}{ *  (\(\backslash\)f\$x\_j\(\backslash\)f\$) of species \(\backslash\)f\$j\(\backslash\)f\$ according to:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00459}00459 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00460}00460 \textcolor{comment}{ *    X\_p = c\_\{xX\} \(\backslash\)omega\_p, \(\backslash\)textrm\{ where \}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00461}00461 \textcolor{comment}{ *    \(\backslash\)omega\_p \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_j v\_p\string^\{(j)\} x\_j, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00462}00462 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00463}00463 \textcolor{comment}{ *  and \(\backslash\)f\$c\_\{xX\}\(\backslash\)f\$ is a conversion factor accounting for the difference}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00464}00464 \textcolor{comment}{ *  in total species and total group number concentrations:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00465}00465 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00466}00466 \textcolor{comment}{ *    c\_\{xX\} = \(\backslash\)frac\{1\}\{\(\backslash\)displaystyle\(\backslash\)sum\_p \(\backslash\)omega\_p\}.}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00467}00467 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00468}00468 \textcolor{comment}{ *  Partial derivatives of the group interaction terms in Eq 9,}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00469}00469 \textcolor{comment}{ *  \(\backslash\)f\$\(\backslash\)Theta\_m\(\backslash\)f\$ and \(\backslash\)f\$\(\backslash\)Psi\_\{mn\}\(\backslash\)f\$, with respect to \(\backslash\)f\$c\_i\(\backslash\)f\$ are}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00470}00470 \textcolor{comment}{ *  derived as follows:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00471}00471 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00472}00472 \textcolor{comment}{ *   \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00473}00473 \textcolor{comment}{ *     \(\backslash\)frac\{\(\backslash\)partial c\_\{xX\}\}\{\(\backslash\)partial c\_i\} \& = -\/ c\_\{xX\}\string^2}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00474}00474 \textcolor{comment}{ *       \(\backslash\)displaystyle\(\backslash\)sum\_p \(\backslash\)displaystyle\(\backslash\)sum\_j v\_p\string^\{(j)\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00475}00475 \textcolor{comment}{ *       \(\backslash\)frac\{\(\backslash\)partial x\_j\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00476}00476 \textcolor{comment}{ *       = -\/ \(\backslash\)frac\{c\_\{xX\}\string^2\}\{\(\backslash\)mathrm\{MW\}\_im\_T\} \(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00477}00477 \textcolor{comment}{ *             \(\backslash\)displaystyle\(\backslash\)sum\_p v\_p\string^\{(i)\} -\/}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00478}00478 \textcolor{comment}{ *             \(\backslash\)displaystyle\(\backslash\)sum\_p \(\backslash\)omega\_p \(\backslash\)right), \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00479}00479 \textcolor{comment}{ *       \& = \(\backslash\)frac\{c\_\{xX\}\}\{\(\backslash\)mathrm\{MW\}\_im\_T\} \(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00480}00480 \textcolor{comment}{ *               1 -\/ c\_\{xX\} \(\backslash\)displaystyle\(\backslash\)sum\_p v\_p\string^\{(i)\} \(\backslash\)right), \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00481}00481 \textcolor{comment}{ *     \(\backslash\)frac\{\(\backslash\)partial X\_n\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00482}00482 \textcolor{comment}{ *       c\_\{xX\} \(\backslash\)displaystyle\(\backslash\)sum\_j v\_n\string^\{(j)\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00483}00483 \textcolor{comment}{ *            \(\backslash\)frac\{\(\backslash\)partial x\_j\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00484}00484 \textcolor{comment}{ *       + \(\backslash\)frac\{\(\backslash\)partial c\_\{xX\}\}\{\(\backslash\)partial c\_i\} \(\backslash\)omega\_n, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00485}00485 \textcolor{comment}{ *       \& = \(\backslash\)frac\{c\_\{xX\}\}\{\(\backslash\)mathrm\{MW\}\_im\_T\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00486}00486 \textcolor{comment}{ *                  \(\backslash\)left( v\_n\string^\{(i)\} -\/ \(\backslash\)omega\_n \(\backslash\)right)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00487}00487 \textcolor{comment}{ *             + \(\backslash\)frac\{c\_\{xX\}\}\{\(\backslash\)mathrm\{MW\}\_im\_T\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00488}00488 \textcolor{comment}{ *                  \(\backslash\)left( \(\backslash\)omega\_n -\/ c\_\{xX\}\(\backslash\)omega\_n}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00489}00489 \textcolor{comment}{ *                      \(\backslash\)displaystyle\(\backslash\)sum\_p v\_p\string^\{(i)\} \(\backslash\)right), \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00490}00490 \textcolor{comment}{ *        \& = \(\backslash\)frac\{c\_\{xX\}\}\{\(\backslash\)mathrm\{MW\}\_im\_T\} \(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00491}00491 \textcolor{comment}{ *                  v\_n\string^\{(i)\} -\/ X\_n}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00492}00492 \textcolor{comment}{ *                      \(\backslash\)displaystyle\(\backslash\)sum\_p v\_p\string^\{(i)\} \(\backslash\)right), \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00493}00493 \textcolor{comment}{ *     \(\backslash\)Pi \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_n Q\_n X\_n, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00494}00494 \textcolor{comment}{ *     \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Pi\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00495}00495 \textcolor{comment}{ *        \(\backslash\)displaystyle\(\backslash\)sum\_n Q\_n}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00496}00496 \textcolor{comment}{ *        \(\backslash\)frac\{c\_\{xX\}\}\{\(\backslash\)mathrm\{MW\}\_i m\_T\}\(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00497}00497 \textcolor{comment}{ *            v\_n\string^\{(i)\} -\/ X\_n \(\backslash\)displaystyle\(\backslash\)sum\_p v\_p\string^\{(i)\} \(\backslash\)right), \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00498}00498 \textcolor{comment}{ *     \& = \(\backslash\)frac\{c\_\{xX\}\}\{\(\backslash\)mathrm\{MW\}\_i m\_T\} \(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00499}00499 \textcolor{comment}{ *            \(\backslash\)displaystyle\(\backslash\)sum\_n Q\_n v\_n\string^\{(i)\} -\/}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00500}00500 \textcolor{comment}{ *            \(\backslash\)Pi \(\backslash\)displaystyle\(\backslash\)sum\_p v\_p\string^\{(i)\} \(\backslash\)right), \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00501}00501 \textcolor{comment}{ *     \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Theta\_m\}\{\(\backslash\)partial c\_i\} \& = \(\backslash\)frac\{}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00502}00502 \textcolor{comment}{ *     \(\backslash\)left(Q\_m\(\backslash\)frac\{\(\backslash\)partial X\_m\}\{\(\backslash\)partial c\_i\} \(\backslash\)Pi -\/}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00503}00503 \textcolor{comment}{ *         Q\_m X\_m \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Pi\}\{\(\backslash\)partial c\_i\} \(\backslash\)right)\}\{\(\backslash\)Pi\string^2\} , \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00504}00504 \textcolor{comment}{ *     \& = \(\backslash\)frac\{c\_\{xX\} Q\_m\}\{\(\backslash\)mathrm\{MW\}\_im\_T\(\backslash\)Pi\string^2\} \(\backslash\)left[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00505}00505 \textcolor{comment}{ *              \(\backslash\)left( \(\backslash\)Pi v\_m\string^\{(i)\} -\/ \(\backslash\)Pi X\_m}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00506}00506 \textcolor{comment}{ *                  \(\backslash\)displaystyle\(\backslash\)sum\_p v\_p\string^\{(i)\} \(\backslash\)right) -\/}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00507}00507 \textcolor{comment}{ *              \(\backslash\)left( X\_m \(\backslash\)displaystyle\(\backslash\)sum\_n Q\_n v\_n\string^\{(i)\} -\/}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00508}00508 \textcolor{comment}{ *                  X\_m \(\backslash\)Pi \(\backslash\)displaystyle\(\backslash\)sum\_p v\_p\string^\{(i)\} \(\backslash\)right) \(\backslash\)right], \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00509}00509 \textcolor{comment}{ *     \& = \(\backslash\)frac\{c\_\{xX\} Q\_m\}\{\(\backslash\)mathrm\{MW\}\_im\_T\(\backslash\)Pi\string^2\} \(\backslash\)left[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00510}00510 \textcolor{comment}{ *            \(\backslash\)Pi v\_m\string^\{(i)\} -\/ X\_m\(\backslash\)displaystyle\(\backslash\)sum\_n Q\_n v\_n\string^\{(i)\}\(\backslash\)right],}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00511}00511 \textcolor{comment}{ *        \(\backslash\)textrm\{ and\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00512}00512 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)Psi\_\{mn\}\}\{\(\backslash\)partial c\_i\} \& = 0}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00513}00513 \textcolor{comment}{ *   \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00514}00514 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00515}00515 \textcolor{comment}{ *  The partial derivative of the group residual activity coefficient (Eq. 8)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00516}00516 \textcolor{comment}{ *  with respect to \(\backslash\)f\$c\_i\(\backslash\)f\$ is:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00517}00517 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00518}00518 \textcolor{comment}{ *   \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00519}00519 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)ln\{\(\backslash\)Gamma\_k\}\}\{\(\backslash\)partial c\_i\} \& = Q\_k \(\backslash\)left[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00520}00520 \textcolor{comment}{ *      -\/ \(\backslash\)frac\{1\}\{\(\backslash\)displaystyle\(\backslash\)sum\_m\(\backslash\)Theta\_m\(\backslash\)Psi\_\{mk\}\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00521}00521 \textcolor{comment}{ *        \(\backslash\)displaystyle\(\backslash\)sum\_m\(\backslash\)frac\{\(\backslash\)partial\(\backslash\)Theta\_m\}\{\(\backslash\)partial c\_i\}\(\backslash\)Psi\_\{mk\} \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00522}00522 \textcolor{comment}{ *      \(\backslash\)quad -\/ \(\backslash\)displaystyle\(\backslash\)sum\_m\(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00523}00523 \textcolor{comment}{ *        \(\backslash\)frac\{\(\backslash\)partial\(\backslash\)Theta\_m\}\{\(\backslash\)partial c\_i\}\(\backslash\)Psi\_\{km\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00524}00524 \textcolor{comment}{ *          \(\backslash\)displaystyle\(\backslash\)sum\_n\(\backslash\)Theta\_n\(\backslash\)Psi\_\{nm\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00525}00525 \textcolor{comment}{ *      -\/ \(\backslash\)Theta\_m\(\backslash\)Psi\_\{km\}\(\backslash\)displaystyle\(\backslash\)sum\_n}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00526}00526 \textcolor{comment}{ *          \(\backslash\)frac\{\(\backslash\)partial\(\backslash\)Theta\_n\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00527}00527 \textcolor{comment}{ *          \(\backslash\)Psi\_\{nm\}\(\backslash\)right)/\(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00528}00528 \textcolor{comment}{ *            \(\backslash\)displaystyle\(\backslash\)sum\_n\(\backslash\)Theta\_n\(\backslash\)Psi\_\{nm\}\(\backslash\)right)\string^2}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00529}00529 \textcolor{comment}{ *      \(\backslash\)right]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00530}00530 \textcolor{comment}{ *   \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00531}00531 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00532}00532 \textcolor{comment}{ *  After some rearranging, this becomes:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00533}00533 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00534}00534 \textcolor{comment}{ *   \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00535}00535 \textcolor{comment}{ *    \(\backslash\)Xi\_m \& \(\backslash\)equiv \(\backslash\)displaystyle\(\backslash\)sum\_n\(\backslash\)Theta\_n\(\backslash\)Psi\_\{nm\}, \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00536}00536 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)ln\{\(\backslash\)Gamma\_k\}\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00537}00537 \textcolor{comment}{ *      -\/ Q\_k \(\backslash\)displaystyle\(\backslash\)sum\_m \(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00538}00538 \textcolor{comment}{ *      \(\backslash\)frac\{\(\backslash\)Psi\_\{mk\}\}\{\(\backslash\)Xi\_k\}\(\backslash\)frac\{\(\backslash\)partial\(\backslash\)Theta\_m\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00539}00539 \textcolor{comment}{ *      + \(\backslash\)frac\{\(\backslash\)Psi\_\{km\}\}\{\(\backslash\)Xi\_m\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00540}00540 \textcolor{comment}{ *        \(\backslash\)frac\{\(\backslash\)partial\(\backslash\)Theta\_m\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00541}00541 \textcolor{comment}{ *      -\/ \(\backslash\)frac\{\(\backslash\)Theta\_m\(\backslash\)Psi\_\{km\}\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00542}00542 \textcolor{comment}{ *             \{\(\backslash\)Xi\_m\string^2\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00543}00543 \textcolor{comment}{ *        \(\backslash\)displaystyle\(\backslash\)sum\_n\(\backslash\)frac\{\(\backslash\)partial\(\backslash\)Theta\_n\}\{\(\backslash\)partial c\_i\}\(\backslash\)Psi\_\{nm\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00544}00544 \textcolor{comment}{ *    \(\backslash\)right)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00545}00545 \textcolor{comment}{ *   \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00546}00546 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00547}00547 \textcolor{comment}{ *  The left side of the three bracketed terms in the above equation are}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00548}00548 \textcolor{comment}{ *  independent of species \(\backslash\)f\$i\(\backslash\)f\$ and can be calculated outside of the loop}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00549}00549 \textcolor{comment}{ *  over the independent species. The partial derivative of the full residual}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00550}00550 \textcolor{comment}{ *  term with respect to \(\backslash\)f\$c\_i\(\backslash\)f\$ is:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00551}00551 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00552}00552 \textcolor{comment}{ *   \(\backslash\)begin\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00553}00553 \textcolor{comment}{ *   \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)ln\{\(\backslash\)Gamma\_k\string^\{(j)\}\}\}\{\(\backslash\)partial c\_i\} \& = 0 \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00554}00554 \textcolor{comment}{ *   \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)ln\{\(\backslash\)gamma\_j\string^R\}\}\{\(\backslash\)partial c\_i\} \& =}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00555}00555 \textcolor{comment}{ *     \(\backslash\)displaystyle\(\backslash\)sum\_k v\_k\string^\{(j)\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00556}00556 \textcolor{comment}{ *        \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)ln\{\(\backslash\)Gamma\_k\}\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00557}00557 \textcolor{comment}{ *   \(\backslash\)end\{align*\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00558}00558 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00559}00559 \textcolor{comment}{ *  The overall equation for the partial derivative of \(\backslash\)f\$\(\backslash\)gamma\_j\(\backslash\)f\$ with}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00560}00560 \textcolor{comment}{ *  respect to species \(\backslash\)f\$i\(\backslash\)f\$ is:}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00561}00561 \textcolor{comment}{ * \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00562}00562 \textcolor{comment}{ *    \(\backslash\)frac\{\(\backslash\)partial\(\backslash\)gamma\_j\}\{\(\backslash\)partial c\_i\} = \(\backslash\)gamma\_j \(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00563}00563 \textcolor{comment}{ *      \(\backslash\)frac\{\(\backslash\)partial\(\backslash\)ln\{\(\backslash\)gamma\_j\string^C\}\}\{\(\backslash\)partial c\_i\}}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00564}00564 \textcolor{comment}{ *      + \(\backslash\)frac\{\(\backslash\)partial\(\backslash\)ln\{\(\backslash\)gamma\_j\string^R\}\}\{\(\backslash\)partial c\_i\} \(\backslash\)right)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00565}00565 \textcolor{comment}{ * \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00566}00566 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00567}00567 \textcolor{comment}{ * \(\backslash\)param sub\_model\_int\_data Pointer to the sub model integer data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00568}00568 \textcolor{comment}{ * \(\backslash\)param sub\_model\_float\_data Pointer to the sub model floating-\/point data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00569}00569 \textcolor{comment}{ * \(\backslash\)param sub\_model\_env\_data Pointer to the sub model environment-\/dependent data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00570}00570 \textcolor{comment}{ * \(\backslash\)param model\_data Pointer to the model data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00571}00571 \textcolor{comment}{ * \(\backslash\)param J Jacobian to be calculated}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00572}00572 \textcolor{comment}{ * \(\backslash\)param time\_step Current time step [s]}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00573}00573 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00574}00574 \textcolor{preprocessor}{\#ifdef CAMP\_USE\_SUNDIALS}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00575}\mbox{\hyperlink{sub__models_8h_a0301d06b09af90fcfe49f9a1ba7c6742}{00575}} \textcolor{keywordtype}{void} \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a0301d06b09af90fcfe49f9a1ba7c6742}{sub\_model\_UNIFAC\_get\_jac\_contrib}}(\textcolor{keywordtype}{int} *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00576}00576                                       \textcolor{keywordtype}{double} *sub\_model\_float\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00577}00577                                       \textcolor{keywordtype}{double} *sub\_model\_env\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00578}00578                                       \mbox{\hyperlink{struct_model_data}{ModelData}} *model\_data, realtype *J,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00579}00579                                       \textcolor{keywordtype}{double} time\_step) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00580}00580   \textcolor{keywordtype}{int} *int\_data = sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00581}00581   \textcolor{keywordtype}{double} *float\_data = sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00582}00582   \textcolor{keywordtype}{double} *state = model\_data-\/>\mbox{\hyperlink{struct_model_data_a97655058cfc0116225582920128111ef}{grid\_cell\_state}};}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00583}00583   \textcolor{keywordtype}{double} *env\_data = model\_data-\/>\mbox{\hyperlink{struct_model_data_a847bd594a8e88da48104655fdc8524d7}{grid\_cell\_env}};}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00584}00584 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00585}00585   \textcolor{comment}{// Loop through each instance of each phase to calculate activity}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00586}00586   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_phase = 0; i\_phase < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa97428673e94e122eea2cf55bdc0e8d3}{NUM\_UNIQUE\_PHASE\_}}; ++i\_phase) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00587}00587     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_instance = 0; i\_instance < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a96afb96b89157441704719c55a19fd76}{NUM\_PHASE\_INSTANCE\_}}(i\_phase);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00588}00588          ++i\_instance) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00589}00589       \textcolor{comment}{// Get the total number of moles of species in this phase instance}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00590}00590       \textcolor{comment}{// (in umoles)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00591}00591       \textcolor{keywordtype}{double} m\_T = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00592}00592       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00593}00593         m\_T += state[\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_instance) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00594}00594                      \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{SPEC\_ID\_}}(i\_phase, i\_spec)] /}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00595}00595                \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a1f5c2d7f5d00731ad2b59dafd08f8b26}{MW\_I\_}}(i\_phase, i\_spec);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00596}00596       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00597}00597 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00598}00598       \textcolor{comment}{// If there are no species present, skip the calculations}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00599}00599       \textcolor{keywordflow}{if} (m\_T <= 0.0) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00600}00600         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00601}00601       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00602}00602 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00603}00603       \textcolor{comment}{// Pre-\/calculate mole fractions and variables that do not depend on}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00604}00604       \textcolor{comment}{// dependent species j or independent species i}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00605}00605 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00606}00606       \textcolor{keywordtype}{double} sigma = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00607}00607       \textcolor{keywordtype}{double} tau = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00608}00608       \textcolor{keywordtype}{double} mu = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00609}00609       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00610}00610         \textcolor{comment}{// Mole fractions x\_i for this phase instance}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00611}00611         \textcolor{keywordtype}{double} x\_i = state[\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_instance) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00612}00612                            \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{SPEC\_ID\_}}(i\_phase, i\_spec)] /}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00613}00613                      \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a1f5c2d7f5d00731ad2b59dafd08f8b26}{MW\_I\_}}(i\_phase, i\_spec) / m\_T;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00614}00614         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, i\_spec) = x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00615}00615 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00616}00616         \textcolor{comment}{// Combinatorial variables}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00617}00617         sigma += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{R\_I\_}}(i\_phase, i\_spec) * x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00618}00618         tau += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, i\_spec) * x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00619}00619         mu += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ae785d2a9fe11700b737572da4bc84b14}{L\_I\_}}(i\_phase, i\_spec) * x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00620}00620       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00621}00621 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00622}00622       \textcolor{comment}{// Residual variables}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00623}00623       \textcolor{keywordtype}{double} c\_xX = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00624}00624       \textcolor{keywordtype}{double} Pi = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00625}00625       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00626}00626         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group) = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00627}00627         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00628}00628           \textcolor{keywordtype}{double} v\_ik\_x\_i =}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00629}00629               \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, i\_spec, i\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, i\_spec);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00630}00630           c\_xX += v\_ik\_x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00631}00631           \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group) += v\_ik\_x\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00632}00632         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00633}00633       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00634}00634       c\_xX = 1.0 / c\_xX;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00635}00635       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00636}00636         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group) *= c\_xX;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00637}00637         Pi += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(i\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00638}00638       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00639}00639 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00640}00640       \textcolor{comment}{// Group surface area fractions Theta\_m (Eq. 9)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00641}00641       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00642}00642         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(i\_group) = \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(i\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group) / Pi;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00643}00643 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00644}00644       \textcolor{comment}{// Xi\_m}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00645}00645       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00646}00646         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(i\_group) = 0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00647}00647         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j\_group = 0; j\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++j\_group)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00648}00648           \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(i\_group) += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(j\_group) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(j\_group, i\_group);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00649}00649       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00650}00650 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00651}00651       \textcolor{comment}{// Group residual activity coefficients ln(Gamma\_k) (Eq. 8)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00652}00652       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++k) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00653}00653         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(k) = 1.0 -\/ log(\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(k));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00654}00654         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} m = 0; m < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++m)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00655}00655           \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(k) -\/= \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(m) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(k, m) / \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(m);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00656}00656         \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(k) *= \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(k);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00657}00657       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00658}00658 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00659}00659       \textcolor{comment}{// Loop over dependent species j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00660}00660       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++j) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00661}00661         \textcolor{comment}{// Mole fraction for species j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00662}00662         \textcolor{keywordtype}{double} x\_j = \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, j);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00663}00663 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00664}00664         \textcolor{comment}{// Phi\_j (Eq. 4)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00665}00665         \textcolor{keywordtype}{double} Phi\_j;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00666}00666         Phi\_j = \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{R\_I\_}}(i\_phase, j) * x\_j / sigma;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00667}00667 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00668}00668         \textcolor{comment}{// Theta\_j (Eq. 4)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00669}00669         \textcolor{keywordtype}{double} Theta\_j;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00670}00670         Theta\_j = \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, j) * x\_j / tau;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00671}00671 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00672}00672         \textcolor{comment}{// Full combinatorial term}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00673}00673         \textcolor{keywordtype}{double} lngammaC\_j = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00674}00674         \textcolor{keywordflow}{if} (\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, j) > 0.0) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00675}00675           lngammaC\_j = log(Phi\_j / x\_j) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00676}00676                        5.0 * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, j) * log(Theta\_j / Phi\_j) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00677}00677                        \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ae785d2a9fe11700b737572da4bc84b14}{L\_I\_}}(i\_phase, j) -\/ Phi\_j / x\_j * mu;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00678}00678         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00679}00679 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00680}00680         \textcolor{comment}{// Full residual term}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00681}00681         \textcolor{keywordtype}{double} lngammaR\_j = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00682}00682         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++k) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00683}00683           lngammaR\_j += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, j, k) *}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00684}00684                         (\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(k) -\/ \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38e65393d48cdee41eefe73e2279e55a}{LN\_GAMMA\_IK\_}}(i\_phase, j, k));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00685}00685         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00686}00686 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00687}00687         \textcolor{comment}{// Activity coefficient gamma\_j (in m3/ug)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00688}00688         \textcolor{keywordtype}{double} gamma\_j = exp(lngammaC\_j + lngammaR\_j);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00690}00690         \textcolor{comment}{// Loop over independent species i}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00691}00691         \textcolor{keywordtype}{double} dx\_j\_dc\_i, dPhi\_j\_dc\_i, dTheta\_j\_dc\_i;  \textcolor{comment}{// combinatorial}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00692}00692         \textcolor{keywordtype}{double} dmu\_dc\_i, dlngammaC\_j\_dc\_i;             \textcolor{comment}{//   terms}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00693}00693         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00694}00694           \textcolor{comment}{// combinatorial partial derivatives}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00695}00695           \textcolor{keywordflow}{if} (i == j) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00696}00696             dx\_j\_dc\_i = 1.0 -\/ x\_j;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00697}00697             dPhi\_j\_dc\_i = sigma -\/ x\_j * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{R\_I\_}}(i\_phase, i);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00698}00698             dTheta\_j\_dc\_i = tau -\/ x\_j * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, i);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00699}00699           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00700}00700             dx\_j\_dc\_i = -\/x\_j;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00701}00701             dPhi\_j\_dc\_i = -\/x\_j * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{R\_I\_}}(i\_phase, i);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00702}00702             dTheta\_j\_dc\_i = -\/x\_j * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, i);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00703}00703           \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00704}00704           \textcolor{keywordtype}{double} MWimT\_inv = 1.0 / (\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a1f5c2d7f5d00731ad2b59dafd08f8b26}{MW\_I\_}}(i\_phase, i) * m\_T);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00705}00705           dx\_j\_dc\_i *= MWimT\_inv;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00706}00706           dPhi\_j\_dc\_i *= \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{R\_I\_}}(i\_phase, j) * MWimT\_inv / sigma / sigma;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00707}00707           dTheta\_j\_dc\_i *= \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, j) * MWimT\_inv / tau / tau;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00708}00708 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00709}00709           dmu\_dc\_i = MWimT\_inv * (\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ae785d2a9fe11700b737572da4bc84b14}{L\_I\_}}(i\_phase, i) -\/ mu);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00710}00710 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00711}00711           \textcolor{comment}{// partial derivative of full combinatorial term ln(gammaC\_j)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00712}00712           dlngammaC\_j\_dc\_i =}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00713}00713               dPhi\_j\_dc\_i / Phi\_j -\/ dx\_j\_dc\_i / x\_j +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00714}00714               5.0 * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, j) *}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00715}00715                   (dTheta\_j\_dc\_i / Theta\_j -\/ dPhi\_j\_dc\_i / Phi\_j) -\/}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00716}00716               dPhi\_j\_dc\_i * mu / x\_j -\/ Phi\_j / x\_j * dmu\_dc\_i +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00717}00717               Phi\_j * mu / x\_j / x\_j * dx\_j\_dc\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00718}00718 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00719}00719           \textcolor{comment}{// Residual partial derivatives}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00720}00720 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00721}00721           \textcolor{comment}{// partial derivative of group surface area fractions Theta\_m}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00722}00722           \textcolor{keywordtype}{double} sumQnvn\_i = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00723}00723           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n = 0; n < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++n)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00724}00724             sumQnvn\_i += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(n) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, i, n);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00725}00725           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} m = 0; m < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++m) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00726}00726             \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a55b754107c270c7b258232638bf7d394}{DTHETA\_M\_DC\_I\_}}(m) =}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00727}00727                 \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(m) * c\_xX * MWimT\_inv / Pi / Pi *}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00728}00728                 (Pi * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, i, m) -\/ \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(m) * sumQnvn\_i);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00729}00729           \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00730}00730 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00731}00731           \textcolor{comment}{// partial derivative of full residual terms ln(gammaR\_j)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00732}00732           \textcolor{keywordtype}{double} dlngammaR\_j\_dc\_i = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00733}00733           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++k) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00734}00734             \textcolor{comment}{// partial derivative of group residual activity coefficients}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00735}00735             \textcolor{comment}{// ln(Gamma\_k)}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00736}00736             \textcolor{keywordtype}{double} dlnGamma\_k\_dc\_i = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00737}00737             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} m = 0; m < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++m) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00738}00738               \textcolor{keywordtype}{double} sum\_n = 0.0;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00739}00739               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n = 0; n < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++n)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00740}00740                 sum\_n += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a55b754107c270c7b258232638bf7d394}{DTHETA\_M\_DC\_I\_}}(n) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(n, m);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00741}00741               dlnGamma\_k\_dc\_i +=}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00742}00742                   \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a55b754107c270c7b258232638bf7d394}{DTHETA\_M\_DC\_I\_}}(m) *}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00743}00743                       (\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(m, k) / \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(k) + \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(k, m) / \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(m)) -\/}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00744}00744                   \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a784850b02be0d6211e0118a9d3d16a9c}{THETA\_M\_}}(m) * \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac79faf34253439fe5e701f2ec3b03b8c}{PSI\_MN\_}}(k, m) / pow(\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(m), 2) * sum\_n;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00745}00745             \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00746}00746             dlnGamma\_k\_dc\_i *= -\/\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(k);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00747}00747 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00748}00748             dlngammaR\_j\_dc\_i += \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, j, k) * dlnGamma\_k\_dc\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00749}00749           \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00750}00750 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00751}00751           \textcolor{comment}{// partial derivative of activity coefficient gamma\_j}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00752}00752           \textcolor{keywordtype}{double} dgamma\_j\_dc\_i =}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00753}00753               gamma\_j * x\_j * (dlngammaC\_j\_dc\_i + dlngammaR\_j\_dc\_i) +}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00754}00754               gamma\_j * dx\_j\_dc\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00755}00755 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00756}00756           \textcolor{comment}{// Add the partial derivative contribution to the}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00757}00757           \textcolor{comment}{// Jacobian}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00758}00758           J[\mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad30fc663399a0c977685d511359e6f7a}{JAC\_ID\_}}(i\_phase, i\_instance, j, i)] += dgamma\_j\_dc\_i;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00759}00759         \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00760}00760       \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00761}00761     \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00762}00762   \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00763}00763 \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00764}00764 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00765}00765 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00766}00766 \textcolor{comment}{/** \(\backslash\)brief Print the sub model data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00767}00767 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00768}00768 \textcolor{comment}{ * \(\backslash\)param sub\_model\_int\_data Pointer to the sub model integer data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00769}00769 \textcolor{comment}{ * \(\backslash\)param sub\_model\_float\_data Pointer to the sub model floating-\/point data}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00770}00770 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00771}\mbox{\hyperlink{sub__models_8h_ac47310b67585f52b71ff6aac1c603ba5}{00771}} \textcolor{keywordtype}{void} \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac47310b67585f52b71ff6aac1c603ba5}{sub\_model\_UNIFAC\_print}}(\textcolor{keywordtype}{int} *sub\_model\_int\_data,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00772}00772                             \textcolor{keywordtype}{double} *sub\_model\_float\_data) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00773}00773   \textcolor{keywordtype}{int} *int\_data = sub\_model\_int\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00774}00774   \textcolor{keywordtype}{double} *float\_data = sub\_model\_float\_data;}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00775}00775 }
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00776}00776   printf(\textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nUNIFAC sub model\(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00777}00777   printf(\textcolor{stringliteral}{"{}\(\backslash\)nint\_data"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00778}00778   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa0dffbf9b27f4705b9462d86376d1506}{INT\_DATA\_SIZE\_}}; i++) printf(\textcolor{stringliteral}{"{} \%d"{}}, int\_data[i]);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00779}00779   printf(\textcolor{stringliteral}{"{}\(\backslash\)nfloat\_data"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00780}00780   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a4c9e4c5f3ca6b19f4eb79ae59cc281eb}{FLOAT\_DATA\_SIZE\_}}; i++) printf(\textcolor{stringliteral}{"{} \%le"{}}, float\_data[i]);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00781}00781   printf(\textcolor{stringliteral}{"{}\(\backslash\)nNumber of unique phases \%d"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa97428673e94e122eea2cf55bdc0e8d3}{NUM\_UNIQUE\_PHASE\_}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00782}00782   printf(\textcolor{stringliteral}{"{}\(\backslash\)nNumber of UNIFAC groups \%d"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00783}00783   printf(\textcolor{stringliteral}{"{}\(\backslash\)n*** General group data ***"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00784}00784   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00785}00785     printf(\textcolor{stringliteral}{"{}\(\backslash\)nGroup \%d:"{}}, i\_group);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00786}00786     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  Q\_K: \%le R\_K: \%le X\_k: \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ab84695ff3bb6d0fc0423220bf68fcbc8}{Q\_K\_}}(i\_group), \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_abb8a6874bbc52c11b838e00ab5ebaa5e}{R\_K\_}}(i\_group),}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00787}00787            \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a11f518c4fa348d90c90a134ef758e178}{X\_K\_}}(i\_group));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00788}00788     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  Xi\_M: \%le ln(Gamma\_k): \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a58eb0df01fce1899886c4facd3626bd4}{XI\_M\_}}(i\_group),}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00789}00789            \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ac8a1e8e8621a611a828d65edc020a3bd}{LN\_GAMMA\_K\_}}(i\_group));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00790}00790     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  dTheta\_n / dc\_i): \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a55b754107c270c7b258232638bf7d394}{DTHETA\_M\_DC\_I\_}}(i\_group));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00791}00791     printf(\textcolor{stringliteral}{"{}\(\backslash\)n A\_MN (by group):"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00792}00792     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j\_group = 0; j\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++j\_group)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00793}00793       printf(\textcolor{stringliteral}{"{} \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad857d77cfc3f85ade1e96ba998454aa9}{A\_MN\_}}(i\_group, j\_group));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00794}00794   \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00795}00795   printf(\textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n*** Phase data ***"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00796}00796   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_phase = 0; i\_phase < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa97428673e94e122eea2cf55bdc0e8d3}{NUM\_UNIQUE\_PHASE\_}}; ++i\_phase) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00797}00797     printf(\textcolor{stringliteral}{"{}\(\backslash\)nPhase \%d:"{}}, i\_phase);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00798}00798     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  Number of instances: \%d"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a96afb96b89157441704719c55a19fd76}{NUM\_PHASE\_INSTANCE\_}}(i\_phase));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00799}00799     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  Number of species: \%d"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00800}00800     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  Species ids:"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00801}00801     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00802}00802       printf(\textcolor{stringliteral}{"{} \%d"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{SPEC\_ID\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00803}00803     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  ** Instance data **"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00804}00804     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_inst = 0; i\_inst < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a96afb96b89157441704719c55a19fd76}{NUM\_PHASE\_INSTANCE\_}}(i\_phase); ++i\_inst) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00805}00805       printf(\textcolor{stringliteral}{"{}\(\backslash\)n  Instance \%d:"{}}, i\_inst);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00806}00806       printf(\textcolor{stringliteral}{"{}\(\backslash\)n    State id: \%d"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_inst));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00807}00807       printf(\textcolor{stringliteral}{"{}\(\backslash\)n    Gamma ids:"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00808}00808       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_gamma = 0; i\_gamma < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_gamma)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00809}00809         printf(\textcolor{stringliteral}{"{} \%d"{}},}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00810}00810                \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_inst) + \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_aa4a9078d99a1dbfa58de04936d652bce}{GAMMA\_ID\_}}(i\_phase, i\_gamma));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00811}00811       printf(\textcolor{stringliteral}{"{}\(\backslash\)n    Species ids:"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00812}00812       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00813}00813         printf(\textcolor{stringliteral}{"{} \%d"{}},}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00814}00814                \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5d0bb63217866cb57183969e2d75b54d}{PHASE\_INST\_ID\_}}(i\_phase, i\_inst) + \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a3299a6a03f2fe000f07ddd544fd0ae5a}{SPEC\_ID\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00815}00815       printf(\textcolor{stringliteral}{"{}\(\backslash\)n    Jacobian ids:"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00816}00816       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_gamma = 0; i\_gamma < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_gamma)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00817}00817         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00818}00818           printf(\textcolor{stringliteral}{"{} J[\%d][\%d] =  \%d"{}}, i\_gamma, i\_spec,}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00819}00819                  \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad30fc663399a0c977685d511359e6f7a}{JAC\_ID\_}}(i\_phase, i\_inst, i\_gamma, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00820}00820     \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00821}00821     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  R\_I (by species):"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00822}00822     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00823}00823       printf(\textcolor{stringliteral}{"{} \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a38622e7bf04110a9c042849b3fb136f1}{R\_I\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00824}00824     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  Q\_I (by species):"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00825}00825     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00826}00826       printf(\textcolor{stringliteral}{"{} \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a63ace1f59944016dd0bf93573fa74b13}{Q\_I\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00827}00827     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  L\_I (by species):"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00828}00828     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00829}00829       printf(\textcolor{stringliteral}{"{} \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ae785d2a9fe11700b737572da4bc84b14}{L\_I\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00830}00830     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  MW\_I (by species):"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00831}00831     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00832}00832       printf(\textcolor{stringliteral}{"{} \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a1f5c2d7f5d00731ad2b59dafd08f8b26}{MW\_I\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00833}00833     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  X\_I (by species):"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00834}00834     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00835}00835       printf(\textcolor{stringliteral}{"{} \%le"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a5bed7503a53ee02a5bc252ee13f96724}{X\_I\_}}(i\_phase, i\_spec));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00836}00836     printf(\textcolor{stringliteral}{"{}\(\backslash\)n  ** Phase-\/specific group data **"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00837}00837     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_group = 0; i\_group < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_ad6d3e263b5e54004fc858d109e79ef90}{NUM\_GROUP\_}}; ++i\_group) \{}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00838}00838       printf(\textcolor{stringliteral}{"{}\(\backslash\)n  Group \%d:"{}}, i\_group);}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00839}00839       printf(\textcolor{stringliteral}{"{}\(\backslash\)n    v\_ik (by species):"{}});}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00840}00840       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_spec = 0; i\_spec < \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_a9a5c42fc20a0cc885faf74920b1f8281}{NUM\_SPEC\_}}(i\_phase); ++i\_spec)}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00841}00841         printf(\textcolor{stringliteral}{"{} \%d"{}}, \mbox{\hyperlink{sub__model___u_n_i_f_a_c_8c_adfb11739bde704494a85f005ed76cc70}{V\_IK\_}}(i\_phase, i\_spec, i\_group));}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00842}00842     \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00843}00843   \}}
\DoxyCodeLine{\Hypertarget{sub__model___u_n_i_f_a_c_8c_source_l00844}00844 \}}

\end{DoxyCode}
